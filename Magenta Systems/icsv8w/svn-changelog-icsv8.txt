------------------------------------------------------------------------
r1400 | angus | 2019-02-22 12:40:55 +0000 (Fri, 22 Feb 2019) | 64 lines
Changed paths:
   M /trunk/Source/OverByteIcsFtpSrvT.pas
   M /trunk/Source/OverbyteIcsCookies.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIniFiles.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.60 - Part 1

This is the first part of a major update added several new components and sample applications created by Magenta Systems Ltd and previously distributed separately to the ICS distribution.  Bundling them with ICS makes installation and updating easier, and allows existing ICS samples to make use of some the new components, such as UTF-8 file logging.  

This part updates existing ICS components with minor new features, bug fixes and a few new common functions from the Magenta Systems components.  

In particular, when starting WSocket connect, the IP address chosen from the DNS lookup is now saved in ASCII as AddrResolvedStr which is useful in connect OK or failed events to see whether an IPV4 or IPv6 address was chosen, and which if DNS offered multiple IPs. 

OverbyteIcsWSocket.pas
Feb 22, 2019 V8.60 
Added AddrResolvedStr read only resolved IPv4 or IPv6 address set during Connect method after DNS lookup.
Clean-up old commented out code.
Made SocketFamilyNames more descriptive.
Moved OnDNSLookupDone before internal Connect attempt so user can change DNS result, bug in V8.43.
DnsResult can now be updated in OnDNSLookupDone event.
Added TLS version to SslSrvSecurityNames.

OverbyteIcsWSocketS.pas
Feb 13, 2019  V8.60 
Added WebLogIdx to IcsHosts for web server logging.

OverbyteIcsCookies.pas
Feb 8 2019  V8.60  
Using new ISO date functions in Utils instead of local versions.

OverByteIcsFtpSrvT.pas
Jan 14, 2019 
V8.60 Removed old code moved elsewhere.
PadIntZero now public and supports integer.

OverbyteIcsHttpProt.pas
Feb 5, 2019  V8.60 
Added AddrResolvedStr read only property which is the IPv4/IPv6 address to which the client is trying to connect.

OverbyteIcsHttpSrv.pas
Feb 20, 2019 V8.60 
Added WebLogIdx to THttpConnection for web logging.
Fixed bug Close did not close multi-listener sockets.

OverbyteIcsSSLEAY.pas
Feb 12, 2019  V8.60 
Next major OpenSSL version is 3.0.0

OverbyteIcsSslHttpRest.pas
Feb 6, 2019   - V8.60   
Default with SocketFamily Any for both IPv4 and IPv6.
SessionConnect logging shows IP address as well as host name.
Increased OAuth web server timeout from 2 to 30 mins. 

OverbyteIcsSslX509Certs.pas
Feb 6, 2019   - V8.60   
Added SocketFamily property to allow both IPv4 and IPv6.

OverbyteIcsUtils.pas
Feb 08, 2019 V8.60 
Added IcsFormatSettings to replace formatting public vars removed in XE3.
Added IcsAddThouSeps to add thousand separators to a numeric string.
Added IcsInt64ToCStr and IcsIntToCStr integer to thou sep strings.
Added GetBomFromCodePage. 





------------------------------------------------------------------------
r1401 | angus | 2019-02-22 15:25:57 +0000 (Fri, 22 Feb 2019) | 64 lines
Changed paths:
   A /trunk/Source/Ics.Fmx.OverbyteIcsBlacklist.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsIpStreamLog.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsMailQueue.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsSntp.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsWhoisCli.pas
   A /trunk/Source/OverbyteIcsBlacklist.dcr
   A /trunk/Source/OverbyteIcsBlacklist.pas
   A /trunk/Source/OverbyteIcsIpStreamLog.dcr
   A /trunk/Source/OverbyteIcsIpStreamLog.pas
   A /trunk/Source/OverbyteIcsMailQueue.dcr
   A /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsReg.pas
   A /trunk/Source/OverbyteIcsSntp.dcr
   A /trunk/Source/OverbyteIcsSntp.pas
   A /trunk/Source/OverbyteIcsWhoisCli.dcr
   A /trunk/Source/OverbyteIcsWhoisCli.pas

ICS V8.60 - Part 2

These new components were all created by Magenta Systems Ltd and previously distributed separately to the ICS distribution. They have all been renamed slightly, but are mostly compatible with the older versions.  The ICS Wiki FAQ pages will have some notes on upgrading to the ICS versions. 


OverbyteIcsBlacklist.pas

TIcsBlackList supports blackisting or block listing of IP addresses that attempt repeated failed access to TCP/IP servers. It maintains a list of IP addresses or Values that have previously exceeded a specific number of failed attempts, against which new attempts may be checked.  

TIcsStringBuild to efficiently build Ansi or Unicode strings on all versions of Delphi.

TIcsBuffLogStream buffered log stream designed to write large log files, flushing regularly to disk by opening, writing and closing each time the buffer fills or after a timeout of X seconds. The file name is date/time mask format, typically for one log file per day.  Writes files in ANSI, UTF-9 or UTF-16, with a BOM. 

IcsSimpleLogging write text to end of old or new file, opening and closing file, ignores any errors, not designed for continual updating!  The file name is date/time mask format, typically for one log file per day.

Use of these functions is illustrated in the OverbyteIcsSslMultiWebServ sample project. TIcsBuffLogStream is also used on other samples for logging. 


OverbyteIcsIpStreamLog.pas

TIcsIpStrmLog is designed for IP stream logging, using TCP Client, TCP Server, UDP Client or UDP Server protocols, sending simple text lines across a network so they may be displayed or written to disk remotely.  The component allows two way communication with TCP and UDP, so may also be used for simple protocols such as communication between two applications.   The component supports multiple client sockets so may be used to send data to two or more different remote servers at the same time.  Supports SSL including ordering X509 SSL certificates. 

Note, this component is not fully working yet, pending ordering certificates.  

Use of TIcsIpStrmLog is illustrated in the new OverbyteIcsIpStmLogTst sample project.


OverbyteIcsMailQueue.pas

TIcsMailQueue component has two main benefits over a simple TSslSmtpCli component: it supports extended retries over many hours or days, and supports multiple SMTP relay servers or looks up MX servers, while alleviating the need for the application to handle retries.  Mail is queued to disk, so retries will continue if the application is restarted.

TIcsMailQueue is designed to prepare, queue and send email.  Preparing the email is done using the the ICS THtmlSmtpCli component so it may be plain text or HTML email with one or more file attachments. 

Once the mail properties in QuHtmlSmtp have been specified, it is queued using the QueueMail method which saves it to an EML formatted spool file.

The component runs a thread which checks the queue for new EML spool files, and attempts to forward them to one or more SMTP Mail Servers using TSslSmtpCli, optionally with SSL. If mail delivery succeeds, the spool file may be deleted or moved to an archive folder.  If mail delivery fails, the spool file remains in the queue and further attempts are made separated by the times in minutes listed in the RetryList list.  If all delivery attempts fail, the spool file may be deleted or moved to a badmail folder.

Use of TIcsMailQueue is illustrated in the new OverbyteIcsMailQuTst sample GUI project, and in the OverbyteIcsSslMultiWebServ sample project as a server. 



OverbyteIcsSntp.pas

TIcsTimeServer and TIcsTimeClient, time server and client, supporting time protocol with UDP and TCP portions of RFC868, and SNTP v4 (Simple Network Time Protocol) to RFC2030.  Note that full NTP is not supported.

The TIcsTimeClient includes round robin DNS lookup attempts if there are multiple DNS addresses for the host, trying each alternate in case of failure.  Multiple IPs are common for pool.ntp.org hosts.  Ideally this round robin DNS concept should be incorporated into other high level components that currently choose the first IP address offered, or even TWSocket itself. 

Support is planned for Roughtime, a new secure time protocol designed by Google. also supported by Cloudfare.  


Use of TIcsTimeServer and TIcsTimeClient are illustrated in the new OverbyteIcsTimeTst sample GUI project. 


OverbyteIcsWhoisCli.pas

TIcsWhoisCli is a Whois protocol client using TWSocket.  Conforms to RFC-954. Looks up host names and IP addresses.   

The component has an internal list of over 200 top level domains available through the WhoisServers property with their whois servers, if none is found the IANA registry is checked instead.

Some queries will result in a secondary query to another whois server for more detail, the result of just the last query is available as property LastResp. Most COM queries are two stage due to multiple registries, likewise IP address queries are first to ARIN then often to the regional registry.  Alternatively, the StartQuery method does a single query to the server specified in the Host property.

Use of TIcsWhoisCli is illustrated in the new OverbyteIcsWhoisTst sample project. 


------------------------------------------------------------------------
r1402 | angus | 2019-02-22 16:13:35 +0000 (Fri, 22 Feb 2019) | 80 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OtherDemos.bpg
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.dfm
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.pas
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst1.dfm
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTstView.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTstView.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTstdiag.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTstdiag.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebMailer.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServerMailer.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/SslDemos.bpg
   A /trunk/Samples/Delphi/SslInternet/hackfilterlist.txt
   A /trunk/Samples/Delphi/SslInternet/whiteiplist.txt

ICS V8.60 - Part 3

Added four new samples for the new Magenta Systems Ltd components, and updated some existing samples to use them as well.  

Samples/Delphi/OtherDemos/OtherDemos.bpg
Added OverbyteIcsWhoisCliTst.dpr and OverbyteIcsTimeTst.dpr

Samples/Delphi/SslInternet/SslDemos.bpg
Added OverbyteIcsMailQuTst.dpr and OverbyteIcsIpStmLogTst.dpr 


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Added Socket Family selection for IPv4, IPv6 or both.
Added log file using new TIcsBuffLogStream for UTF8 file logging, one log per day.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Added Socket Family selection for IPv4 and/or IPv6, previously ignored IPV6 only hosts.
Report SessionConnnected event with actual IP address.
OpenSSL 1.0.2 only tick box gone, not needed any longer.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dpr
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebMailer.pas
Samples/Delphi/SslInternet/hackfilterlist.txt
Samples/Delphi/SslInternet/whiteiplist.txt
Using new TIcsBuffLogStream for logging in UTF8 (or UTF16).
Using new TIcsMailQueue to send email.
Using new TIcsBlacklist to block hackers and abuse.
Mailer form now uses TIcsMailQueue.
Everything displayed in windows is also logged to file set in ServLogDir in the INI file.
Added hackfilterlist.txt which is hacker URL filters to block, typically any with PHP since this server does not support PHP.
Added whiteiplist.txt of IP addresses we don't want to block.
Count number of access attempts and block too many.


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Using new TIcsBuffLogStream for UTF8 or UTF16 file logging, one log per day rather than per session.
Added Socket Family to allow use with IPv6 hosts.


Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.dof
Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.dpr
Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.pas
Test TIcsTimeServer and TIcsTimeClient, time server and client.


Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.dof
Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.dpr
Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst1.pas
Test TIcsWhoisCli Whois client. 


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.dof
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
A client and server test application for the TIcsIpStrmLog IP Log component. the sample may be configured to run as a client or a server, or to run locally as both client and server.  Lines of test data are generated and sent by both client and server. 


Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.dof
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsMailQuTstdiag.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTstdiag.pas
Samples/Delphi/SslInternet/OverbyteIcsMailQuTstView.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTstView.pas
Mail Queue Component Demonstration Sample for the TIcsMailQueue which is designed to prepare, queue and send email. It allows two SMTP servers to be specified and will queue mail to up to 20 emails addresses.  Includes a window displaying the status of the mail queue, what is still queued and when the next attempt will be made, also allows mail to be deleted from the queue.  This window may be copied into end user application that need to control the queue.  



------------------------------------------------------------------------
r1403 | angus | 2019-02-22 16:37:56 +0000 (Fri, 22 Feb 2019) | 18 lines
Changed paths:
   M /trunk/Packages/IcsCommonD103Design.dproj
   M /trunk/Packages/IcsCommonD103Run.dproj
   M /trunk/Packages/IcsFmxD103Design.dproj
   M /trunk/Packages/IcsFmxD103Run.dpk
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsVclD103Design.dproj
   M /trunk/Packages/IcsVclD103Run.dpk
   M /trunk/Packages/IcsVclD103Run.dproj
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.60 - Part 4

Updated Delphi 2007 and Delphi 10.3 Rio VCL/FXM packages with new Magenta Systems Ltd components and samples.  

Packages for the other 30 odd supported platforms will be done for the final V8.60 release in case of changes.  

Packages/IcsCommonD103Design.dproj
Packages/IcsCommonD103Run.dproj
Packages/IcsFmxD103Design.dproj
Packages/IcsFmxD103Run.dpk
Packages/IcsFmxD103Run.dproj
Packages/IcsVclD103Design.dproj
Packages/IcsVclD103Run.dpk
Packages/IcsVclD103Run.dproj
Packages/OverbyteIcsD2007Run.dpk
Packages/OverbyteIcsD2007Run.dproj
ZipOverbyteIcsV8.lst

------------------------------------------------------------------------
r1404 | angus | 2019-02-27 11:52:59 +0000 (Wed, 27 Feb 2019) | 8 lines
Changed paths:
   M /trunk/OpenSSL-Win32/LICENSE
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libeay32.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/ssleay32.dll

ICS V8.60 - Part 5

Updated OpenSSL to 1.1.1b and 1.0.2r.

Beware 1.1.1b fixes a problem relating to multiple handshake done messages with TLSv1.3 that I reported to OpenSSL almost a year ago, and provided a workaround in ICS to fix meanwhile.  Others meanwhile reported the same problem updating old applications for TLSv1.3 so OpenSSL finally changed the handshake done behaviour.  My original fix still seems to work OK, but need to do more debug traces to ensure nothing unexpected has also changed with TLSv1.3. 



------------------------------------------------------------------------
r1405 | angus | 2019-03-07 19:25:24 +0000 (Thu, 07 Mar 2019) | 45 lines
Changed paths:
   M /trunk/ReadMe8.txt
   A /trunk/Source/Ics.Fmx.OverbyteIcsFileCopy.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsFtpMulti.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsHttpMulti.pas
   A /trunk/Source/Include/OverbyteVclZip.inc
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsCryptUiApi.pas
   A /trunk/Source/OverbyteIcsFileCopy.dcr
   A /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFormDataDecoder.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   A /trunk/Source/OverbyteIcsFtpMulti.dcr
   A /trunk/Source/OverbyteIcsFtpMulti.pas
   A /trunk/Source/OverbyteIcsHtmlPars.pas
   A /trunk/Source/OverbyteIcsHttpMulti.dcr
   A /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsJwaWinCrypt.inc
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.60 - Part 6

Adds add Magenta Systems File Transfer Components and sample applications created by Magenta Systems Ltd and previously distributed separately to the ICS distribution.  

https://www.magsys.co.uk/delphi/magxfer.asp

Also updates HTTP and FTP clients to support round robin DNS as discussed in the forum at:

https://en.delphipraxis.net/forum/37-ics-internet-component-suite/ 


OverbyteIcsFtpCli.pas
Mar 6, 2019  V8.60
Added AddrResolvedStr read only property which is the IPv4/IPv6  address to which the client is trying to connect.
Added IP address and port to 500 Connect error.
Added round robin DNS lookup if DNSLookup returns multiple IP addresses so they are used in turn after a failure when the component is called repeatedly.  

OverbyteIcsHttpProt.pas
Mar 6, 2019  V8.60 
Added AddrResolvedStr read only property which is the IPv4/IPv6 address to which the client is trying to connect.
Added IP address and port to 404 Connect error.
Added round robin DNS lookup if DNSLookup returns multiple IP addresses so they are used in turn after a failure when the component is called repeatedly.

OverbyteIcsCryptUiApi.pas
OverbyteIcsJwaWinCrypt.inc
Fixes for C++.

OverbyteIcsFormDataDecoder.pas
Removed registration from unit, should not be there. 

OverbyteIcsFileCopy.pas
TIcsFileCopy allows indexing, copying and deleting of multiple file directories, using a single function call.

OverbyteIcsFtpMulti.pas
TIcsFtpMulti is a high level FTP Delphi component that allows uploading or downloading of multiple files from or to an FTP server, from a single function call.

OverbyteIcsHtmlPars.pas
TIcsHTMLParser is an HTMP parser.

OverbyteIcsHttpMulti.pas
TIcsFileCopy is a high level HTTP Delphi component that allows indexing and copying of multiple file directories, using a single function call.


Note ICS will not currently build for MacOS with this update due to some Windows only API use. 

------------------------------------------------------------------------
r1406 | angus | 2019-03-07 19:37:02 +0000 (Thu, 07 Mar 2019) | 19 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/SslDemos.bpg

ICS V8.60 - Part 7

Adds an updated version of the Magenta Systems File Transfer Components demo application.

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Mar 6,  2019 - V8.60 
Add Socket Family selection for IPv4, IPv6 or both.
Added log file using new TIcsBuffLogStream for UTF8 file logging, one log per day.
Removed onSelectDns event so base component does it for us.


Samples/Delphi/SslInternet/OverbyteIcsXferTst.dof
Samples/Delphi/SslInternet/OverbyteIcsXferTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas

New sample application for the TIcsFileCopy, TIcsFtpMulti and TIcsHttpMulti components. 

------------------------------------------------------------------------
r1407 | angus | 2019-03-07 19:49:31 +0000 (Thu, 07 Mar 2019) | 8 lines
Changed paths:
   M /trunk/Packages/IcsCommonD103Run.dpk
   M /trunk/Packages/IcsFmxD103Run.dpk
   M /trunk/Packages/IcsVclD103Run.dpk
   M /trunk/Packages/OverbyteIcsD103Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Design.dproj
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.60 - Part 8

Updated Delphi 2007 and Delphi 10.3 Rio VCL/FXM packages with new Magenta
Systems Ltd components and samples.

Packages for the other 30 odd supported platforms will be done for the
final V8.60 release in case of changes.

------------------------------------------------------------------------
r1408 | angus | 2019-03-08 17:12:08 +0000 (Fri, 08 Mar 2019) | 3 lines
Changed paths:
   M /trunk/Packages/IcsCommonCB102Design.cbproj
   M /trunk/Packages/IcsCommonCB102Run.cbproj
   M /trunk/Packages/IcsCommonCB103Design.cbproj
   M /trunk/Packages/IcsCommonCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB102Design.cbproj
   M /trunk/Packages/IcsFmxCB102Run.cbproj
   M /trunk/Packages/IcsFmxCB103Design.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cpp
   M /trunk/Packages/IcsVclCB102Design.cbproj
   M /trunk/Packages/IcsVclCB102Run.cbproj
   M /trunk/Packages/IcsVclCB103Design.cbproj
   M /trunk/Packages/IcsVclCB103Run.cbproj
   M /trunk/Packages/IcsVclCB103Run.cpp

ICS V8.60 - Part 9

Updated C++ packages for 10.2 and 10.3 to build correctly for V8.59, they don't yet include any of the new components in V8.60.  Thanks to Alan Kamrowski for the work.  
------------------------------------------------------------------------
r1409 | angus | 2019-03-13 11:03:57 +0000 (Wed, 13 Mar 2019) | 4 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.60 - Part 10

Updated zip list with three missing FMX units.
Updated readme with more C++ install information and support gorum. 
------------------------------------------------------------------------
r1410 | angus | 2019-03-20 17:05:45 +0000 (Wed, 20 Mar 2019) | 47 lines
Changed paths:
   M /trunk/Source/Include/OverbyteVclZip.inc
   A /trunk/Source/OverByteIcsFtpSrvWT.pas
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   A /trunk/Source/OverbyteIcsFileCopyW.dcr
   A /trunk/Source/OverbyteIcsFileCopyW.pas
   A /trunk/Source/OverbyteIcsFtpCliW.dcr
   A /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   A /trunk/Source/OverbyteIcsFtpMultiW.dcr
   A /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   A /trunk/Source/OverbyteIcsFtpSrvW.dcr
   A /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   A /trunk/Source/OverbyteIcsHttpMultiW.dcr
   A /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSntp.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.60 - Part 11

Last batch of new source units, many only for Delphi 2007.

OverbyteIcsHttpProt.pas
Mar 15, 2019 V8.60 
Added AddrResolvedStr read only property which is the IPv4/IPv6 address to which the client is trying to connect.
Added IP address and port to 404 Connect error.
Added round robin DNS lookup if DNSLookup returns multiple IP addresses so they are used in turn after a failure when the component is called repeatedly.
Only follow relocation for 3xx response codes, not 201 Created, but keep Location for 201 which is often response to a POST.

OverbyteIcsFtpSrv.pas
Mar 8, 2019  V8.60 - Version and copyright dates only. 

OverbyteIcsWSocket.pas
OverbyteIcsWSocketS.pas
OverbyteIcsSSLEAY.pas
Mar 18, 2019 V8.60 
Added sslSrvSecTls12Less and sslSrvSecTls13Only to disable in server IcsHosts if TLS1.3 fails.

OverbyteIcsUtils.pas
Added IcsForceDirsEx

OverbyteIcsBlacklist.pas
OverbyteIcsFileCopy.pas
OverbyteIcsFtpMulti.pas
OverbyteIcsHttpMulti.pas
OverbyteIcsSntp.pas
OverbyteIcsSslX509Certs.pas
Bug fixes. 

OverbyteIcsFileCopyW.dcr
OverbyteIcsFileCopyW.pas
OverbyteIcsFtpCliW.dcr
OverbyteIcsFtpCliW.pas
OverbyteIcsFtpMultiW.dcr
OverbyteIcsFtpMultiW.pas
OverbyteIcsFtpSrvW.dcr
OverbyteIcsFtpSrvW.pas
OverByteIcsFtpSrvWT.pas
OverbyteIcsHttpMultiW.dcr
OverbyteIcsHttpMultiW.pas
OverbyteIcsReg.pas
These are all similar to the same units without W, but internally use WideStrings to support Unicode on Delphi 2007 and earlier, so Unicode file names are not corrupted by file copying or FTP.  Currently, they will only work on Delphi 2007. 



------------------------------------------------------------------------
r1411 | angus | 2019-03-21 12:48:58 +0000 (Thu, 21 Mar 2019) | 5 lines
Changed paths:
   M /trunk/Packages/OverbyteIcsD2007Design.dproj
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/ReadMe8.txt
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.res
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst1.pas
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTstView.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.60 - Part 12

Last batch of new samples, includes bug fixes and Unicode File Transfer sample for Delph 2007. 

Updates readme8 with all new stuff. 
------------------------------------------------------------------------
r1412 | angus | 2019-03-21 17:45:38 +0000 (Thu, 21 Mar 2019) | 3 lines
Changed paths:
   M /trunk/Packages/IcsCommonD101Run.dpk
   M /trunk/Packages/IcsCommonD101Run.dproj
   M /trunk/Packages/IcsCommonD102Run.dpk
   M /trunk/Packages/IcsCommonD102Run.dproj
   M /trunk/Packages/IcsCommonD103Run.dproj
   M /trunk/Packages/IcsCommonD10SRun.dpk
   M /trunk/Packages/IcsCommonD10SRun.dproj
   M /trunk/Packages/IcsCommonDXE2Run.dpk
   M /trunk/Packages/IcsCommonDXE2Run.dproj
   M /trunk/Packages/IcsCommonDXE3Run.dpk
   M /trunk/Packages/IcsCommonDXE3Run.dproj
   M /trunk/Packages/IcsCommonDXE4Run.dpk
   M /trunk/Packages/IcsCommonDXE4Run.dproj
   M /trunk/Packages/IcsCommonDXE5Run.dpk
   M /trunk/Packages/IcsCommonDXE5Run.dproj
   M /trunk/Packages/IcsCommonDXE6Run.dpk
   M /trunk/Packages/IcsCommonDXE6Run.dproj
   M /trunk/Packages/IcsCommonDXE7Run.dpk
   M /trunk/Packages/IcsCommonDXE7Run.dproj
   M /trunk/Packages/IcsCommonDXE8Run.dpk
   M /trunk/Packages/IcsCommonDXE8Run.dproj
   M /trunk/Packages/IcsFmxD101Run.dpk
   M /trunk/Packages/IcsFmxD101Run.dproj
   M /trunk/Packages/IcsFmxD102Run.dpk
   M /trunk/Packages/IcsFmxD102Run.dproj
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsFmxD10SRun.dpk
   M /trunk/Packages/IcsFmxD10SRun.dproj
   M /trunk/Packages/IcsFmxDXE2Run.dpk
   M /trunk/Packages/IcsFmxDXE2Run.dproj
   M /trunk/Packages/IcsFmxDXE3Run.dpk
   M /trunk/Packages/IcsFmxDXE3Run.dproj
   M /trunk/Packages/IcsFmxDXE4Run.dpk
   M /trunk/Packages/IcsFmxDXE4Run.dproj
   M /trunk/Packages/IcsFmxDXE5Run.dpk
   M /trunk/Packages/IcsFmxDXE5Run.dproj
   M /trunk/Packages/IcsFmxDXE6Run.dpk
   M /trunk/Packages/IcsFmxDXE6Run.dproj
   M /trunk/Packages/IcsFmxDXE7Run.dpk
   M /trunk/Packages/IcsFmxDXE7Run.dproj
   M /trunk/Packages/IcsFmxDXE8Run.dpk
   M /trunk/Packages/IcsFmxDXE8Run.dproj
   M /trunk/Packages/IcsVclD101Run.dpk
   M /trunk/Packages/IcsVclD101Run.dproj
   M /trunk/Packages/IcsVclD102Run.dpk
   M /trunk/Packages/IcsVclD102Run.dproj
   M /trunk/Packages/IcsVclD103Run.dproj
   M /trunk/Packages/IcsVclD10SRun.dpk
   M /trunk/Packages/IcsVclD10SRun.dproj
   M /trunk/Packages/IcsVclDXE2Run.dpk
   M /trunk/Packages/IcsVclDXE2Run.dproj
   M /trunk/Packages/IcsVclDXE3Run.dpk
   M /trunk/Packages/IcsVclDXE3Run.dproj
   M /trunk/Packages/IcsVclDXE4Run.dpk
   M /trunk/Packages/IcsVclDXE4Run.dproj
   M /trunk/Packages/IcsVclDXE5Run.dpk
   M /trunk/Packages/IcsVclDXE5Run.dproj
   M /trunk/Packages/IcsVclDXE6Run.dpk
   M /trunk/Packages/IcsVclDXE6Run.dproj
   M /trunk/Packages/IcsVclDXE7Run.dpk
   M /trunk/Packages/IcsVclDXE7Run.dproj
   M /trunk/Packages/IcsVclDXE8Run.dpk
   M /trunk/Packages/IcsVclDXE8Run.dproj
   M /trunk/Packages/OverbyteIcsD101Run.dpk
   M /trunk/Packages/OverbyteIcsD101Run.dproj
   M /trunk/Packages/OverbyteIcsD102Run.dpk
   M /trunk/Packages/OverbyteIcsD102Run.dproj
   M /trunk/Packages/OverbyteIcsD103Run.dproj
   M /trunk/Packages/OverbyteIcsD10SRun.dpk
   M /trunk/Packages/OverbyteIcsD10SRun.dproj
   M /trunk/Packages/OverbyteIcsD2006Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/Packages/OverbyteIcsD2009Run.dpk
   M /trunk/Packages/OverbyteIcsD2009Run.dproj
   M /trunk/Packages/OverbyteIcsD2010Run.dpk
   M /trunk/Packages/OverbyteIcsD2010Run.dproj
   M /trunk/Packages/OverbyteIcsD7Run.dpk
   M /trunk/Packages/OverbyteIcsDXE8Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dproj
   M /trunk/Packages/OverbyteIcsDXe3Run.dpk
   M /trunk/Packages/OverbyteIcsDXe3Run.dproj
   M /trunk/Packages/OverbyteIcsDXe4Run.dpk
   M /trunk/Packages/OverbyteIcsDXe4Run.dproj
   M /trunk/Packages/OverbyteIcsDXe5Run.dpk
   M /trunk/Packages/OverbyteIcsDXe5Run.dproj
   M /trunk/Packages/OverbyteIcsDXe6Run.dpk
   M /trunk/Packages/OverbyteIcsDXe6Run.dproj
   M /trunk/Packages/OverbyteIcsDXe7Run.dpk
   M /trunk/Packages/OverbyteIcsDXe7Run.dproj
   M /trunk/Packages/OverbyteIcsDXe8Run.dproj
   M /trunk/Packages/OverbyteIcsDXeRun.dpk
   M /trunk/Packages/OverbyteIcsDXeRun.dproj

ICS V8.60 - Part 13

Updated 94 packages for 17 different versions of Delphi with VCL and FMX, with several new components each. 
------------------------------------------------------------------------
r1413 | angus | 2019-03-22 17:31:43 +0000 (Fri, 22 Mar 2019) | 9 lines
Changed paths:
   M /trunk/Packages/IcsCommonCB102Run.cbproj
   M /trunk/Packages/IcsCommonCB103Design.cbproj
   M /trunk/Packages/IcsCommonCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB102Run.cbproj
   M /trunk/Packages/IcsFmxCB102Run.res
   M /trunk/Packages/IcsFmxCB103Design.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB103Run.res
   M /trunk/Packages/IcsVclCB102Run.cbproj
   M /trunk/Packages/IcsVclCB103Design.cbproj
   M /trunk/Packages/IcsVclCB103Run.cbproj
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFileCopyW.pas

ICS V8.60 - Part 14

OverbyteIcsFileCopy should now build on OSX, albeit with some warnings, not tested.  Also builds on Delphi 7. 

Added new units to C++ 10.2 and 10.3 packages, unfortunately appears to be impossible to add new DCR files to the C++ packages through the IDE, get duplicate error, so icons are missing from these new units and some earlier ones for VCL, should be OK for FMX.  

Barring bug fixes and more documentation, V8.60 should now be complete, build and install on Delphi 7 to 10.3 and C++ 10.2 and 10.3.  Please try it. 


------------------------------------------------------------------------
r1414 | angus | 2019-03-26 10:56:53 +0000 (Tue, 26 Mar 2019) | 3 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Source/OverbyteIcsFileCopy.pas

ICS V8.60 - Part 15

Builds again on recent compilers.  
------------------------------------------------------------------------
r1415 | angus | 2019-04-03 17:44:40 +0100 (Wed, 03 Apr 2019) | 3 lines
Changed paths:
   M /trunk/Packages/IcsFmxD101Run.dproj
   M /trunk/Packages/IcsFmxD102Run.dproj
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsFmxD10SRun.dproj
   M /trunk/Packages/IcsFmxDXE2Run.dproj
   M /trunk/Packages/IcsFmxDXE3Run.dproj
   M /trunk/Packages/IcsFmxDXE4Run.dproj
   M /trunk/Packages/IcsFmxDXE5Run.dproj
   M /trunk/Packages/IcsFmxDXE6Run.dproj
   M /trunk/Packages/IcsFmxDXE7Run.dproj
   M /trunk/Packages/IcsFmxDXE8Run.dproj
   M /trunk/Packages/IcsVclD101Run.dproj
   M /trunk/Packages/IcsVclD102Run.dproj
   M /trunk/Packages/IcsVclD10SRun.dproj
   M /trunk/Packages/IcsVclDXE2Run.dproj
   M /trunk/Packages/IcsVclDXE3Run.dproj
   M /trunk/Packages/IcsVclDXE4Run.dproj
   M /trunk/Packages/IcsVclDXE5Run.dproj
   M /trunk/Packages/IcsVclDXE6Run.dproj
   M /trunk/Packages/IcsVclDXE7Run.dproj
   M /trunk/Packages/IcsVclDXE8Run.dproj
   M /trunk/Packages/OverbyteIcsD101Run.dproj
   M /trunk/Packages/OverbyteIcsD102Run.dproj
   M /trunk/Packages/OverbyteIcsD103Run.dproj
   M /trunk/Packages/OverbyteIcsD10SRun.dproj
   M /trunk/Packages/OverbyteIcsD2009Run.dproj
   M /trunk/Packages/OverbyteIcsD2010Run.dproj
   M /trunk/Packages/OverbyteIcsDXe2Run.dproj
   M /trunk/Packages/OverbyteIcsDXe3Run.dproj
   M /trunk/Packages/OverbyteIcsDXe4Run.dproj
   M /trunk/Packages/OverbyteIcsDXe5Run.dproj
   M /trunk/Packages/OverbyteIcsDXe6Run.dproj
   M /trunk/Packages/OverbyteIcsDXe7Run.dproj
   M /trunk/Packages/OverbyteIcsDXe8Run.dproj
   M /trunk/Packages/OverbyteIcsDXeRun.dproj
   M /trunk/ReadMe8.txt

ICS V8.60 - Part 16

Fixed XML typo that prevented building packages on compilers XE2 to 10.2.
------------------------------------------------------------------------
r1416 | angus | 2019-04-04 19:40:04 +0100 (Thu, 04 Apr 2019) | 48 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.pas
   M /trunk/Samples/Delphi/BrowserDemo/UrlConIcs.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsNtlmMsgs.pas
   M /trunk/Source/OverbyteIcsNtlmSsp.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSspi.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.61 - Part 1

First part of V8.61, no new units planned so no package changes, just routine improvements and fixes. 


OverbyteIcsHttpProt.pas
Apr 04, 2019 V8.61 
OAS : Improved NTLM authentication by adding Single Sign On with NTLM Session on Windows Domain to get credentials without needing them specified here.
Added TriggerRequestDone2 to correct overriding RequestDone event.
Added TriggerCommand, TriggerHeaderData, TriggerLocationChange and TransferSslHandshakeDone to allow overriding those events.

OverbyteIcsHttpSrv.pas
Mar 29, 2019 V8.61 
OAS : Add InBound value for TNtlmAuthSession creation because server NTLM auth is inbound and Client is outbound. 

OverbyteIcsNtlmMsgs.pas
Mar 29, 2019 V8.61 
OAS : for Single Sign On with Session on Windows Domain update types and make some records "packed" for Windows standard

OverbyteIcsNtlmSsp.pas
Mar 29, 2019 V8.61 
OAS : for NTLM with Session on Windows Domain, update TNtlmAuthSession for Client as well as Server

OverbyteIcsSspi.pas
Mar 29, 2019 V8.61 
OAS : for Single Sign On with Session on Windows Domain, update types and make some records "packed"

OverbyteIcsSslHttpRest.pas
Apr 4, 2019   - V8.61
Prevent TSslHttpCli events being overwritten by TSslHttpRest events.
ResponseXX properties available in OnRequestDone and OnRestRequestDone.

OverbyteIcsWSocket.pas
OverbyteIcsReg.pas
Version change only, so far...

Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
Samples/Delphi/BrowserDemo/FBUnitIcs.pas
Samples/Delphi/BrowserDemo/UrlConIcs.pas
Apr 4, 2019   - V8.61
Fixed authentication to work properly. 

Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
pr 4, 2019   - V8.61
Added Email Mail Form to main menu.


------------------------------------------------------------------------
r1417 | angus | 2019-04-16 17:58:55 +0100 (Tue, 16 Apr 2019) | 26 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Source/OverbyteIcsCharsetUtils.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.61 - Part 2

OverbyteIcsWSocket.pas
Apr 16, 2019 V8.61 
Fixed ValidateCertChain to check certificate start and expiry dates in UTC time instead of local time.  Previously certificates issued in North America with UTC/GMT time stamps may have been seen as not yet valid.  


OverbyteIcsHttpProt.pas
Apr 09, 2019 V8.61 
OAS : Improved NTLM authentication by adding Single Sign On with NTLM Session on Windows Domain to get credentials without needing them specified here.
Added TriggerRequestDone2 to correct overriding RequestDone event.
Added TriggerCommand, TriggerHeaderData, TriggerLocationChange and TransferSslHandshakeDone to allow overriding those events.
Added more header response properties: RespDateDT, RespLastModDT, RespExpires, RespCacheControl.
NoCache now sends Cache-Control: no-cache for HTTP/1.1


OverbyteIcsCharsetUtils.pas
Apr 8, 2019  V8.61  
IcsHtmlToStr returns javascript content as well as XML and Json.


OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
17 Apr 2019 - V8.61 - 
Base component now has more response headers, don't need to search for them.

------------------------------------------------------------------------
r1418 | angus | 2019-04-22 19:35:28 +0100 (Mon, 22 Apr 2019) | 44 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Source/OverbyteIcsDnsQuery.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas

ICS V8.61 - Part 3

These changes started as a REST demo of DNS over HTTPS queries (DOH), but ended up bringing the DNS Query component up to date as well. 
Ideally we need DOH to be available as an alternative in WSocket DNS lookups.  


OverbyteIcsDnsQuery.pas
Apr 22 2019 V8.61  
Added more DnsQuery literals and removed obsolete ones.
DecodeWireResp split from WSocketDataAvailable so can be used for DNS over HTTPS.
Queries now started with QueryAny.
Added QueryAll to return results from seven queries.
No longer ignores NS and Alternate results that sometimes return extra useful records (like A for NS and CNAME). 
New result array AnswerRecord with AnswerTotal records which is a TRRRecord response record with all result information so other arrays can be ignored, based on unpublished work by Holger Lembke but implemented with backward compatibility.
Added DnsReqTable of common queries with descriptive literals.
Added DnsPublicServerTable and DnsPublicHttpsTabl of public DNS server addresses.
Supporting all queries and responses including AAAA, NS and TXT, common ones decoded in TRRRecord, rest returned as text or hex.
PTR query now supports IPv6 addresses as well as IPV4.
Call RequestDone if connection fails. 


OverbyteIcsSslHttpRest.pas
Apr 22, 2019  - V8.61 - 
Prevent TSslHttpCli events being overwritten by TSslHttpRest events.
ResponseXX properties available in OnRequestDone and OnRestRequestDone.
Return javascript content as well as XML and Json
Added new TDnsQueryHttps component to make DNS over HTTPS queries using wire format.


Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
Apr 22 2019 V8.61  
Major rewrite to support all important DNS queries and also new Query All for seven most common queries.
Note new queries return results in single array rather than multiple arrays, but those old arrays are still available for backward compatibility.
Added list of public DNS servers.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Apr 22, 2019 - V8.61 
Added DNS over HTTPS REST example using Json.
Added DNS over HTTPS sample using TDnsQueryHttps component. 


------------------------------------------------------------------------
r1419 | angus | 2019-04-22 19:36:27 +0100 (Mon, 22 Apr 2019) | 1 line
Changed paths:
   M /trunk/Source/OverbyteIcsDnsQuery.pas

Correct file. 
------------------------------------------------------------------------
r1420 | angus | 2019-04-25 18:38:22 +0100 (Thu, 25 Apr 2019) | 36 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.pas
   M /trunk/Samples/Delphi/BrowserDemo/UrlConIcs.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Source/OverbyteIcsCharsetUtils.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.dcr
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.dcr

ICS V8.61 - Part 4

Probably final release.  New REST example has become TIcsSms component. 

OverbyteIcsSslHttpRest.pas
Apr 24, 2019  - V8.61 
Added new TIcsSms component to send SMS text messages via an HTTP bureau, you will need an account. Initially supporting https://www.kapow.co.uk/ from where you set-up an account for £6.50 (about $9) which gives 100 message credits. Other similar bureaus can be added, provided there is an account for testing.


OverbyteIcsCharsetUtils.pas
Apr 24, 2019 V8.61 
IcsHtmlToStr returns javascript content as well as XML and Json.
IcsHtmlToStr doesn't give up on tiny responses.


OverbyteIcsFtpCli.pas
Apr 23, 2019 V8.61  
Set ftpFeatProtC when no PROT parameters passed.  Allow PROT arguments without spaces. 


Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
Samples/Delphi/BrowserDemo/FBUnitIcs.pas
Samples/Delphi/BrowserDemo/UrlConIcs.pas
23 Apr 2019   V8.61 
Fixed authentication.
Only update log window every two seconds so as not to slow down performance.
Use NoCache header to stop dynamic pages being cached and expire them.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Apr 24, 2019 - V8.61 
Added new SMS tab to send SMS text messages via an HTTP bureau,  you will need an account. Initially supporting https://www.kapow.co.uk/ from where you set-up an account for £6.50 (about $9) which gives 100 message credits. Other similar bureaus can be added, provided there is an account for testing.



------------------------------------------------------------------------
r1421 | angus | 2019-04-26 11:27:30 +0100 (Fri, 26 Apr 2019) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsSslHttpRest.pas

ICS V8.61 - Part 5

Kapow URL changed to one with better SSL.  
------------------------------------------------------------------------
r1422 | angus | 2019-05-27 18:00:26 +0100 (Mon, 27 May 2019) | 37 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.62 - Part 1

First part of V8.62 routine improvements and fixes.


OverbyteIcsIpStreamLog.pas
20 May 2019 - V8.62 - 
TCP server now uses root bundle correctly and reports

OverbyteIcsMailQueue.pas
9 May 2019 - V8.62 -  
Added base MailCliSecurity property for MX servers.


OverbyteIcsSslHttpRest.pas
May 16, 2019  - V8.62 - 
Add AsyncReq to TIcsSms methods for flexibility.


OverbyteIcsSslX509Certs.pas
May 13, 2019  - V8.62   
TDomainItem adds DDirWellKnown and DDirPubWebCert


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
20 May 2019 - V8.62 - 
SSL server now works properly again


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
May 13, 2019 - V8.62 
Supplier tab display paths for cert and well-known dirs. 



------------------------------------------------------------------------
r1423 | angus | 2019-05-29 17:33:15 +0100 (Wed, 29 May 2019) | 3 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libeay32.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/ssleay32.dll

ICS V8.62 - Part 2

Updated OpenSSL to 1.1.1c and 1.0.2s.
------------------------------------------------------------------------
r1424 | francois | 2019-05-31 09:21:16 +0100 (Fri, 31 May 2019) | 1 line
Changed paths:
   M /trunk/Packages/IcsCommonD103Design.dproj
   M /trunk/Packages/IcsCommonD103Run.dproj
   M /trunk/Packages/IcsFmxD103Design.dproj
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsVclD103Design.dproj
   M /trunk/Packages/IcsVclD103Run.dproj
   M /trunk/Packages/OverbyteIcsD103Design.dproj
   M /trunk/Packages/OverbyteIcsD103Run.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsBasFtp.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsConFtp.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpAsy.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMulti.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMultipartDownload.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpServ.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpThrd.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpTst.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConPop3.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConSmtp.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailHtml.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailRcv.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSnd.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMimeDemo.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsNewsReader.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsSmtpServer.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverByteIcsWndControlTest.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsBufStrmTst.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsCacheTest.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD4Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD5Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsOneTimePassword.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsPrngTst.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsSHA1Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsThreadTimerDemo.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsTimerDemo.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll1.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll2.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDllTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDnsLook.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsFinger.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSnmpCliTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogClientDemo.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogServerDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsBinCliDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsCliDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient5.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient7.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli1.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli2.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConSrv1.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConUdpLstn.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsDynCli.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsMtSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSender.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsServer5.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvTcp.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSvcTcp.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTWSChat.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrvIPv6.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTelnetClient.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV3.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpLstn.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpSend.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsConHttp.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsp.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsy.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpChk.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpDmo.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpGet.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpMultipartDownload.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPg.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost.dproj
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost1.pas
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpThrd.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpTst.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsIsapi.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebAppServer.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebServ.dproj

Added all sample dproj (Some were already there, some not). Added ..\..\..\Source;..\..\..\Source\Include where they were missing in projects own search path so that it is not needed to modify global search path to compile demo projects.
------------------------------------------------------------------------
r1425 | angus | 2019-06-03 12:01:43 +0100 (Mon, 03 Jun 2019) | 5 lines
Changed paths:
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsBasFtp.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsConFtp.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpAsy.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMulti.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMultipartDownload.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpServ.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpThrd.dproj
   D /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpTst.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConPop3.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConSmtp.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailHtml.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailRcv.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSnd.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMimeDemo.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsNewsReader.dproj
   D /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsSmtpServer.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverByteIcsWndControlTest.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsBufStrmTst.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsCacheTest.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD4Test.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD5Test.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsOneTimePassword.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsPrngTst.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsSHA1Test.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsThreadTimerDemo.dproj
   D /trunk/Samples/Delphi/MiscDemos/OverbyteIcsTimerDemo.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll1.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll2.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDllTst.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDnsLook.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsFinger.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSnmpCliTst.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogClientDemo.dproj
   D /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogServerDemo.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsBinCliDemo.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsCliDemo.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient5.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient7.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli1.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli2.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConSrv1.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConUdpLstn.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsDynCli.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsMtSrv.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSender.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsServer5.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvTcp.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSvcTcp.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTWSChat.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrv.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrvIPv6.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTelnetClient.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrv.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV3.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnDemo.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpLstn.dproj
   D /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpSend.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsConHttp.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsp.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsy.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpChk.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpDmo.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpGet.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpMultipartDownload.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPg.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost.dproj
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost1.pas
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpThrd.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpTst.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsIsapi.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebAppServer.dproj
   D /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebServ.dproj

Reverted the sample DPROJ files from the last commit which prevented all samples being opened in Delphi 2007 and some more recent versions due to having been saved with a recent version which is XML incompatible with older versions.  

Unable to load project Only one top level element is allowed in an XML document.
The imported project "CodeGear.Delphi.Targets" was not found. 

------------------------------------------------------------------------
r1426 | francois | 2019-06-03 20:44:48 +0100 (Mon, 03 Jun 2019) | 1 line
Changed paths:
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpTst.dproj

Added .dproj file for OverbyteIcshttpTst sample with correct include path. Make with D2007 which make it compatible withh all Delphi versions supporting drpoj files. To be checked by Angus before I update the other projects. Thanks.
------------------------------------------------------------------------
r1427 | francois | 2019-06-04 20:32:47 +0100 (Tue, 04 Jun 2019) | 2 lines
Changed paths:
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsBasFtp.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsConFtp.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpAsy.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMulti.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMultipartDownload.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpServ.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpThrd.dproj
   A /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpTst.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConPop3.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsConSmtp.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailHtml.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailRcv.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSnd.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMimeDemo.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsNewsReader.dproj
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsSmtpServer.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverByteIcsWndControlTest.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsBufStrmTst.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsCacheTest.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD4Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD5Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsOneTimePassword.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsPrngTst.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsSHA1Test.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsThreadTimerDemo.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsTimerDemo.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll1.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDll2.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDllTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDnsLook.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsFinger.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSnmpCliTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogClientDemo.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsSysLogServerDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsBinCliDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsCliDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient5.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsClient7.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli1.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConCli2.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConSrv1.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConUdpLstn.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsDynCli.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsMtSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSender.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsServer5.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvTcp.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSvcTcp.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTWSChat.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTcpSrvIPv6.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTelnetClient.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV3.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnDemo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpLstn.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpSend.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsConHttp.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsp.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsy.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpChk.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpDmo.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpGet.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpMultipartDownload.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPg.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpThrd.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsIsapi.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebAppServer.dproj
   A /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebServ.dproj
   M /trunk/Samples/OverbyteIcsCommonVersion.rc

Updated all .dproj files for all samples to add ICS source folder to the search path of each project. I used D2007 to save the .dproj files. More recent Delphi version will accept this older format.
Updated OverbyteIcsCommonVersion.rc with latest version information.
------------------------------------------------------------------------
r1428 | angus | 2019-06-18 18:57:45 +0100 (Tue, 18 Jun 2019) | 130 lines
Changed paths:
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.62 - Part 3

Main part of V8.62 routine improvements and fixes, few more X509 certificate changes to come. 

The REST demo adds another support for SMS Works bureau to send SMS messages, cheaper than Kapow, and allows sender ID to be freely changed. Improvements for automatic X509 certificate ordering to support final ACME RFC, and socket server can now order certificates for servers other than web.   


OverbyteIcsHttpProt.pas
Jun 10, 2019 V8.62 
Added httpAuthJWT using AuthBearerToken for Json Web Token authentication.
Added ProxyURL property which combines four proxy properties as a URL for simplicity, ie http://[user[:password]@]host:port


OverbyteIcsIpStreamLog.pas
13 Jun 2019 - V8.62 - 
TCP server now uses root bundle correctly and reports certificate chain and bindings.


OverbyteIcsSSLEAY.pas
Jun 7, 2019 V8.62 
Removed two ciphers from TSslPrivKeyCipher which we did not use.


OverbyteIcsSslHttpRest.pas
Jun 12, 2019  - V8.62 - 
Add AsyncReq to TIcsSms methods for flexibility.
Supporting SMS Works at https://thesmsworks.co.uk/ for SMS.
Simple web server breaks down full URL for proxy requests.
TRestParams can add Json parameters as PContJson which means arrays and nested Json can be added.   


OverbyteIcsSslJose.pas
May 28, 2019  - 8.62 - 
Build Jason Web Token (JWT).


OverbyteIcsSslX509Certs.pas
Jun 18, 2019  - V8.62   
TDomainItem adds DDirWellKnown and DDirPubWebCert.
Added literals for various types to assist apps.
Removed Acme V1 protocol support (withdrawn from Nov 2019).
AcmeV2 now supports POST-as-GET per RFC8555 for the final ACME specification, GET alone being removed later in 2019.
Added Proxy URL support, might be needed for servers behind NAT firewalls for public access.
CertCenter AlwaysOn is discontinued and removed.
Comodo is now called Sectigo, sometimes old name still used.
Moved BuildCertName to X509Utils


OverbyteIcsSslX509Utils.pas
Jun 17, 2019 V8.62  
Added literals for various types to assist apps.
Moved BuildCertName here from X509Certs.


OverbyteIcsUtils.pas
Jun 11, 2019 V8.62 
Added IcsGetLocalTZBiasStr get time zone bias as string, ie -0700.
Added Time Zone support for date string conversions, to UTC time with a time zone, and back to local time using a time zone.
RFC3339_DateToStr and RFC1123_Date add time zone bias if AddTZ=True, ie -0700.
Added RFC3339_DateToUtcStr and RFC1123_UtcDate which convert local time to UTC and format it per RFC3339 with time zone bias.
RFC3339_StrToDate and RFC1123_StrToDate now recognises time zone bias and adjusts result if UseTZ=True.


OverbyteIcsWSocket.pas
Jun 10, 2019 V8.62 
Added SslCtxPtr to SslContext to allow use of OpenSSL functions outside this unit.
DHParams only needed for servers, don't use if using client.


OverbyteIcsWSocketS.pas
Jun 17 2019  V8.82 
If we loaded SSL intermediate certificates, stop OpenSSL attempting to build a chain.
When ordering X509 certificate, ChallFileSrv challenge now uses separate local web server for servers not using ports 80 or 443 such as FTP, SMTP, proxies, etc.
If IcsHosts SslCert is not found but have a valid directory, try default certificate file name based on Common Name instead, ie www_domain_com.pfx.  Ideally application should check if SslCert changes during ValidateHosts and update persistent storage.


OverbyteIcsFtpCli.pas
Jun 18, 2019 V8.62  
Set ftpFeatProtC when no PROT parameters passed.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Jun 12, 2019 - V8.62 
Supporting SMS Works at https://thesmsworks.co.uk/ for SMS.
Added Proxy URL for proxy support, ie http://[user[:password]@]host:port


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Jun 10, 2019 V8.82 
Removed DH file, only for servers.
Security Level uses newer Client Security Levelxxx, note that setting Ignore uses Min/Max Protocol and Cipher instead.
Support ProxyURL which combines four proxy options into single URL.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
17 Jun 2019 - V8.62 - 
SSL server now works properly again.
Allow SSL certificates to be ordered and installed automatically.
Added Log Directory for log file.  


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jun  4, 2019 V8.62 
Load several type lists from literals for future proofing.


Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer1.pas
Jun 18, 2019 V8.62 
Removed AcceptableHosts, never used with servers.


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Jun 13, 2019 - V8.62 
Supplier tab displays paths for cert and well-known dirs.
Load several type lists from literals for future proofing.
Removed Acme V1 protocol support (withdrawn from Nov 2019)
OpenSSL 1.0.2 only tick box gone, not needed any longer.
Added Proxy URL support, might be needed for servers behind NAT firewalls for public access.
CertCenter AlwaysOn is discontinued and removed.
Comodo is now called Sectigo, sometimes old name still used. 




------------------------------------------------------------------------
r1429 | angus | 2019-06-19 12:01:38 +0100 (Wed, 19 Jun 2019) | 5 lines
Changed paths:
   M /trunk/7-ZipOverbyteIcsV8.bat
   M /trunk/Default.dof
   A /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsBasNntp.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD5File.dproj
   A /trunk/Samples/Delphi/MiscDemos/OverbyteIcsTicks64Demo.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsHttpsServer.dproj
   A /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvDemo.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW.dproj
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.62 - Part 4

Updating zip list to add dozens of new dproj files, and added more missing dproj files.  

Updated 7zip batch file to log files processed, unfortunately does not log errors to file so still use winzip, but 7zip does find duplicate errors in the zip list. 
------------------------------------------------------------------------
r1430 | angus | 2019-06-20 10:00:50 +0100 (Thu, 20 Jun 2019) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.62 - Part 5

New time zone functions now work as documented. 
------------------------------------------------------------------------
r1431 | angus | 2019-07-03 19:14:37 +0100 (Wed, 03 Jul 2019) | 6 lines
Changed paths:
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.62 - Part 6

OverbyteIcsWSocketS.pas
Jul 03 2019  V8.82
Reverted change that stopped OpenSSL build a certificate chain, very bad idea, broke SSL servers. 

------------------------------------------------------------------------
r1432 | angus | 2019-07-19 13:05:35 +0100 (Fri, 19 Jul 2019) | 22 lines
Changed paths:
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWndControl.pas

ICS V8.62 - Part 7

Built OK with Delphi Rio 10.3 Update 2, aka 10.3.2, no changes needed.

Sorry, last SVN update would not build due to needing newer OverbyteIcsWSocket so here it is.  
There are a lot of other pending units waiting, just got to fix one SSL bug in socket server. 

OverbyteIcsWSocket.pas
Jul 04, 2019 V8.62
Added SslCtxPtr to SslContext to allow use of OpenSSL functions outside this unit.
DHParams only needed for servers, don't use if using client security to avoid issues with high security levels.
Raise background exception for user exceptions in OnDataAvailable event rather than silently ignoring them.
SSL ALPN now properly tested, for client SslAlpnProtocol property returns what the server selects (if anything), for server the selected protocol is now correctly sent.

OverbyteIcsWndControl.pas
Jul 5, 2019  V8.62 AllocateHWnd shows windows error description instead of error number, probably out of memory.

OverbyteIcsDefs.inc
Jul 2019 - V8.62 - 
Angus Turn off IMMUTABLE_STRINGS warnings in case project set them.


------------------------------------------------------------------------
r1433 | angus | 2019-07-25 16:02:45 +0100 (Thu, 25 Jul 2019) | 134 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSntp.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWhoisCli.pas
   M /trunk/Source/OverbyteIcsWndControl.pas

ICS V8.62 - Part 8

Probably the last update of V8.62 barring any bugs and some C++ stuff.  


OverbyteIcsHttpProt.pas
Jun 25, 2019 V8.62 
Added httpAuthJWT using AuthBearerToken for Json Web Token authentication.
Added ProxyURL property which combines four proxy properties as a URL for simplicity, ie http://[user[:password]@]host:port
Added AlpnProtocols property which is sent when an SSL connection starts and GetAlpnProtocol which returns which the server supports.     

OverbyteIcsIpStreamLog.pas
19 Jul 2019 - V8.62 - 
TCP server now uses root bundle correctly and reports certificate chain and bindings.
Ensure all listeners started for TCP Server, if more than one.

OverbyteIcsLIBEAY.pas
Jul 04, 2019  V8.62 
Added f_OBJ_create to add new NIDs.
ICS_NID_acmeIdentifier created dynamically since NID missing.
Fixed Asn1ToString bad octet conversion to hex.

OverbyteIcsMailQueue.pas
9 May 2019 - V8.62 -  
Added base MailCliSecurity property for MX servers.

OverbyteIcsSSLEAY.pas
Jul 15, 2019  V8.62 
Removed two ciphers from TSslPrivKeyCipher which we did not use.
SuppProtoAcmeV1 gone, two more added. 
Added ICS_NID_acmeIdentifier created dynamically on startup.

OverbyteIcsSslHttpRest.pas
Jul 22, 2019  - V8.62 - 
Add AsyncReq to TIcsSms methods for flexibility.
Supporting SMS Works at https://thesmsworks.co.uk/ for SMS.
Simple web server breaks down full URL for proxy requests.
TRestParams can add Json parameters as PContJson which means arrays and nested Json can be added.
TSimpleWebSrv now supports SSL, with certificate bundle and host name, supports SSL ALPN extension.
Added SslAllowSelfSign property to connect OK to sites with self signed SSL certificates.

OverbyteIcsSslX509Certs.pas
Jul 25, 2019  - V8.62   
TDomainItem adds DDirWellKnown and DDirPubWebCert
Added literals for various types to assist apps.
Removed Acme V1 protocol support (withdrawn from Nov 2019)
AcmeV2 now supports POST-as-GET per RFC8555 for the final ACME specification, GET alone being removed later in 2019.
Added Proxy URL support, might be needed for servers behind NAT firewalls for public access.
CertCenter AlwaysOn is discontinued and removed.
Comodo is now called Sectigo, sometimes old name still used.
Moved BuildCertName to X509Utils.
Check can create certificate directories before order starts.
Added ChallFileApp and ChallAlpnApp which mean SocketServer checks the challenge database in this unit using an event rather than writing files.
Support tls-alpn-01 challenge for local web server on 443.
BEWARE tls-alpn-01 challenge not working yet, wrong certificate is sent to client.

OverbyteIcsSslX509Utils.pas
Jul 04, 2019 V8.62  
Added literals for various types to assist apps.
Added AcmeIdentifier property for ACME validation certificate

OverbyteIcsUtils.pas
Jun 19, 2019 V8.62 
Added IcsGetLocalTZBiasStr get time zone bias as string, ie -0700.
Added Time Zone support for date string conversions, to UTC time with a time zone, and back to local time using a time zone.
RFC3339_DateToStr and RFC1123_Date add time zone bias if AddTZ=True, ie -0700.
Added RFC3339_DateToUtcStr and RFC1123_UtcDate which convert local time to UTC and format it per RFC3339 with time zone bias.
RFC3339_StrToDate and RFC1123_StrToDate now recognise time zone bias and adjust result if UseTZ=True from UTC to local time.

OverbyteIcsWndControl.pas
Jul 23, 2019 V8.62 
AllocateHWnd shows windows error description instead of error number, probably out of memory.
Moved FIcsLogger here from TWSocket ao this unit can log errors.
Added source parameter to HandleBackGroundException so we know where error came from, and diag log it.

OverbyteIcsWSocket.pas
Jul 25, 2019 V8.62 
Added SslCtxPtr to SslContext to allow use of OpenSSL functions outside this unit.
DHParams only needed for servers, don't use if using client security to avoid issues with high security levels.
Raise background exception for user exceptions in OnDataAvailable event rather than silently ignoring them.
SSL ALPN now properly tested, for client SslAlpnProtocol property returns what the server selects (if anything), for server the selected protocol is now correctly sent.
Moved FIcsLogger to TIcsWndControl ao that unit can log errors.
Added source to HandleBackGroundException so we know where

OverbyteIcsWSocketS.pas
Jul 25, 2019  V8.62  
When ordering X509 certificate, ChallFileSrv challenge now uses separate local web server for servers not using ports 80 or 443 such as FTP, SMTP, proxies, etc.
If IcsHosts SslCert is not found but have a valid directory, try default certificate file name based on Common Name instead, ie www_domain_com.pfx.  Ideally application should check if SslCert changes during ValidateHosts and update persistent storage.
Moved BuildCertName here from X509Certs.
Added source to HandleBackGroundException so we know where errors come from, when using IcsLogger.
Support tls-alpn-01 SSL certificate challenge, client has new OnClientAlpnChallg event that should provide the new self signed ACME certificate for the challenge.
BEWARE tls-alpn-01 challenge not working yet, wrong certificate is sent to client.
  
OverbyteIcsSntp.pas
OverbyteIcsSslJose.pas
OverbyteIcsWhoisCli.pas
OverbyteIcsWhoisCli.pas
Updated support information. 

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Jul 25, 2019 - V8.62 
Supporting SMS Works at https://thesmsworks.co.uk/ for SMS.
Added Proxy URL for proxy support, ie http://[user[:password]@]host:port
Allow Application Layer Protocol Negotiation (ALPN) to be set, mainly for HTTP/2 which we don't support yet, also Let's Encrypt. 

Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Jul 25, 2019 V8.82 
Removed DH file, only for servers.
Security Level uses newer Client Security Levelxxx, note that setting
Ignore uses Min/Max Protocol and Cipher instead.
Support ProxyURL which combines four proxy options into single URL.
SslAlpnProto replaced SslGetAlpnProto. 

Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jul  9, 2019 V8.62 
Load several type lists from literals for future proofing.
Report ACME Identifier in certificate, if it exists. 

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Jul 25, 2019 - V8.62 
Supplier tab displays paths for cert and well-known dirs.
Load several type lists from literals for future proofing.
Removed Acme V1 protocol support (withdrawn from Nov 2019)
OpenSSL 1.0.2 only tick box gone, not needed any longer.
Added Proxy URL support, might be needed for servers behind NAT firewalls for public access.
CertCenter AlwaysOn is discontinued and removed.
Comodo is now called Sectigo, sometimes old name still used.
Clear SAN grid properly.
BEWARE tls-alpn-01 challenge not working yet, wrong certificate is sent to client.


------------------------------------------------------------------------
r1434 | angus | 2019-08-06 10:50:32 +0100 (Tue, 06 Aug 2019) | 3 lines
Changed paths:
   M /trunk/Packages/OverbyteIcsCB2009Run.cbproj
   M /trunk/ReadMe8.txt

ICS V8.62 - Part 9

Updated C++ 2009 run time library with files needed to build for newer SSL versions, updated readne8 with more C++ notes. 
------------------------------------------------------------------------
r1435 | angus | 2019-08-07 17:36:33 +0100 (Wed, 07 Aug 2019) | 5 lines
Changed paths:
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLibeayEx.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.62 - Part 10

Updated various units so ICS now builds again without USE_SSL being defined, and with AUTO_X509_CERTS and NO_DEBUG_LOG defined.

Beware USE_SSL is set in both packages (DPROJ) and OverbyteIcsDefs.inc and seems quite hard to disable, finally resorted to {$UNDEF USE_SSL} in the include file.   
------------------------------------------------------------------------
r1436 | angus | 2019-08-13 18:02:37 +0100 (Tue, 13 Aug 2019) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsCryptUiApi.pas
   M /trunk/Source/OverbyteIcsJwaWinCrypt.inc
   M /trunk/Source/OverbyteIcsSspi.pas

ICS V8.63 - Part 1

Fixes to make it easier to build with C++.  
------------------------------------------------------------------------
r1437 | angus | 2019-09-12 12:37:55 +0100 (Thu, 12 Sep 2019) | 5 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libeay32.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/ssleay32.dll

ICS V8.63 - Part 2

Updated OpenSSL to 1.1.1d and 1.0.2t.


------------------------------------------------------------------------
r1438 | angus | 2019-10-10 17:20:14 +0100 (Thu, 10 Oct 2019) | 10 lines
Changed paths:
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.63 - Part 3

OverbyteIcsWSocket.pas
Oct 07, 2019 V8.63 Corrected fix for user exceptions in OnDataAvailable in last version to break receive loop after exception handling.

OverbyteIcsSslHttpRest.pas
Sept 19, 2019 - V8.63 - The SMS Works sync delivery works OK, try and return similar delivery responses as Kapow.

OverbyteIcsReg.pas
Version to V8.63
------------------------------------------------------------------------
r1439 | angus | 2019-10-23 12:21:25 +0100 (Wed, 23 Oct 2019) | 37 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.63 - Part 4

OverbyteIcsWSocket.pas
Oct 22, 2019 V8.63 
Corrected fix for user exceptions in OnDataAvailable in last version to break receive loop after exception handling.
Added LoadFromP12Buffer to load PFX certificate from buffer, thanks to Mitzi.
GetSelfSigned now has better check for self signed certificates.

OverbyteIcsWSocketS.pas
Oct 22, 2019 V8.63 
ValidateHosts, RecheckSslCerts and LoadOneCert have new AllowSelfSign to stop errors with self signed certificates.
Automatic cert ordering now works if cert file name has -bundle or -cert appended to end.

OverbyteIcsIpStreamLog.pas
22 Oct 2019 - V.63
SrvValidateHosts and SrvRecheckSslCerts have new AllowSelfSign to stop errors with self signed certificates.
Allow TCP server to start with certificate warnings.

OverbyteIcsSslX509Certs.pas
Oct 22, 2019 - V8.63
OpenAccount will now create a new account correctly.
Better response for CertOrderDomain if order collected.
Changed challenge checking from every 30 seconds to 10 seconds after a challenge started for faster completion.

OverbyteIcsSslX509Utils.pas
Oct 14, 2019 V8.63 
Added Starfield Root Certificate Authority - G2 (used by Amazon buckets)

OverbyteIcsUtils.pas
Oct 22, 2018 V8.63 
Better error handling in RFC1123_StrToDate to avoid exceptions.

Samples/Delphi/SslInternet/TrustedCABundle.pem
Added Starfield Root Certificate Authority - G2 (used by Amazon buckets)
This CA was already in the larger RootCaCertsBundle.pem file. 


------------------------------------------------------------------------
r1440 | angus | 2019-10-26 15:05:10 +0100 (Sat, 26 Oct 2019) | 38 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.63 - Part 5

The contents of the ICS CA trusted store may be found at: 

http://wiki.overbyte.eu/wiki/index.php/FAQ_ICS_SSL/TLS_CA_Trusted_Store_Contents

with information about how they are created and used at:

http://wiki.overbyte.eu/wiki/index.php/FAQ_SSL/TLS_Certificate_Authority_Root_Stores


OverbyteIcsWSocket.pas
Oct 24, 2019 V8.63 
Added Sha256Digest and Sha256Hex to TX509Base.
CertInfo in TX509Base shows SHA256 fingerprint instead of SHA1.

OverbyteIcsSslHttpRest.pas
Oct 24, 2019  - V8.63
Ensure default CA bundle gets loaded if SslRootFile blank (broken in V8.62).

OverbyteIcsSslX509Utils.pas
Oct 24, 2019 V8.63 
Added 'Starfield Services Root Certificate Authority - G2' (used by Amazon buckets), and 'Amazon Root CA 1', CA 2, CA 3, CA 4 which are replacing Starfield.  Removed expired certs.  


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Oct 25, 2019 V8.63 
Unwrap certificate fields for List Cert Store.

Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Oct 24, 2019 V8.63 
Report certificate sha256 fingerprint as well as sha1

Samples/Delphi/SslInternet/RootCaCertsBundle.pem
Samples/Delphi/SslInternet/TrustedCABundle.pem
Updated these bundles with new certificates and removing old certificates.  

------------------------------------------------------------------------
r1441 | angus | 2019-11-03 18:54:04 +0000 (Sun, 03 Nov 2019) | 39 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsSocketUtils.pas

ICS V8.63 - Part 6

Most of these FTP changes relate to running or accessing FTP servers behind NAT routers, where the internal and external IP addresses are different.  

OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
Nov 3, 2019  V8.63  
Added Option ftpFixPasvLanIP for when '227 Entering Passive Mode ()' returns a LAN IP instead of a WAN IP, so use control IP instead. This fixes failed downloads if the FTP server is behind a NAT router and is not configured to present the external IP.
Log IP addresses and ports for passive connections to ease debugging.

OverbyteIcsFtpMulti.pas
OverbyteIcsFtpMultiW.pas
3 Nov 2019  - V8.63
Added SslCliSecurity, FtpType and IgnorePaths to TIcsFtpMultiThread.
Threaded FTP now sends all log events to screen.

OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Nov 3, 2019  V8.63
ftpsNoPasvIpAddrInLan and ftpsNoPasvIpAddrSameSubnet options now work correctly to present local passive IP address on LAN rather than PassIpAddr which is usually external address.
Logging various IP addresses for PASV command for debugging. 

OverbyteIcsSocketUtils.pas
Nov 3, 2019  - V8.63
Added IcsIsIpPrivate override with a simple string IP. 


OverbyteIcsFileCopy.pas
2 Nov 2019 - V8.63
IgnorePaths property now works with D7.


Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
3 Nov 2019 - V8.63 - Added Fix Passive LAN IP Addr option where the FTP server is behind a NAT router and is not configured to present the external IP.


------------------------------------------------------------------------
r1442 | angus | 2019-11-08 10:38:32 +0000 (Fri, 08 Nov 2019) | 44 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

V8.63 - Part 7

This block of changes updates the ICS FTP server to use the IcsHosts concept added to the web and proxy servers two years ago, so the application does not need to setup an SSL context, can easily support multiple listeners and hosts, and can automatically order and install SSL/TLS certificates.  This has all been tested with my commercial FTP server, need to write a new FTP server sample using it, but the new IcsHosts setup loaded from an INI file is virtually the same as OverbyteIcsSslMultiWebServ.  


OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Nov 7, 2019  V8.63
ftpsNoPasvIpAddrInLan and ftpsNoPasvIpAddrSameSubnet options now work correctly to present local passive IP address on LAN rather than PassIpAddr which is usually external address.
Logging various IP addresses for PASV command for debugging.
New IcsHosts property which allows multiple hosts to be specified, each with one or two IP addresses and non-SSL and SSL port bindings, SSL certificates and private key, SSL context and security level.
If IcsHosts is specified, TSslWSocketServer ignores existing bindings and SSLContext, and creates new bindings and initialises an SSL context for each host checking and reporting all certificates.
Allow SSL certificates to be ordered and installed automatically by RecheckSslCerts if SslCertAutoOrder=True and so specified in IcsHosts, if a TSslX509Certs component is attached and a certificate supplier account has been created (by the OverbyteIcsX509CertsTst sample application).
New IcsLoadFtpServerWFromIni function that reads server settings from INI file, IcsHosts can be read using IcsLoadIcsHostsFromIni. 
When using IcsHosts, FtpSslTypes is set automatically to Implicit if an SSL port is specified or Explicit if AuthSslCmd is true. 

OverbyteIcsSslX509Certs.pas
Nov 7, 2019  - V8.63
OpenAccount will now create a new account correctly.
Better response for CertOrderDomain if order collected.
Changed challenge checking from every 30 seconds to 10 seconds after a challenge started for faster completion.
Clear Acme nonce after errors so a fresh nonce is found.
Added AutoAccountClose property so account is closed after order is completed or fails and AccountTimeOutMins to close it anyway when idle.

OverbyteIcsUtils.pas
Nov 7, 2018  V8.63 
Better error handling in RFC1123_StrToDate to avoid exceptions.
Added TypeInfo enumeration sanity check for IcsSetToStr and IcsStrToSet.

OverbyteIcsWSocketS.pas
Nov 7, 2019  V8.63 
ValidateHosts, RecheckSslCerts and LoadOneCert have new AllowSelfSign to stop errors with self signed certificates.
Automatic cert ordering now works if cert file name has -bundle or -cert appended to end.
IcsHosts has new AuthSslCmd property for when SSL is allowed on non-SSL port after AUTH SSL command or similar.
Automatic cert ordering now closes the account and local web server automatically and after order errors.  


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Nov 7, 2019 - V8.63
Better selection for supplier database order ListView.
10 minute timeout to close idle account.


------------------------------------------------------------------------
r1443 | angus | 2019-11-11 12:31:20 +0000 (Mon, 11 Nov 2019) | 29 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.63 - Part 8

Made some improvements to handle the OAuth2 version used by Google Accounts, allowing the REST component to access Google APIs such as 
Gmail.  Will also allow the ICS SMTP and POP3 components to support X0AUTH2 authentication but not done that yet. 

OverbyteIcsSslHttpRest.pas
Nov 11, 2019  - V8.63
The SMS Works sync delivery works OK, try and return similar delivery responses as Kapow.
Ensure default CA bundle gets loaded if SslRootFile blank (broken in V8.62).
Web server now lonnger adds date/time when logging allowing application to do it instead.
OAuth2 don't kill old refresh token if no refresh is available, Google APIs provides a single refresh that remains valid for weeks rather than a new one with each access token. Clarified the OAuth documentation to explain the Google process.
OAuth has extra TOAuthOptions OAopAuthPrompt and OAopAuthAccess for Google, OAopAuthPrompt uses property LoginPrompt usually 'consent', OAopAuthAccess and RefreshOffline=True requests a Refresh Token.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.res
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
Nov 11, 2019 - V8.63 
OAuth2 progress log display got lost.
Double click on Json array or object grid row to open object window parsing value, and again on object window.
Added two Google Gmail API URLs to the drop down list.
OAuth has Prompt and Access Offline for Google to requests a Refresh Token.




------------------------------------------------------------------------
r1444 | angus | 2019-11-14 11:54:09 +0000 (Thu, 14 Nov 2019) | 44 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.63 - Part 9

These changes relate to automatic certificate ordering, mostly cosmetic based on experience adding the feature into more applications with a few issues fixed.  Hopefully these are the last changes for V8.63. 


OverbyteIcsWSocketS.pas
Nov 13, 2019 V8.63 
ValidateHosts, RecheckSslCerts and LoadOneCert have new AllowSelfSign to stop errors with self signed certificates.
Automatic cert ordering now works if cert file name has -bundle or -cert appended to end.
IcsHosts has new AuthSslCmd property for when SSL is allowed on non-SSL port after AUTH SSL command or similar.
Automatic cert ordering now closes the account and local web server automatically and after order errors, and when the server is stopped.
Automatic cert ordering now Logs activity via the SslX509Certs component since this one does not have logging.

OverbyteIcsSslX509Certs.pas
Nov 12, 2019 - V8.63
OpenAccount will now create a new account correctly.
Better response for CertOrderDomain if order collected.
Changed challenge checking from every 30 seconds to 10 seconds after a
challenge started for faster completion.
Clear Acme nonce after errors so a fresh nonce is found.
Added AutoAccountClose property so account is closed after order is completed or fails and AccountTimeOutMins to close it anyway when idle. This avoids potential hacking attempts that often follow listing in SSL certificate transparency logs immediately after issue. 
Improved local web server and REST logging.
Added LastError to try and keep the last real order error.
Expire and remove challenges from the databsee after 24 hours or a week for manual/email/dns.

OverbyteIcsIpStreamLog.pas
13 Nov 2019 - V8.63
SrvValidateHosts and SrvRecheckSslCerts have new AllowSelfSign to stop errors with self signed certificates.
Allow TCP server to start with certificate warnings.

Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
13 Nov 2019 - V8.63
Restart server once first certificate issued.
Corrected log file name.

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Nov 12, 2019 - V8.63 
Better selection for supplier database order ListView.
10 minute timeout to close idle account.
Added List Challenges button to log list of pending challenges from the database.


------------------------------------------------------------------------
r1445 | angus | 2019-11-18 18:10:28 +0000 (Mon, 18 Nov 2019) | 11 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.63 - Part 10

This will become a final release in a couple of days provided all my own applications behave themselves.

OverbyteIcsWSocket.pas
Nov 18, 2019 V8.63 
Corrected INI file reading NostEnabled instead of HostEnabled.

OverbyteIcsWSocketS.pas
ReadMe8.txt
Dates and versions. 
------------------------------------------------------------------------
r1446 | angus | 2019-12-03 16:55:50 +0000 (Tue, 03 Dec 2019) | 54 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   A /trunk/Samples/Delphi/SslInternet/jose-rsa-prvkey.pem
   A /trunk/Samples/Delphi/SslInternet/jose-rsa-pubkey.pem
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 1

Really just bug fixes and omissions from earlier releases.  Might build on MacOS again but not tested yet. 


OverbyteIcsWSocketS.pas
Dec 03, 2019 V8.64 
IcsHosts allows NonSSlPort to be zero for random port, not for SSL.
Added BindPort read only property with real port while listening.
Added BindSrvPort to IcsHosts set while listening.
ListenStates now shows BindPort rather than requested port.

OverbyteIcsFileCopy.pas
2 Dec 2019 - V8.64
Using TFile.Copy class on MacOS (but no progress display).

OverbyteIcsIpStreamLog.pas
26 Nov 2019 - V8.64
If TCP Server listening on port 0, log random port allocated.
Don't start TCP Server if validation failed.
TCP Server shows listening ports.  

OverbyteIcsLIBEAY.pas
OverbyteIcsSslJose.pas
Dec 3, 2019   - 8.64
IcsJoseFindAlg accepts RSA-PSS keys for jsigRsa256/512 (Google).
But IcsJoseJWKPubKey does not support RSA-PSS keys due to OpenSSL.  

OverbyteIcsUtils.pas
Dec 2, 2019  V8.64 
Allow IcsGetUTCTime, IcsSetUTCTime, GetIcsFormatSettings to build on MacOS again, they use Windows only APIs.
IcsGetTempPath builds on MacOS.
IcsGetCompName now Windows only, only used in samples.

OverbyteIcsReg.pas
OverbyteIcsWSocket.pas
Nov 2019  V8.64  - Version only

Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
26 Nov 2019 - V8.64
Ensure old server port cleared when changing SSL.

Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
3 Dec 2019  - 8.64 
Corrected jose-ras files to jose-rsa and rsapsss to rsapss. 

Samples/Delphi/SslInternet/jose-rsa-prvkey.pem
Samples/Delphi/SslInternet/jose-rsa-pubkey.pem
ZipOverbyteIcsV8.lst
RSA was spelt RAS. 


------------------------------------------------------------------------
r1447 | angus | 2019-12-03 19:26:55 +0000 (Tue, 03 Dec 2019) | 8 lines
Changed paths:
   D /trunk/Samples/Delphi/SslInternet/jose-ras-prvkey.pem
   D /trunk/Samples/Delphi/SslInternet/jose-ras-pubkey.pem
   M /trunk/Source/OverbyteIcsSslJose.pas

ICS V8.64 - Part 2

OverbyteIcsSslJose.pas
Dec 3, 2019   - 8.64
IcsJoseFindAlg accepts RSA-PSS keys for jsigRsa256/512 (Google).
IcsJoseJWKPubKey need OpenSSL 1.1.1e to support RSA-PSS keys.


------------------------------------------------------------------------
r1448 | angus | 2019-12-04 19:02:13 +0000 (Wed, 04 Dec 2019) | 17 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas

ICS V8.64 - Part 3

OverbyteIcsLIBEAY.pas
Dec 04, 2019  V8.64 
Added f_EVP_PKEY_set_alias_type, f_EVP_PKEY_id, f_d2i_PUBKEY(_bio), f_i2d_PUBKEY_bio, f_EVP_PKEY_new/get_raw_private/public_key. 

OverbyteIcsSslJose.pas
Dec 4, 2019   - 8.64
IcsJoseFindAlg accepts RSA-PSS keys for jsigRsa256/512 (Google) and Ed25519 keys for jsigEdDSA
IcsJoseJWKPubKey needs OpenSSL 1.1.1e to support RSA-PSS keys.

Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
3 Dec 2019  - 8.64
Corrected jose-ras files to jose-rsa and rsapsss to rsapss.


------------------------------------------------------------------------
r1449 | angus | 2019-12-11 10:42:47 +0000 (Wed, 11 Dec 2019) | 18 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   A /trunk/Source/OverbyteIcsSuperXMLParser.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 4

These changes add XLM parsing to ICS, into an ISuperObject so SOAP and XML REST responses can be processed similarly to Json responses, there is no XML creation.  Not planning on adding OverbyteIcsSuperXMLParser to the packages, it's for applications only, not the library. 

OverbyteIcsSuperXMLParser.pas
Dec 11, 2019, created ICS version for XML applications in older versions of Delphi. 

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
Dec 10, 2019 - V8.64 
Added XML response parsing into a ISuperOject which can be processed similarly to a Json object, beware that XML content is converted into Json values, each level with two or three names: #attributes is an optional object from opening tag, #Name is the string from <Tag>, and #children which is an array of other Json objects and arrays nested within the tag. Note XML does have a concept of arrays as such.
Improved Json object double clicking display again.




------------------------------------------------------------------------
r1450 | angus | 2019-12-11 18:19:53 +0000 (Wed, 11 Dec 2019) | 12 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Source/OverbyteIcsSuperXMLParser.pas

V8.64 - Part 5

OverbyteIcsSuperXMLParser.pas
Dec 11, 2019, created ICS version for XML applications in older versions of
Delphi. 

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Dec 11, 2019 - V8.64 
Added XML response parsing into a ISuperOject which can be processed similarly to a Json object.
Improved Json object double clicking display again.

------------------------------------------------------------------------
r1451 | angus | 2019-12-23 18:15:43 +0000 (Mon, 23 Dec 2019) | 58 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsLogger.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/ZipOverbyteIcsV8.lst

V8.64 - Part 58.64 - Part 6

OverbyteIcsWSocket.pas
Dec 19, 2019 V8.64 
Ignore any errors with SSL APLN during handshake.

OverbyteIcsUtils.pas
Dec 18, 2019 V8.64 
Allow IcsGetUTCTime, IcsSetUTCTime, GetIcsFormatSettings to build on MacOS again, they use Windows only APIs.
IcsGetTempPath builds on MacOS.
IcsGetCompName now Windows only, only used in samples.
IcsStrListToWireFmt supports Unicode correctly.
IcsWireFmtToStrList checks buffer length valid.

OverbyteIcsHttpAppServer.pas
Dec 23, 2019 V8.64 
Ignore handler free errors.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
Dec 18, 2019 - V8.64 
Added XML response parsing into a ISuperOject which can be processed similarly to a Json object.
Improved Json object double clicking display again.
Corrected passing ALPN list to component.  


Samples/Delphi/SslInternet/OverbyteIcsJoseTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.pas
23 Dec 2019 - 8.64 
Corrected jose-ras files to jose-rsa and rsapsss to rsapss.
Added new Json/XML tab that allows blocks of Json or XML to be copy/pasted and parsed to objects in a grid, repeatedly. Also pretty prints Json, all to help Json debugging.  


Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst1.dfm
Loads DFM without errors in older compilers. 


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
23 Dec 2019  V8.64 
Log SSL APLN from client, if any and select HTTP/1.1
Rearranged INI file code so file only opened briefly, avoids conflict with WebAppSrvDataModule. 


Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
Dec 22, 2019 V8.64 
Stop web servers before closing.

ZipOverbyteIcsV8.lst
ReadMe8.txt
Corrected text for adding library paths to reflect changes in Delphi Options dialog. 


------------------------------------------------------------------------
r1452 | angus | 2020-01-08 17:12:35 +0000 (Wed, 08 Jan 2020) | 21 lines
Changed paths:
   M /trunk/Source/OverbyteIcsCharsetUtils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

V8.64 - Part 7

OverbyteIcsUtils.pas
Jan 08, 2020 V8.64 
IcsStrListToWireFmt supports Unicode correctly.
IcsWireFmtToStrList checks buffer length valid.
Declare TBytess function parameters as const to avoid reference counting corruption with cast pointers, thanks to Kas Ob for finding this, which caused stack corruption and unexpected errors mainly with 64-bit applications, probably.


OverbyteIcsWSocket.pas
Jan 08, 2020 V8.64 
Ignore any errors with SSL APLN during handshake.
Fixed a problem with SSL ALPN server handshake that may have caused unexpected exceptions mainly on 64-bit applications.


OverbyteIcsCharsetUtils.pas
Jan 08, 2020 V8.64 
Declare TBytess function parameters as const to avoid reference counting corruption with cast pointers, thanks to Kas Ob for finding this, which caused stack corruption and unexpected errors mainly with 64-bit applications, probably.



------------------------------------------------------------------------
r1453 | angus | 2020-01-21 10:55:07 +0000 (Tue, 21 Jan 2020) | 10 lines
Changed paths:
   M /trunk/Source/OverbyteIcsSslX509Utils.pas

ICS V8.64 - Part 7

Testing SVN install on Windows Server 2019 after 12 years unchanged on Windows Server 2008.  

OverbyteIcsSslX509Utils.pas

Jan 20, 2019 V8.64 
DoKeyPair raises exception for unknown key type.
CreateSelfSignedCert ignored Days and always created 7 day expiry.

------------------------------------------------------------------------
r1454 | angus | 2020-01-23 11:22:24 +0000 (Thu, 23 Jan 2020) | 51 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.64 - Part 9

Note more OverbyteIcsSslX509Certs.pas are pending. 

OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Jan 22, 2020 V8.64 
Added TFtpOptions ftpsAuthForceSsl which require SSL/TLS for LOGIN so no clear credentials allowed.  May also be set using IcsHosts with AuthForceSsl=True for specific Hosts only. Failure gives '533 USER requires a secure connection'. 


OverbyteIcsSSLEAY.pas
Jan 15, 2010  V8.64 
Changed sslSrvSecDefault to sslSrvSecHigh since TLSv1.1 disabled in most browsers from early 2020


OverbyteIcsSslX509Certs.pas
Jan 15, 2020 - V8.64
Fixed bug that stopped new orders after a successful one saying no more today, due to date not being cleared.
Allow use of EC keys for ACME account, not sure they work yet.
Added sanity check for private key type and check private key is generated OK.
With automatic order completion don't report errors if the challenges are not actually started, may take several minutes for manual DNS updating.


OverbyteIcsWSocketS.pas
Jan 22, 2020 V8.64 
IcsHosts allows NonSSlPort to be zero for random port, not for SSL.
Added BindPort read only property with real port while listening.
Added BindSrvPort to IcsHosts set while listening.
ListenStates now shows BindPort rather than requested port.
IcsHosts has new AuthForceSsl property, login only allowed once SSL/TLS negotiated so credentials never sent clear.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Dates only. 


Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.pas
Jan 22, 2020, V8.64 
Added TFtpOptions ftpsAuthForceSsl which require SSL/TLS for LOGIN so no clear credentials allowed.


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Jan 15, 2020 - V8.64 
Fixed bug that stopped new orders after a successful one saying no more today, due to date not being cleared.
Retain TRadiGroup defaults when reloading literals on first run.
No longer logs errors while waiting for DNS challenge to be manually updated. There will be one 'wait' for each domain being checked.  


------------------------------------------------------------------------
r1455 | angus | 2020-02-20 18:59:59 +0000 (Thu, 20 Feb 2020) | 38 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFileCopyW.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas

ICS V8.64 - Part 10


OverbyteIcsSslHttpRest.pas
Feb 20, 2019 - V8.64 
Added more parameter content types: PContXML, PContBodyUrlEn, PContBodyJson, PContBodyXML. The existing PContUrlEn and PContJson now specify REST params are sent as URL ? arguments, while the PContBodyxx version send params as content body.
This fixes a bug that meant PUT request params were always sent as URL ? arguments.  Note POST is always content body so  the wrong PContent is corrected automatically for backward compatibility.
XML content type is experimental, not tested.


OverbyteIcsFileCopy.pas
OverbyteIcsFileCopyW.pas
20 Feb 2020 - V8.64 
Using TFile.Copy class on MacOS (but no progress display).
Removed MultiThreaded no longer used, TIcsWndControl version now used.


OverbyteIcsSslX509Certs.pas
Feb 07, 2020 - V8.64
Fixed several typos, sorry.   


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Feb 20, 2019 - V8.64 
Added XML response parsing into a ISuperOject which can be processed similarly to a Json object.
Improved Json object double clicking display again.
Corrected passing ALPN list to component.
Added more parameter content types: PContXML, PContBodyUrlEn, PContBodyJson, PContBodyXML. The existing PContUrlEn and PContJson now specify REST params are sent as URL ? arguments, while the PContBodyxx version send params as content body.
This fixes a bug that meant PUT request params were always sent as URL ? arguments.  Note POST is always content body so  the wrong PContent is corrected automatically for backward compatibility.
XML content type is experimental, not tested.


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Dates only. 

------------------------------------------------------------------------
r1456 | francois | 2020-03-12 14:46:17 +0000 (Thu, 12 Mar 2020) | 1 line
Changed paths:
   M /trunk/Source/OverbyteIcsWndControl.pas

Update year in WndControl. Actually, just to verify write permission to repository.
------------------------------------------------------------------------
r1457 | angus | 2020-03-12 18:09:43 +0000 (Thu, 12 Mar 2020) | 139 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDnsResolver1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup.dproj
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsCookies.pas
   M /trunk/Source/OverbyteIcsDnsQuery.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIcmp.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsPing.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSmtpSrv.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUrl.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.64 - Part 11

Major update to support for International Domain Names for Applications (IDNA), i.e. using accents and Unicode characters in domain names.  

Domain names can only contain lowercase ASCII letters and numbers and a couple of symbols, so Unicode U-Labels (nodes in a domain) must be converted to A-Labels (Punycode ASCII) with an ACE (ASCII Compatible Encoding) prefix.  So www.mâgsÿstést.eu becomes 
www.xn--mgsstst-pwa1e4l.eu and ??????????.?? becomes xn--90aijkdmaud0d.xn--p1ai.  

ICS mostly does the Unicode to A-Label conversion just before looking up an IP address for a domain name (in DnsLookup) and converts back from A-Label to Unicode when doing a reverse lookup (in ReverseDnsLookup).  HTTP headers also contain A-Labels for the Host: header and the host part of URLs for proxy or relocation, but Unicode paths should be UrlEncoded by the application as now.  Not looked at SMTP yet.  

The HTTP client and server, Ping, ICMP and DNS Query components all now support Unicode domain names, generally without application changes unless you want to display the A-Label name looked-up (PunycodeHost property).  DNS Query does require application changes due to all methods and properties previously being AnsiString, now String.    

SSL/TLS now fully supports Unicode domain names, including displaying the Unicode version of the domain name (except for Subject and Issuer lines), and X509 automatic certificate ordering from Let's Encrypt fully supports Unicode domain names.  Certificate files are saved with Unicode names, not A-Labels.   


OverbyteIcsUtils.pas
Mar 10, 2020 V8.64 
IcsIDNAToASCII converts a Unicode domain or host name into A-Label (Punycode ASCII) if any characters over x7F, preceding with ACE (ASCII Compatible Encoding) prefix xn--.
IcsIDNAToUnicode converts an A-Label (Punycode ASCII) domain or host name into Unicode if any ACE (ASCII Compatible Encoding) prefixes xn-- are found.
IcsToASCII and IcsToUnicode are similar but work on simple labels (the nodes in a domain name), uses ACE.
IcsPunyEncode and IcsPunyDecode do the actual Unicode conversion to and from A-Label (Punycode ASCII), no ACE.
Sample OverbyteIcsBatchDnsLookup has lots of ISN test names.


OverbyteIcsWSocket.pas
Mar 12, 2020 V8.64 
DnsLookup now converts Unicode IDN into A-Label (Punycode ASCII) so accented and non-ansi domains lookup correctly.  PunycodeHost is read only with the converted name for display, i.e. éxàmplê.ftptest.co.uk converts to xn--xmpl-0na6cm.ftptest.co.uk.
ReverseDnsLookup converts a A-Label (Punycode ASCII) domain name to Unicode, if the ACE prefix xn-- is found in a name.
Added new ComponentOptions: wsoUseSTD3AsciiRules will cause DnsLookup to fails if there are illegal symbols in domain names, wsoIgnoreIDNA uses old behaviour for ANSI domain names so no Unicode support, only limited ASNI, sometimes.
X509 certificate A-Label domain names converted to Unicode.
OpenSSL uses A-Label (Punycode ASCII) in host names, not UTF8.
Open and save SSL certificate files with Unicode names not ANSI.


OverbyteIcsCookies.pas
Mar 9 2020  V8.64  
Try and support Unicode domains.


OverbyteIcsDnsQuery.pas
Mar 10 2020 V8.64 
Make sure data not processed beyond end of response buffer.
All methods and arrays use String instead of AnsiString to support Unicode domain names.  This may need application changes.
All Unicode queries are converted to Punycode ASCII, and responses  with ACE zn-- prefix are converted back to Unicode.


OverbyteIcsHttpProt.pas
Mar 10, 2020 V8.64 
Host: header now has A-Label (Punycode ASCII) domain name.
Proxy URL host is converted to A-Label. 
Location property returms a Unicode URL.
PunyCodeHost read only returns A-Label for first DNSLookup.


OverbyteIcsHttpSrv.pas
Mar 11, 2020 V8.64 
Host: header contains A-Label (Punycode ASCII) name, convert to Unicode to compare Hosts.


OverbyteIcsIcmp.pas
OverbyteIcsPing.pas
Mar 10, 2020 V8.64 
PunycodeHost returns name looked up.


OverbyteIcsMailQueue.pas
9 Mar 2020 - V8.64 
Currently just DnsQuery returns Unicode.


OverbyteIcsSmtpSrv.pas
Mar 10, 2020 V8.64 
Currently just DnsQuery returns Unicode.


OverbyteIcsSSLEAY.pas
Mar 08, 2020  V8.64 
Changed sslSrvSecDefault to sslSrvSecHigh since TLSv1.1  disabled in most browsers from early 2020


OverbyteIcsSslHttpRest.pas
Mar 11, 2020  - V8.64
Only REST change here is to report A-Label domain looked up by DNS.
SimpleWebSrv returns host: name in Unicode.   
Added more parameter content types: PContXML, PContBodyUrlEn, PContBodyJson, PContBodyXML. The existing PContUrlEn and PContJson now specify REST params are sent as URL ? arguments, while the PContBodyxx version send params as content body.
This fixes a bug that meant PUT request params were always sent  as URL ? arguments.  Note POST is always content body so  the wrong PContent is corrected automatically for backward compatibility.
XML content type is experimental, not tested. 
Verifying the SSL certificate chain with the Windows Store  works again.
TDnsQueryHttps component now uses strings and support IDNs.


OverbyteIcsSslX509Certs.pas
Mar 11, 2020 - V8.64
X509 certificates always have A-Lavels (Punycode ASCII) domain names, never UTF8 or Unicode.   IDNs are converted back to Unicode
Fixed bug that stopped new orders after a successful one  saying no more today, due to date not being cleared.
Allow use of EC keys for ACME account, not sure they work yet.
Added sanity check for private key type and check private  key is generated OK.
With automatic order completion don't report errors if the challenges are not actually started, may take several minutes for manual DNS updating.
The onChallengeDNS/Email/FTP events have an extra parameter ChlgOK which the application should set once the challenge have been set-up, so the component can stop if necessary. Sorry, this requires application changes.  
Fixed several literal typos, sorry.


OverbyteIcsSslX509Utils.pas
Mar 12, 2020 V8.64 
X509 certificates always have A-Lavels (Punycode ASCII) domain names, never UTF8 or Unicode.
CreateRsaKeyPair uses Unicode file names, as do all other SSL certificate functions (through IcsSslOpenFileBio).


OverbyteIcsUrl.pas
Mar 10, 2020 V8.64 
Added IcsBuildURL, IcsURLtoASCII and IcsURLtoUnicode to support International Domain Names, note these are primarily for display purposes, ICS now handles IDNs internally.


Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup1.pas
Mar 10, 2020  V8.64 
The IDN button encodes the IDN list into Punycode ASCII and then back to Unicode again.  If built on a pre-Unicode compiler, some domains will appear as ???.
When doing DNS Lookups, the actual Punycode ASCII domain looked-up is shown.  
A blank IDN list on startup loads default list which includes a lot of Unicode domain names. 


Samples/Delphi/OtherDemos/OverbyteIcsDnsResolver1.pas
Samples/Delphi/OtherDemos/OverbyteIcsNsLookup.dproj
Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
Samples/Delphi/OtherDemos/OverbyteIcsPingTst1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsPingTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Several samples have minor changes to show the A-Label name looked up rather than the Unicode Host. 


------------------------------------------------------------------------
r1458 | angus | 2020-03-12 18:35:21 +0000 (Thu, 12 Mar 2020) | 5 lines
Changed paths:
   M /trunk/Source/Include/OverbyteIcsDefs.inc

ICS V8.64 - Part 12

Source/Include/OverbyteIcsDefs.inc
Prepare for Delphi 10.4. 

------------------------------------------------------------------------
r1459 | angus | 2020-03-14 19:13:04 +0000 (Sat, 14 Mar 2020) | 24 lines
Changed paths:
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv1.pas
   A /trunk/Samples/Delphi/SslInternet/websocketclient.html
   A /trunk/Source/OverbyteIcsWebSockets.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 13

Added Websocket server implementation (HIXIE and HYBIE protocols) ported from phpws project, written by Stan Korotky <stasson@orc.ru>. 

There is no a specific component for websockets, they are handled internally from a custom TWebSockSrvClient.

Please note this is an experimental server websocket implementation, that needs a lot more testing in case the protocol has changed in the last eight years.

 
OverbyteIcsWebSockets.pas
05 Mar 2012   V0.01 Initial release
23 Nov 2012   Bug fix in cookie_parse
Mar 13, 2020 - V8.64
Angus combined several original units into single unit here, renamed main derived client to TWebSockSrvClient to avoid conflicts with other components.


Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv.dpr
Mar 05, 2012 v0.01 Initial release of websockets demo for ICS.
Mar 13, 2020 - V8.64
Angus using ICS version.

This demo may be tested against the  web page websocketclient.html which should be accessed from a server using the same IP address as this application, such as the ICS demo web server.  The web page uses the WebSocket API with Javascript to send data to the server which is echoed back to the page.


------------------------------------------------------------------------
r1460 | angus | 2020-03-18 11:23:57 +0000 (Wed, 18 Mar 2020) | 3 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.64 - Part 14

Updated OpenSSL to 1.1.1e
------------------------------------------------------------------------
r1461 | angus | 2020-03-28 12:16:07 +0000 (Sat, 28 Mar 2020) | 99 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OtherDemos.bpg
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.dfm
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebConfig.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebCounter.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebCounterView.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebDataModule.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebDataModule.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebHead.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebHelloWorld.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebHomePage.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebHttpHandlerBase.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebLogin.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebSessionData.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebUploads.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebUrlDefs.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServerMailer.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServerMain.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   A /trunk/Source/OverbyteIcsWmi.pas
   A /trunk/Source/WbemScripting_TLB.dcr
   A /trunk/Source/WbemScripting_TLB.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 15

Hopefully the last major block of updates before the final release of V8.64.  

Added a new WMI component based on the Magenta Systems WMI and SMART Component but without any disk drive stuff and a new WMI demo application.  The WMI component allows listing all WMI classes, adding and updating network adaptor IP addresses, and adding and updating records in Windows DNS Server (2012 and later), the demo is considerably improved on the original.   The WMI component was originally written to customise cloned industrial PCs setting up networking from a database.  For ICS, WMI is currently only used by the OverbyteIcsX509CertsTst sample to order wildcard SSL/TLS certificates from Let's Encrypt.   

The other major improvement is a low level SSL/TLS handshake improvement using a new OpenSSL API called before processing of the initial client hello sent before protocol and cipher negotiation starts, when it is easier to select the SslContext to be used on shared servers supporting lots of hosts.  This allows logging of client hello parameters which may help diagnosing connection problems with failed handshakes, illustrated in the OverbyteIcsSslMultiWebServ and OverbyteIcsSslWebServ samples.  It also fixes an issue that prevented the Let's Encrypt TLS-ALPN challenge working.  

These changes mean free Let's Encrypt SSL certificates can now be automatically ordered by ICS servers or the sample application using all supported domain name approval challenges, port 80 using a file, port 443 using TLS-ALPN and Windows DNS Server for wildcard or off-line ordering, all allowing multiple domain names on the same certificate.  

OverbyteIcsWSocket.pas
Mar 26, 2020 V8.64 
Support new OpenSSL 1.1.1 ClientHelloCallback which mostly replaces ServerName callback setting all client negotiation information before the SSL session starts in the CliHelloData property.  The onSslServerName event is still called, from  where you can access CliHelloData and SslServerName.
WSocketGetCliHelloStr function returns description of CliHelloData. Allows the server to choose an SSL context appropriate to the client's capabilities, such as for Let'S Encrypt acme-tls/1 challenge which did not work before, or ECC SSL certificates which are smaller than RSA but not always supported.
The onSslAlpnSelect event is now only needed to tell the client which ALPN to choose, generally for HTTP/2 only.
Ignore any errors with SSL APLN during handshake.
Removed TlsExtension_cb callback which wrote a lot to the debug log, same information now in CliHelloData property from ClientHelloCallback.
Another attempt to improve handshake error messages.
Removed X509CATrust and related properties and methods from TX509Base, it was used by the ValidateCertChain method which  now accepts a shared TX509List instead for efficiency.


OverbyteIcsWSocketS.pas
Mar 26, 2020 V8.64 
Support ChallengeType=ChallAlpnApp for tls-alpn-01 SSL certificate challenge, client has new OnClientAlpnChallg event that should provide the new self signed ACME certificate for the challenge sent using a temporary SslContext.
Removed ALPN handling added in V8.62 which was called too late by OpenSSL to change the SSL context, now checking ALPN earlier from new ClientHello callback.
Internally replaced FRootCAX509 with FX509CAList for use by ValidateCertChain as Root CA store.


OverbyteIcsSslHttpRest.pas
Mar 26, 2020  - V8.64 
TSimpleWebSrv no longer processes ALPN, done in SocketServer.


OverbyteIcsSslX509Certs.pas
Mar 19, 2020 - V8.64 
Support tls-alpn-01 challenge for local web server on 443.


OverbyteIcsSslX509Utils.pas
Mar 27, 2020 V8.64 
Skip domain name checking for wildcard certificates. 


OverbyteIcsWmi.pas
WbemScripting_TLB.pas
Mar 27, 2020  - V8.64
New units for WMI. 

OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Mar 18, 2019  V8.64
Added f_EVP_PKEY_set_alias_type, f_EVP_PKEY_id, f_d2i_PUBKEY(_bio), f_i2d_PUBKEY_bio, f_EVP_PKEY_new/get_raw_private/public_key. Added f_OPENSSL_free.
Added SSL_client_hello functions and SSL_bytes_to_cipher_list.

Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dof
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dpr
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.dproj
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst.res
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.pas
27 Mar 2020 - V8.64 baseline
New WMI demo. 

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Mar 27, 2020 - V8.64 
Added support for International Domain Names for Applications (IDNA), i.e. using accents and unicode characters in domain names.
X509 certificates always have A-Lavels (Punycode ASCII) domain names, never UTF8 or Unicode.   IDNs are converted back to Unicode for display, but X509 subject remains as A-Labels.
Fixed bug that stopped new orders after a successful one saying no more today, due to date not being cleared.
Retain TRadiGroup defaults when reloading literals on first run.
No longer logs errors while waiting for DNS challenge to be  manually updated. There will be one 'wait' for each domain being checked.
Support Domain Name Server Challenge automatically, updates Windows DNS Server with TXT records for DNS Challenges using WMI and local web server. Pending Cloudfare DNS using REST.
Support TLS-ALPN Cert Challenge for tls-alpn-01 SSL Certificate, using local web server.
Certificate chain validation changed to use TX509List.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Mar 26, 2020 V8.64 
Certificate chain validation changed to use TX509List.  


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
26 Mar 2020  V8.64 
Check SSL APLN from client and select HTTP/1.1.
Rearranged INI file code so file only opened briefly, avoids conflict with SslMultiWebDataModule.
Added Display SSL Client Info box logs client hello and ciphers.
No longer sharing OverbyteIcsWebAppServerXX units from WebDemos  directory, renamed to OverbyteIcsSslMultiWebXX. Note still shares templates with WebDemos.  

Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
Mar 26, 2020 V8.64 
Stop web servers before closing.
Display SSL client hello information.
Certificate chain validation changed to use TX509List.  



------------------------------------------------------------------------
r1462 | angus | 2020-03-28 15:05:07 +0000 (Sat, 28 Mar 2020) | 3 lines
Changed paths:
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv.dproj
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 16

Zip some new files correctly. 
------------------------------------------------------------------------
r1463 | angus | 2020-04-01 18:05:42 +0100 (Wed, 01 Apr 2020) | 3 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.64 - Part 17

Updated OpenSSL to 1.1.1f, this reverts a change in 1.1.1e that caused problems in some applications, but I don't believe ICS was effected. 
------------------------------------------------------------------------
r1464 | angus | 2020-04-21 18:30:41 +0100 (Tue, 21 Apr 2020) | 3 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.64 - Part 18

Updated OpenSSL to 1.1.1g, this fixes a severe security vulnerability (denial of service) checking certificates with TLS/1.3, however the API that does this not used by ICS so our applications are not effected. 
------------------------------------------------------------------------
r1465 | angus | 2020-05-04 17:33:50 +0100 (Mon, 04 May 2020) | 92 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsDnsQuery.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSocketUtils.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWmi.pas
   M /trunk/ZipOverbyteIcsV8.lst

CS V8.64 - Part 19

Last major changes for this release, really just documentation and testing left.  

Main change is X509 certificate ordering improvements from Let's Encrypt.  Also SslSocketServer will now automatically generate a self signed SSL certificate on start-up if no SSL certificate can be found, so the server starts.  The server may then order a certificate from Let's Encrypt if so configured, which needs the server running for certain domain challenges.  


OverbyteIcsWSocket.pas
May 04, 2020 V8.64 
Fixed memory leak in SslGetAllCerts, and bad declarations of SslProtoMsgCallback and CheckIPaddr thanks to Ralf Junker.

OverbyteIcsWSocketS.pas
May 04, 2020 V8.64 
Create a self signed SSL certificate so server can start if certificate file can not be found or is missing.  Needed for ChallengeType=ChallAlpnApp to create a new certificate,  but always done to make life easier.  Tries to use the  specified certificate directory, TEMPDIR if none specified.
Don't start SSL certificate order until server is listening.

OverbyteIcsDnsQuery.pas
May 04 2020 V8.64  
Make sure data not processed beyond end of response buffer.
Added support for International Domain Names for Applications (IDNA), 
All methods and arrays use String instead of AnsiString to support Unicode domain names.  This may need application changes.
All Unicode queries are converted to Punycode ASCII, and responses with ACE zn-- prefix are converted back to Unicode. RRecord has AnswerName and HostName for unicode responses.

OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
May 01, 2020 V8.64 
Better error handling when all passive ports are being used.
Fixed a range error with passive connections is range checking was enabled, option ftpsNoPasvIpAddrSameSubnet and adaptors had IPv6 addresses.

OverbyteIcsSocketUtils.pas
May 01, 2020 - V8.64
Disable range checks else PSockAddrIn6 casting sometimes fails with IPV6 addresses (no idea why).
Don't get IPv6 addresses when checking IPv4 subnet.


OverbyteIcsIpStreamLog.pas
27 Apr 2020 - V8.64
If TCP Server listening on port 0, log random port allocated.
Don't start TCP Server if validation failed.
TCP Server shows listening ports.

OverbyteIcsProxy.pas
27 Apr 2020 - V8.64 
Added SSL certificate ordering ChallFileApp and ChallAlpnApp challenges, as well as ChallFileUNC.

OverbyteIcsLIBEAY.pas
May 04, 2020  V8.64 
Fixed declarations of f_X509_check_ip_asc thanks to Ralf Junker.
Added more exports for key processing, thanks to Linden Roth. 

OverbyteIcsSSLEAY.pas
Apr 24, 2020  V8.64
Added ChallDnsAuto and ChallDnsMan
Fixed declarations of f_SSL_clear, TProto_msg_cb and  f_SSL_bytes_to_cipher_list thanks to Ralf Junker.

OverbyteIcsSslJose.pas
May 4, 2020   - 8.64  
Fixed a bug in IcsBase64UrlDecode thanks to Linden Roth.
Cleaned up signing and verifying functions.

OverbyteIcsSslX509Certs.pas
May 04, 2020 - V8.64
The onChallengeDNS/Email/FTP events have an extra parameter ChlgOK which the application should set once the challenge have been set-up, so the component can stop if necessary. Sorry, this requires application changes.
Now storing wildcard and host challenges separately, so they can be used together for the same domain.
Fixed several literal typos, sorry.
Support tls-alpn-01 challenge for local web server on 443.
WebSrvHttp event to check http-01 ChallFileApp well-known challenge without neding to save a file.
Avoid possible logging exception with StopDomSrv during destroy. 
Added testing DNS challenges against public DNS servers. 
Major restructure of ordering process so that challenges are obtained and locally tested before the Acme order process starts, Acme challenges are valid for seven days, so this allows manual DNS challenges to be set-up and tested  later.
Implemented SelfSigned function to create certificate from properties, optionally as a CA (for Own CA).

OverbyteIcsSslX509Utils.pas
May 04, 2020 V8.64 
Added CreateSelfSignCertEx to create self signed certificates with subject alternate names and specific key type, used by TSocketServer  to start servers with missing certificates.

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
May 04, 2020 - V8.64 
Split Acme ordering into get, local test and then start challenges, added step numbers (1) to buttons to make process  more obvious. This allows manual updating of servers for DNS or file challenge.
Self Signed button now works and will create CA Cert.

Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
27 Apr 2020  V8.64 
Added SSL certificate ordering ChallFileApp and ChallAlpnApp challenges, as well as ChallFileUNC.

------------------------------------------------------------------------
r1466 | angus | 2020-05-08 19:20:09 +0100 (Fri, 08 May 2020) | 41 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/01cert.pem
   M /trunk/Samples/Delphi/SslInternet/01key.pem
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dof
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dpr
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dproj
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.res
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer1.dfm
   D /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   D /trunk/Samples/Delphi/SslInternet/libeay32.dll
   D /trunk/Samples/Delphi/SslInternet/ssleay32.dll
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.64 - Part 20

Probably the final main unit updates, bug fixes. Finished testing X509 automatic certificate ordering. 

Include/OverbyteIcsDefs.inc
May 08, 2020 V8.64
Delphi 10.4 Sydney. 

OverbyteIcsSslHttpRest.pas
May 05, 2020 V8.64
Made TSimpleWebSrv.WebServer writable to set properties.

OverbyteIcsSslX509Certs.pas
May 08, 2020 V8.64
Implement AcmeV2OrderCancel to cancel order and revoke order, former useful to remove old challenges (which remain valid for a week or more) so fresh challenges can be tested.
 
OverbyteIcsSslX509Utils.pas
Samples/Delphi/SslInternet/TrustedCABundle.pem
May 08, 2020 V8.64
Renamed SaveToDERText to SaveReqToDERText for clarity, added SaveCertToDERText.
Added root 'AAA Certificate Services' for Comodo, aka Sectigo.
Simplified building alternate subject name extensions so that both  DNS and IP Address can be used together, and IP address is now saved correctly.

OverbyteIcsWSocketS.pas
May 08, 2020 V8.64
ACME tls-alpn-01 challenge context swapping now logged to  X509Certs log instead of debug log.

Samples/Delphi/SslInternet/01cert.pem
Samples/Delphi/SslInternet/01key.pem
New localhost self signed certificate with IP addresses. 

deleted    Samples/Delphi/SslInternet/libeay32.dll
deleted    Samples/Delphi/SslInternet/ssleay32.dll
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dof
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dpr
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.dproj
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer.res
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer1.dfm
deleted    Samples/Delphi/SslInternet/OverbyteIcsHttpsServer1.pas
Obsolete sample and unsupported OpenSSL files gone. 

------------------------------------------------------------------------
r1467 | angus | 2020-05-12 17:53:05 +0100 (Tue, 12 May 2020) | 3 lines
Changed paths:
   A /trunk/Install/CB104InstallVclFmx.groupproj
   A /trunk/Install/D104Install.groupproj
   A /trunk/Install/D104InstallVclFmx.groupproj
   A /trunk/Packages/IcsCommonCB104Design.cbproj
   A /trunk/Packages/IcsCommonCB104Design.cpp
   A /trunk/Packages/IcsCommonCB104Design.res
   A /trunk/Packages/IcsCommonCB104Run.cbproj
   A /trunk/Packages/IcsCommonCB104Run.cpp
   A /trunk/Packages/IcsCommonCB104Run.res
   A /trunk/Packages/IcsCommonD104Design.dpk
   A /trunk/Packages/IcsCommonD104Design.dproj
   A /trunk/Packages/IcsCommonD104Run.dpk
   A /trunk/Packages/IcsCommonD104Run.dproj
   A /trunk/Packages/IcsFmxCB104Design.cbproj
   A /trunk/Packages/IcsFmxCB104Design.cpp
   A /trunk/Packages/IcsFmxCB104Design.res
   A /trunk/Packages/IcsFmxCB104Run.cbproj
   A /trunk/Packages/IcsFmxCB104Run.cpp
   A /trunk/Packages/IcsFmxCB104Run.res
   A /trunk/Packages/IcsFmxD104Design.dpk
   A /trunk/Packages/IcsFmxD104Design.dproj
   A /trunk/Packages/IcsFmxD104Run.dpk
   A /trunk/Packages/IcsFmxD104Run.dproj
   A /trunk/Packages/IcsVclCB104Design.cbproj
   A /trunk/Packages/IcsVclCB104Design.cpp
   A /trunk/Packages/IcsVclCB104Design.res
   A /trunk/Packages/IcsVclCB104Run.cbproj
   A /trunk/Packages/IcsVclCB104Run.cpp
   A /trunk/Packages/IcsVclCB104Run.res
   A /trunk/Packages/IcsVclD104Design.dpk
   A /trunk/Packages/IcsVclD104Design.dproj
   A /trunk/Packages/IcsVclD104Run.dpk
   A /trunk/Packages/IcsVclD104Run.dproj
   A /trunk/Packages/OverbyteIcsD104Design.dpk
   A /trunk/Packages/OverbyteIcsD104Design.dproj
   A /trunk/Packages/OverbyteIcsD104Run.dpk
   A /trunk/Packages/OverbyteIcsD104Run.dproj
   M /trunk/ReadMe8.txt
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 21

Added packages and install groups for Delphi and C++ 10.4 Sydney. 
------------------------------------------------------------------------
r1468 | angus | 2020-05-12 17:57:03 +0100 (Tue, 12 May 2020) | 4 lines
Changed paths:
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.64 - Part 22

Simple fix to handle empty extensions in SSL client hello. 

------------------------------------------------------------------------
r1469 | angus | 2020-05-13 10:28:04 +0100 (Wed, 13 May 2020) | 3 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.64 - Part 23

Zip 10.4 packages. 
------------------------------------------------------------------------
r1470 | angus | 2020-05-13 16:14:44 +0100 (Wed, 13 May 2020) | 12 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.pas
   M /trunk/Samples/Delphi/BrowserDemo/HTMLAbt.pas
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsWSocket.pas

V8.64 - Part 24

OverbyteIcsWSocket.pas
Another fix for corrupted SSL client hello.


Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
Samples/Delphi/BrowserDemo/FBUnitIcs.pas
Samples/Delphi/BrowserDemo/HTMLAbt.pas
Samples/Delphi/BrowserDemo/TrustedCABundle.pem
Updated Browser Demo for V8.64

------------------------------------------------------------------------
r1471 | angus | 2020-05-14 17:11:31 +0100 (Thu, 14 May 2020) | 3 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.64 - Part 25

More minor fixes, Client Hello yet again, for Unicode compilers, Jason Web Signing but nothing actually failed.  
------------------------------------------------------------------------
r1472 | angus | 2020-05-17 14:11:51 +0100 (Sun, 17 May 2020) | 4 lines
Changed paths:
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas

ICS V8.64 - Part 26

May 17, 2020  - 8.64 
Fixed various EVP digests with size_t for Win64, caused problems with digital signatures. 
------------------------------------------------------------------------
r1473 | angus | 2020-05-18 18:58:33 +0100 (Mon, 18 May 2020) | 7 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.64 - Part 27

Fixed another Win64 bug creating SSL certificates with alternate subject names.  

Updated documentation for the TSslX509Certs component.  

Updated dates for samples effected by these changes. 
------------------------------------------------------------------------
r1474 | angus | 2020-05-27 10:50:34 +0100 (Wed, 27 May 2020) | 7 lines
Changed paths:
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
   M /trunk/Source/OverbyteIcsDnsQuery.pas

ICS V8.65 - Part 1

Samples/Delphi/OtherDemos/OverbyteIcsNsLookup1.pas
OverbyteIcsDnsQuery.pas
May 25 2020 V8.65 
Handle NS and CNAME responses as host name with compressed  data correctly.

------------------------------------------------------------------------
r1475 | angus | 2020-06-01 12:22:03 +0100 (Mon, 01 Jun 2020) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.65 - Part 2

Minor fix in Utils to compile with Delphi 7.
------------------------------------------------------------------------
r1476 | angus | 2020-06-12 18:05:42 +0100 (Fri, 12 Jun 2020) | 57 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 3

Previously the Jose unit offered functions primarily for client JWS/JWT REST applications, it now includes extra functions for REST servers to check and verify the JWS/JWT sent by clients.  


OverbyteIcsSslJose.pas
June 12, 2020 - 8.65
Added all Jose parameters and values as constants, added IcsJsonPair to build name:values.
Fixed bug in IcsJoseHeader building bad json for KID only.
Added IcsJoseFindAlgType to find algorithm from literal.
Added IcsJoseJWKThumbprint.
IcsJoseJWKPubKey now optionally adds private key to JWK.
Added IcsJoseJWKGetPKey to get public or private key from JWK.
Added IcsJoseCheckSig to check JWS signature against secret or public key.
Added IcsJoseCheckJWS for servers to check JWS or JWT from  Json or Compact Serialization formats and get payload.
RSA-PSS and Ed25519 keys work for signing and verify.


OverbyteIcsSslX509Utils.pas
Jun 12, 2020 V8.65 
Clear TX509Base safely.
Fixed four corrupted root certificates, two had 8-bit comment characters that caused problems if Windows was set to read UTF8,  so suppressed all comments which also saves apace.


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
June 11, 2020 V8.65 
Added more EC and RSA key exports.


OverbyteIcsUtils.pas
Jun 10, 2020 V8.65 
Builds under Delphi 7 again, no inline.
Added some literals to build Json. 


Source/OverbyteIcsWSocket.pas
Jun 11, 2020 V8.65 
No exception trying to change winsock version with SetReqVerLow.
GetPKeyRawText has flag to show public key only.


Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
12 Jun 2020 - 8.65 
Split Jose and transcoding tests to separate tabs.
Using INI file to keep settings.
Added testing of JWK to public and private key for servers,  reads and writes JWKs.
Added testing of JWS/JWT verification for servers.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jun 12, 2020 V8.65 
Added CA Root Bundle File edit, and List Root Bundle button to  list it.  


------------------------------------------------------------------------
r1477 | francois | 2020-06-23 08:37:30 +0100 (Tue, 23 Jun 2020) | 6 lines
Changed paths:
   M /trunk/Packages/OverbyteIcsD103Run.dpk
   M /trunk/Packages/OverbyteIcsD104Run.dpk
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

OverbyteIcsHttpAppServer.pas: FPiette made TUrlHandler.CreateSession and THttpAppSrvConnection.CreateSession virtual methods.
OverbyteIcsWSocket.pas: FPiette fixed the code so that the exception related to wrong OpenSSL flows correctly up to the application instead of triggering successive access violation exceptions.
OverbyteIcsWSocketS.pas: FPiette made OverbyteIcsSslX509Utils unit loaded only when USE_SLL is defined.
OverbyteIcsD103Run.dpk: FPiette added OverbyteIcsSuperObject which was implicitely imported.
OverbyteIcsD104Run.dpk: FPiette added OverbyteIcsSuperObject which was implicitely imported.

------------------------------------------------------------------------
r1478 | angus | 2020-07-07 12:40:58 +0100 (Tue, 07 Jul 2020) | 50 lines
Changed paths:
   A /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 5

These changes improve the way ICS reads SSL/TLS certificates and bundles, simplifying code that has got partly duplicated over the years as new methods were added, and improving error handling so the infamous stack error should no longer appear, but more useful messages.  All certificate files are now written with the UTF8 character set for the added comments that may include non-ASCII characters, and all comments are read and ignored by ICS rather than passing them to OpenSSL that may get confused by non-ASCII character comments which it is supposed to ignore. This also seems to fix a problem if the latest version of Windows 10 is configured for experimental UTF8 APIs which was where the 8-bit issues appeared, never a problem until then or if UTF8 APIs was disabled again.  

All the ICS root bundles are now created cleanly by an application, rather than mostly manually by copy and editing, to reduce errors. 


OverbyteIcsWSocket.pas
Jul 06, 2020 V8.65 
CertInfo has ISO date/time instead of local date formst.
Write comments as UTF8 to certificate PEM file. 
When reading and loading SSL/TLS certificates and private keys, ICS now parses the PEM bundle one at a time and optionally lists errors about bad certificatss instead of just failing with a stack error. ICS no longer passes extra comments in the bundles to OpenSSL to avoid problems with 8-bit and UTF8 characters.
Internally simplified reading PEM and similar files by reading them into an ANSI string rather than a File BIO, so common code is used for reading certificates from files or strings for TX509, TX509List and TSslContext.
TX509List has new LoadAllFromFileEx and LoadAllFromStringEx  which return a list of certificate errors rathern than an exception on the first error.
TX509 has new LoadFromPemFileEx, LoadFromFileEx, LoadFromTextEx which return a list of certificate errors rathern than an exception on the first error.  LoadFromFile now returns an exception for unknown file extensions instead of ignoring them.


OverbyteIcsSslX509Utils.pas
Jun 22, 2020 V8.65 
Clear TX509Base safely.
Fixed four corrupted root certificates, two had 8-bit comment characters that caused problems if Windows was set to read UTF8, so suppressed all comments which also saves apace.
All sslRootCACerts0xx constants now generated by rootcatool.exe application to avoid errors, removed three old certificates and added another Go Daddy.
Write comments as UTF8 to certificate request file.


OverbyteIcsUtils.pas
Jun 26, 2020 V8.65 
Builds under Delphi 7 again, no inline.
Added some literals to build Json.
Added IcsPosEx with compatibility for all compilers.



Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jul 06, 2020 V8.65 
Added CA Root Bundle File edit, and List Root Bundle button to list it.
Loading PEM bundles ands files now displays better errors for  bad certificates.
Fixed open dialog file extensions not set correctly. 


Samples/Delphi/SslInternet/RootCaCertsBundle.pem
Samples/Delphi/SslInternet/TrustedCABundle.pem
Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
Samples/Delphi/BrowserDemo/TrustedCABundle.pem
Rebuilt all the root certificate bundles,  the contents of which are listed at:

http://wiki.overbyte.eu/wiki/index.php/FAQ_ICS_SSL/TLS_CA_Trusted_Store_Contents

 
------------------------------------------------------------------------
r1479 | angus | 2020-07-23 12:29:52 +0100 (Thu, 23 Jul 2020) | 41 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsUrl.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.65 - Part 6

These changes add support for OAuth1A and a new TIcsTwitter component and sample, only two years late, sorry.  Having now implemented the signature scheme for OAuth1A, I understand why Google, Microsoft and the rest devised OAuth2 omitting signatures, just too complicated and pedantic.    


OverbyteIcsSslHttpRest.pas
Jul 23, 2020 - V8.65
Added OAuth1A for Twitter, note uses extra secret tokens that OAuth2 does not need.  Each request made using OAuth1A requires  a unique signature sent as an Authorization: OAuth header unlike OAuth2 that uses the same bearer token for all requests.
Added new TIcsTwitter component to send and receive tweets, requires a developer account from Twitter.  Includes login to Twitter, send tweet, search tweets and get specific tweets, all responses are Json which the application needs to untangle.
TRestParams has new RfcStrict method that forces RFC3986 strict URL percent encoding, four unreserved chars (- . _ -) are not percent encoded. Also new RemoteItem method to delete a parameter.  Also new PContent type of PContCommaList which saves  parameters as a name="value", list.  


OverbyteIcsUrl.pas
Jul 22, 2020 V8.65 
For UrlEncode RFC3986 section 2.1 says four unreserved chars  (- . _ -) should not be percent encoded, so added RfcStrict option to ensure this.  UrlEncodeEx always uses RfcStrict.


OverbyteIcsHttpProt.pas
Jul 22, 2020 V8.65 
Added httpAuthOAuth using AuthBearerToken for OAuth1A authentication.
Don't clear PunyCodeHost for each request, only login.


OverbyteIcsLIBEAY.pas
July 23, 2020 V8.65 
Added more EC and RSA key exports.
Corrected declarations for TCryptoExNewFunc, f_EVP_PKEY_paramgen, and f_CRYPTO_get_ex_data thanks to Ralf Junker.


OverbyteIcsProxy.pas
21 Jul 2030 - V8.65 
When reading IcsHosts, Proto is now case insensitive.



Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Jul 23, 2020 - V8.65 
Added OAuth1 for Twitter.
Added Twitter demo to send and receive tweets, needs a developer account at Twitter.

------------------------------------------------------------------------
r1480 | angus | 2020-08-07 17:14:46 +0100 (Fri, 07 Aug 2020) | 106 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/Ics.Posix.Messages.pas
   M /trunk/Source/Include/Ics.InterlockedApi.inc
   M /trunk/Source/OverbyteIcsCRC.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsStreams.pas
   M /trunk/Source/OverbyteIcsSuperObject.pas
   M /trunk/Source/OverbyteIcsThreadTimer.pas
   M /trunk/Source/OverbyteIcsTypes.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWebSession.pas
   M /trunk/Source/OverbyteIcsZLibObj.pas

Log: ICS V8.65 - Part 7

These changes are mostly to allow ICS to build on the new DCCOSX64.EXE compiler for macOS 64-bit added recently, it seems be more pedantic than the much older 32-bit compiler, particular thinks LongInt and Integer are different, and does not support any assembler, so lots of small changes.  Not yet tested, may be more changes to come.  This version has been build on Delphi 7 without errors or warnings.  

There are also major improvements in SuperObject, when parsing Json there are new functions that return a sensible error message about parse errors and the location, also it also now has a new object type DateTime or DT which reads or writes TDateTime to avoid the application needing to do the ISO string conversion.  


OverbyteIcsSuperObject.pas
Aug 07, 2020 - V8.65 
Increased SUPER_TOKENER_MAX_DEPTH from 32 to 64 to allow parsing of more complex Json files, uses more memory.
Added ParseStringEx and SOex which return an error string with the first parse error rather than just returning nil.
ParseStream now raise an exception with the first parse error.
PtrInt now Integer to keep MacOS64 happy.
Changed UNIX defines to POSIX so they work.
Now saving TDateTime as ISO 8601/RFC3339 strings instead of Unix seconds.
Removed JavaToDelphiDateTime and DelphiToJavaDateTime which worked with Unix time and used a lot of oode.
Removed TSuperWriterSock, use WSocket instead.
Use AtomicIncrement instead of InterlockedIncrement.
Added new datetime get/set type for Delphi TDateTime, saves as ISO 8601/RFC3339 string:
    obj.AsDateTime
    obj.AsObject.DT['foo']
    obj.DT['foo']
    obj.AsArray.DT[0]
Note dates remain DataType=stString (at the moment) for backward compatibility.
Warning, not tested dates with RTTI since not used by ICS.


Ics.Posix.Messages.pas
Aug 05, 2020 - V8.65
Corrected bad $MESSAGES typo.
Use AtomicIncrement instead of InterlockedIncrement.


Include/Ics.InterlockedApi.inc
Aug 6, 2020 V8.65 
Renamed InterlockedIncrement to AtomicIncrement and AtomicDecrement for compilers XE2 and earlier that don't have them. 


OverbyteIcsCRC.pas
Aug 4, 2020 V8.65 
Removed Endian function not needed and requires ASM


OverbyteIcsFileCopy.pas
17 Jun 2020 - V8.65
Remove hint with D7.


OverbyteIcsSslX509Certs.pas
Aug 07, 2020 - V8.65
Using new SuperObject DateTime methods.


OverbyteIcsSslX509Utils.pas
Aug 05, 2020 V8.65 
Removed unused defines.


OverbyteIcsStreams.pas
Aug 04, 2020 V8.65 
Corrected NewSize: Integer to LongInt to match base class.
Standardised BuffSize as LongInt in Create to avoid compiler errors.


OverbyteIcsThreadTimer.pas
Aug 05, 2020 - V8.65
Corrected bad $MESSAGES typo.
Use AtomicIncrement instead of InterlockedIncrement.


OverbyteIcsTypes.pas
Aug 05, 2020 V8.65 
MacOS64 seems to be missing size_t


OverbyteIcsUtils.pas
Aug 05, 2020 V8.65 
Builds under Delphi 7 again, no inline.
Added some literals to build Json.
Added IcsPosEx with compatibility for all compilers.
MacOS64 does not support inline assembler so set PUREPASCAL.
Fix TIcsFindList.AddSorted result mismatch with MacOS64.
FileSetAttr is windows only, so can not delete read only files on Posix.


OverbyteIcsWebSession.pas
Aug 05, 2020 V8.65 
Use AtomicIncrement instead of InterlockedIncrement.


OverbyteIcsWSocket.pas
Aug 05, 2020 V8.65 
No longer using Ics.InterlockedApi.inc (for a long time). 
MacOS64 does not support inline assembler so set PUREPASCAL.


OverbyteIcsZLibObj.pas
Aug 06, 2020 V8.65
lots of Longint to Integer to keep MacOS64 happy.


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Aug 7, 2020 - V8.65 Fixed warning.


------------------------------------------------------------------------
r1481 | angus | 2020-08-12 19:27:44 +0100 (Wed, 12 Aug 2020) | 42 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsStreams.pas
   M /trunk/Source/OverbyteIcsSuperObject.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsZLibDll.pas
   M /trunk/Source/OverbyteIcsZLibObj.pas
   M /trunk/Source/OverbyteIcsZlibHigh.pas

ICS V8.65 - Part 8

Please treat this release as alpha, not yet rebuilt my own applications using it which is how this all gets tested. 

More changes to support MacOS64 where LongInt and LongWord are 64-bit, so changed to Integer and Cardinal. 

Also increased TCP send and receive buffer size to 64K in components and samples, and generally don't allow it to be set lower, this is the Windows 10 default size. 

OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
OverbyteIcsHttpProt.pas
OverbyteIcsIpStreamLog.pas
Aug 12, 2020 V8.65
Increased default buffer sizes from 8192 to 66536 and never reduce it.


OverbyteIcsSuperObject.pas
Aug 11, 2020 - V8.65
Replaced gcvt with FloattoStr


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
OverbyteIcsStreams.pas
OverbyteIcsWSocket.pas
OverbyteIcsWSocketS.pas
OverbyteIcsZLibDll.pas
OverbyteIcsZlibHigh.pas
OverbyteIcsZLibObj.pas
Aug 12, 2020 V8.65
Changed Longint to Integer and LongWord to Cardinal to keep MacOS64 happy since it thinks both are 64-bits.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
Aug 12, 2020 V8.65
Increased default buffer sizes from 8192 to 66536 and never reduce it.

------------------------------------------------------------------------
r1482 | angus | 2020-08-14 16:40:20 +0100 (Fri, 14 Aug 2020) | 63 lines
Changed paths:
   M /trunk/Packages/IcsCommonD104Design.dproj
   M /trunk/Packages/IcsCommonD104Run.dproj
   M /trunk/Packages/IcsFmxD104Design.dproj
   M /trunk/Packages/IcsFmxD104Run.dproj
   M /trunk/Packages/IcsVclD104Design.dproj
   M /trunk/Packages/IcsVclD104Run.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsStreams.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 9

More changes to support MacOS64. 

More TCP send and receive buffer size fixes, FTP client and server, and IpLogger only. 

About TCP Window Size, Buffer Size and Performance Tuning (from OverbyteIcsWSocket.pas)

The TCP protocol has a window size field to control flow of data, the amount  of data that can be sent without an acknowledgement that it has been received safely and does not need to be repeated.  Back in dial-up days, the window  size was small since corruption and resending was common.

Early applications would increase the window size up to the original TCP maximum of 64K to improve performance with registry changes or using a TCP option that ICS exposes as SocketRcvBufSize and SocketSndBufSize properties in TWSocket. In ICS, only the FTP client and server components ever used this feature since they did large file transfers. Unfortunately the default buffer size never kept up with faster internet speeds which has been fixed with V8.65.

Windows sets the default TCP window size according to network adaptor speed, 8K for less than 1Mb, 17K for 1Mb to 100Mb, 64K for 100Mb to 10Gb, 128k for 10Gb and faster.

The total achievable throughput for a connection is window size in bytes divided by connection latency or Round Trip Time (RTT) in seconds, with a  result in bytes per second. So a 64KB window size with 10ms latency allows 51Mb/sec speed (6.3MB/sec), 20ms is 25Mb, 50ms is 10Mb.

So the default 64K window size limits performance on low latency networks. With Windows Vista/2008 and later, TCP Auto Tuning was added (and the registry ignored) using the TCP window scale option (RFC 7323) that allows increased  window size beyond 64K, up to 16M for Windows.   Auto tuning automatically increases the window size dynamically to achieve the best performance,  rather than being fixed by a predefined window size.

Windows provides control over auto tuning, type 'netsh interface tcp show global' should say AutoTuningLevel normal, but it can be disabled or restricted for poor connections.

Note some older firewalls and routers did not support TCP scaling and removed it causing unstable connections and unexplained problems.

So for best performance, do not change the SocketRcvBufSize and SocketSndBufSize properties, let Windows do auto tuning.  With V8.65 for FTP it is no longer possible to reduce to the buffer size below that of the Windows default which means existing applications setting it below 64K will speed up without change. If your application sets buffer sizes for HTTP or other  protocols (which ICS never did), we suggest you remove it.


OverbyteIcsWSocket.pas
Aug 14, 2020 V8.65
Added note:  About TCP Window Size, Buffer Size and Performance Tuning.


OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
OverbyteIcsIpStreamLog.pas
13 Aug 2020 - V8.65 
Only increase TCP buffer size, don't reduce it below default of 64K, generally better to let Windows TCP autotuning set size.


OverbyteIcsHttpProt.pas
Aug 13, 2020 V8.65 
Increased onDataAvailable receive BUF_SIZE from 8192 to 66536.


OverbyteIcsSslHttpRest.pas
Aug 13, 2020 - V8.65 
For DebugHeaders, report TCP buffer size.
Don't add ? to URL if no parameters.
 

OverbyteIcsStreams.pas
Aug 14, 2020 V8.65
Still trying to support MacOS64.

Packages/IcsCommonD104Design.dproj
Packages/IcsCommonD104Run.dproj
Packages/IcsFmxD104Design.dproj
Packages/IcsFmxD104Run.dproj
Packages/IcsVclD104Design.dproj
Packages/IcsVclD104Run.dproj
Added OSX64 as a target for D10.4, OSX32 disappears so presumably not supported. 


------------------------------------------------------------------------
r1483 | angus | 2020-08-21 15:33:46 +0100 (Fri, 21 Aug 2020) | 102 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.dfm
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpServ1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpServ1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebAppServerCounter.pas
   M /trunk/Source/Ics.Posix.Messages.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsTicks64.pas
   M /trunk/Source/OverbyteIcsTypes.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWmi.pas
   M /trunk/Source/OverbyteIcsWndControl.pas

ICS V8.65 - Part 10

Still more changes to support MacOS64.  

And final support for ordering wild card SSL/TLS certificates from Let's Encrypt using Windows DNS Server automatically. 

If OpenSSL DLLs are missing when a project loads, there is now a better exception showing the name of the file that can not be found. 


OverbyteIcsSslX509Certs.pas
Aug 20, 2020 - V8.65
Using new SuperObject DateTime methods.
Better validation for remote certificate directories.
Better logging when waiting for challenges to complete.
Remove old challenges when starting new Acme order.
Save local server IP address with domains, and check using correct address, may be different for different orders.
Added extra IssStateChallgWaitTest.


OverbyteIcsWmi.pas
Aug 20, 2020  - 8.65
Added IcsWmiChkDnsRec.
Trim spaces on arguments.
Update DNS records now deletes all matching records before  adding new record.  
Allowing simple zone names without . 


OverbyteIcsLIBEAY.pas
Aug 21, 2020 V8.65 
Added more EC and RSA key exports.
Corrected declarations for TCryptoExNewFunc, f_EVP_PKEY_paramgen, and f_CRYPTO_get_ex_data thanks to Ralf Junker.
Initial support for OpenSSL 3.0, not tested.
Reworked LibeayLoad for 3.0 and to give better exception messages if OpenSSL DLLs can not be found.
Changed Longint to Integer and LongWord to Cardinal to keep MacOS64 happy since it thinks both are 64-bits.


OverbyteIcsSSLEAY.pas
Aug 21, 2020 V8.65
GSSLEAY_DLL_IgnoreOld defaults true since OpenSSL 1.0.2 out of support.
Initial support for testing OpenSSL 3.0.0 beta.
GSSLEAY_DLL_IgnoreNew now means use 1.1.1 not 3.0.0.
Open SSL DLL in same directory as LIBEAY DLL, better exceptions.
Changed Longint to Integer and LongWord to Cardinal to keep MacOS64 happy since it thinks both are 64-bits.
Added Posix.SysTypes for size_t.


Ics.Posix.Messages.pas
Aug 19, 2020 - V8.65
Corrected bad $MESSAGES typo.
Use AtomicIncrement instead of InterlockedIncrement,
AtomicDecrement instead of InterlockedExchangeDecrement.
Use TInterlocked.Exchange and TInterlocked.Add.


OverbyteIcsHttpProt.pas
Aug 21, 2020 V8.65 
Added httpAuthOAuth using AuthBearerToken for OAuth1A authentication.
Don't clear PunyCodeHost for each request, only login.
Increased onDataAvailable receive BUF_SIZE from 8192 to 66536.
Only define UseNTLMAuthentication for Windows.


OverbyteIcsTicks64.pas
Aug 21, 2020 V8.65 
Support Posix/MacOS, currently only 32-bit ticks.


OverbyteIcsTypes.pas
Removed Posix size_t, duplicated existing definition. 


Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Aug 20, 2020 - V8.65
Made Windows Server DNS updating more robust.
Display Supplier Database info even for order state none.
Supplier Database state and buttons reset for new order.   


Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.dfm
Samples/Delphi/OtherDemos/OverbyteIcsWmiTst1.pas
17 Aug 2020 - 8.65
Check updating DNS actually worked.
Click on old DNS record to update it.
Update DNS now works, replaces all existing records.


Samples/Delphi/PlatformDemos/IcsFtpServ1.fmx
Samples/Delphi/PlatformDemos/IcsFtpServ1.pas
Aug 18, 2020 - V8.65
Build with FMX again.


Samples/Delphi/PlatformDemos/IcsHttpsTst1.fmx
Samples/Delphi/PlatformDemos/IcsHttpsTst1.pas


Samples/Delphi/WebDemos/OverbyteIcsWebAppServerCounter.pas
Aug 18, 2020 - V8.65
Build with FMX again.


------------------------------------------------------------------------
r1484 | angus | 2020-08-27 12:09:21 +0100 (Thu, 27 Aug 2020) | 29 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsTicks64.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 11

These changes are primarily for the proxy server, and X509 certificate ordering.  


OverbyteIcsProxy.pas
26 Aug 2030 - V8.65 
When reading IcsHosts, Proto is now case insensitive.
Published many more private properties and added methods to manipulate request and response headers and bodies, thanks to Linden Roth.
Don't change Location: header to lowercase.
Fixed Body being logged in one place without DebugHttpBody.
Using IcsPosEx.
Support /.well-known/ from other proxies with absolute URL.


OverbyteIcsHttpSrv.pas
26 Aug 2030 V8.65  
Support /.well-known/ from other proxies with absolute URL.


Samples/Delphi/SslInternet/OverbyteIcsProxySslServer.ini
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
26 Aug 2020 - V8.65 
Added X509ProxyURL to INI file for X509 certificate ordering.


------------------------------------------------------------------------
r1485 | angus | 2020-08-27 18:04:53 +0100 (Thu, 27 Aug 2020) | 9 lines
Changed paths:
   M /trunk/Source/Ics.Posix.Messages.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsZLibDll.pas

ICS V8.65 - Part 12

Starting to make changes to allow ICS to build on Linux 64-bit platform, a lot more to come.  

Ics.Posix.Messages.pas
OverbyteIcsSSLEAY.pas
OverbyteIcsUtils.pas
OverbyteIcsZLibDll.pas

------------------------------------------------------------------------
r1486 | angus | 2020-09-04 17:03:40 +0100 (Fri, 04 Sep 2020) | 35 lines
Changed paths:
   A /trunk/Packages/IcsLinuxD104.dpk
   A /trunk/Packages/IcsLinuxD104.dproj
   M /trunk/Source/Ics.Posix.Messages.pas
   M /trunk/Source/Ics.Posix.WinTypes.pas
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsIcmp.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsPing.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSntp.pas
   M /trunk/Source/OverbyteIcsSocketUtils.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.65 - Part 13

More changes to allow ICS to build on Linux 64-bit platform, and hopefully MacOS64 platform.

There is a new package IcsLinuxD104 that I'm able to build without errors, just a few hints and TODOs although final compile fails probably because I'm using an unsupported Ubuntu version.   This all needs FMXLinux installed first. 

The main work needed is the message pump and timer support, the current implementation is MacOS specific using Apple libraries. I believe FMXLinux probably includes replacements, but it is undocumented and little source code, and without being able to build Linux applications not going to try.  

Ics.Posix.Messages.pas
Ics.Posix.WinTypes.pas
OverbyteIcsBlacklist.pas
OverbyteIcsFileCopy.pas
OverbyteIcsFtpCli.pas
OverbyteIcsFtpMulti.pas
OverbyteIcsFtpSrv.pas
OverbyteIcsHttpMulti.pas
OverbyteIcsIcmp.pas
OverbyteIcsIpStreamLog.pas
OverbyteIcsLIBEAY.pas
OverbyteIcsMailQueue.pas
OverbyteIcsPing.pas
OverbyteIcsProxy.pas
OverbyteIcsSmtpProt.pas
OverbyteIcsSntp.pas
OverbyteIcsSocketUtils.pas
OverbyteIcsSslHttpRest.pas
OverbyteIcsSslJose.pas
OverbyteIcsSslX509Utils.pas
OverbyteIcsUtils.pas
OverbyteIcsWSocket.pas
OverbyteIcsWSocketS.pas
byteIcsV8.lst
Packages/IcsLinuxD104.dpk
Packages/IcsLinuxD104.dproj

------------------------------------------------------------------------
r1487 | angus | 2020-09-08 15:17:46 +0100 (Tue, 08 Sep 2020) | 26 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Source/OverbyteIcsProxy.pas

ICS V8.65 - Part 14

Just proxy changes today. 

OverbyteIcsProxy.pas
08 Sep 2020 - V8.65 
When reading IcsHosts, Proto is now case insensitive.
Published many more private properties and added methods to manipulate request and response headers and bodies, thanks to Linden Roth.
Don't change Location: header to lowercase.
Fixed Body being logged in one place without DebugHttpBody.
Using IcsPosEx.
Support /.well-known/ from other proxies with absolute URL.
Posix fix.
UpdatePostData no longer checks content type, only DefMaxBodySize.
New TIcsHttpProxy events onConfReqBody and onConfRespBody called before onHttpReqBody and onHttpRespBody to confirm whether these events should be called (they require string conversions).
Made most TIcsHttpProxy variables protected for descended components and more public.
Forward proxy assumes UpdateHttp and UpdateHtml are true so  events are called.      


Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
08 Sep 2020 - V8.65 
Added X509ProxyURL to INI file for X509 certificate ordering.
Added new events to allow application to determine whether POST and response body events should be called.  


------------------------------------------------------------------------
r1488 | angus | 2020-09-14 12:43:01 +0100 (Mon, 14 Sep 2020) | 16 lines
Changed paths:
   M /trunk/Source/Ics.Posix.KEventApi.pas
   M /trunk/Source/Ics.Posix.KEventTypes.pas
   M /trunk/Source/Ics.Posix.Messages.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.65 - Part 15


Ics.Posix.KEventApi.pas
Ics.Posix.KEventTypes.pas
Sep 14, 2020 - V8.65
Changes for MacOS64

Ics.Posix.Messages.pas
Sep 09, 2020 - V8.65 
Make sure ThreadID is always TThreadId.

OverbyteIcsUtils.pas
Sep 09, 2020 V8.65
Corrected RFC1123_StrToDate to accept single digit day of the month, which is illegal but common.

------------------------------------------------------------------------
r1489 | angus | 2020-09-23 12:53:43 +0100 (Wed, 23 Sep 2020) | 3 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.65 - Part 16

Updated OpenSSL to 1.1.1h, regular minor release only, no security fixes. 
------------------------------------------------------------------------
r1490 | angus | 2020-10-08 12:37:51 +0100 (Thu, 08 Oct 2020) | 84 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.ini
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Samples/Delphi/SslInternet/SslDemos.groupproj
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSslSessionCache.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.65 - Part 17

Added a new Multi Host FTP Server sample using IcsHosts. Really designed to be a Windows service application. It supports multiple SSL hosts with multiple listeners, can order it's own SSL certificates and will create self signed certificates for any missing,  and will email status information and errors to an administrator.

During testing, found a long term external SSL session cache issue that if an SSL handshake fails due to bad certificate or chain, it is necessary to remove the SSL session from cache so an immediate retry does not succeed by skipping the certificate checks. This effects any client applications using the external SSL session cache including HTTP.  

Also fixed problems with the FTP server not correctly selecting SSL hosts for server name indication or HOST command. 


OverbyteIcsFtpCliW.pas

OverbyteIcsFtpMulti.pas
OverbyteIcsFtpMultiW.pas
6 Oct 2020  - V8.65
If SSL handshake fails due to bad certificate or chain, remove SSL session from cache so an immediate retry does not succeed by skipping the certificate checks.

OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Oct 06, 2020 V8.65
Only increase TCP buffer size, don't reduce it below default of 64K, generally better to let Windows TCP autotuning set size.
Note some V.63 changes here for IcsHosts were missed from TSslFtpServer so left some bugs in that version.
TFtpCtrlSocketW now descends from TSslWSocketClient so inherited functions work properly like SSL Server Name Identifier to select the correct IcsHost for explicit connections if the FTP client sends SNI as the ICS does.  Moral, don't test SNI with wildcard certificates.
Starting SSL using AUTH command now attempts to find the  correct IcsHost using Host name (if available).

OverbyteIcsIpStreamLog.pas
05 Oct 2020 - V8.65
Don't set TCP buffer size, leave it to Windows TCP Autotune.
If SSL handshake fails due to bad certificate or chain, remove SSL session from cache so an immediate retry does not succeed by skipping the certificate checks.

OverbyteIcsSslSessionCache.pas
Oct 6, 2020 V8.65
Added RemoveSession so we can clear an old session we no longer need or which failed certificate checks.

OverbyteIcsWSocket.pas
Oct 08, 2020 V8.65 
Added ICS_LOCAL_HOST_NAME

OverbyteIcsWSocketS.pas
Oct 06, 2020 V8.65 
Use X509Log for SSL SNI IcsHost lookup result so we know the correct host has been found.
When checking IcsHosts for server name using AUTH command, also check non-SSL ports.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dof
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dpr
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.dproj
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.res
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
08 Oct 2020 - V8.65
New Multi Host FTP Server sample using IcsHosts. 

Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Oct 06, 2020 V8.65 
Fixed failed Ssl session cached and reused, remove it from cache if certificate checks fail.

Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
05 Oct 2020 - V8.65
Don't set TCP buffer size, leave it to Windows TCP Autotune.
If SSL handshake fails due to bad certificate or chain, remove SSL session from cache so an immediate retry does not succeed by skipping the certificate checks.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
08 Oct 2020 V8.65 
Added X509ProxyURL to INI file for X509 certificate ordering.
No longer save screen position, removes comments from INI file.
Start timer immediately so window updates.  


Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
06 Oct 2020 - V8.65 
Don't set TCP buffer size, leave it to Windows TCP Autotune.
Fixed failed Ssl session cached and reused, remove it from cache if certificate checks fail.
Save more than one FTP Host Name.



------------------------------------------------------------------------
r1491 | angus | 2020-10-18 14:56:46 +0100 (Sun, 18 Oct 2020) | 90 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUrl.pas

ICS V8.65 - Part 18

These changes add more flexibility to TRestParams allowing them to save more Delphi types correctly without conversion to strings, and added a new TIcsRestEmail component that provides initial support for Google email (Microsoft pending) using REST requests to send and receive email, and to support XOAuth2 authentication for the SMTP component (POP3 pending) so it can always access Gmail accounts.  

Google GMail and Microsoft Outlook Email - REST Email

Note:  Microsoft Outlook Email not supported yet!!!

To access email using REST APIs or OAuth2/SMTP/POP3 an 'application account'
needs to be created though the provider console. This is generally done once
by the developer and the application API ID and secret are then distributed
with the application (usually hidden). These are then used by OAuth2 when
logging in with an end user account.  Note end users don't need to access
the provider console or know it exists.

Name the application something like GMailApp, generate the Client Id and Client
Secret, set the Authorised redirect URI to http://localhost:8080/gmail/  and
enable the Gmail API for your account.  All this information enables the
application using this component to access Gmail, once it has also logged
into a Gmail user account usually different to the application account.  The
user account password is unknown to the application, the login process returns
temporary tokens that are used instead of a password.  During the login process
the end user will be asked to give access to the application, which is why the
name must be recognisable.  Google may also need to test your final application
to avoid warnings.

Note you can not specify which account the users logs into using the browser,
but after login the component retrieves the email count name in NewEmail.
You must save the Refresh Token securely since it is effectively a password to
access the user account from this application account for months from multiple
devices.  For unattended applications or services, the Refresh Token may be
copied from another device, beware the token may finally expire after several
months or be cancelled, and will need a fresh login for a new Refresh Token.

The Access Token need not be saved, for Google it expires after one hour and
will be automatically updated using the Refresh Token.


OverbyteIcsSslHttpRest.pas
Oct 17, 2020 - V8.65 
Changing IcsSms AccountJson now gets a new JWT. Cleaned up SMS error reporting for bad authentication.
Added several TOAuthUri records designed to set-up common OAuth2 account settings for providers like Google, Twitter, Microsoft  and Sipgate, by using the LoadAuthUri method.  Note avoid dragging all URIs into all applications, they need to be referenced specifically in applications.  The REST sample builds an array to allow them to be selected from a list.                        TRestOAuth has new AccName and ConsoleUrl properties for display.
TSimpleWebSrv has new WebSrvIP2 for a second address, setting  WebSrvIP to localhost sets 127.0.0.1 and [::1].
Added OAuth2 Console URL and button which simply launches the browser to the account console page where an  application is set-up and you get the secrets.
Added TOAuthOption OAopAuthGrantedScope which include existing granted scopes when adding new ones.
If SSL handshake fails due to bad certificate or chain, remove SSL session from cache so an immediate retry does not succeed by skipping the certificate checks.
TRestParams AddItem has new overloaded methods to add Integer, Double and Boolean values, AddItemDT for TDateTime, AddItemSO  for ISuperObject and AddItemAR for TStrings as Json array. Numerics and bool are saved as Json without quotes which is required for strict Json parsers. Another AddItem overload has a RParamType parameter as TRParamType allowing a string  to be added as RPTypeStr, RPTypeInt, RPTypeDate, RPTypeFloat, RPTypeBool, RPTypeObj or RPTypeArray.
TRestParams has new RfcStrict method that forces RFC3986 strict URL percent encoding, four unreserved chars (- . _ -) are  not percent encoded.
TRestParams has new RemoveItem method to delete a parameter.
TRestParams has new PContent type of PContCommaList which saves parameters as a name="value", comma separated list for Twitter.
Added new TIcsRestEmail component that provides initial support for Google email (Microsoft pending) REST APIs including OAuth2   login and refresh to get an access token for SMTP  smtpAuthXOAuth2 and smtpAuthOAuthBearer authentication.
TIcsRestEmail has methods to send and read email, to list IDs in a mailbox, read headers and message bodies by ID,  send emails  and delete emails.  the OverbyteIcsHttpRestTst1 sample shows how to read all headers, and how to prepare email using the SMTP component to be sent using the REST API.


OverbyteIcsSmtpProt.pas
Oct 16, 2020 V8.65  
Added smtpAuthXOAuth2 and smtpAuthOAuthBearer authentication, not automatically selected, access token is specified in  AuthBearer property with it's expiry date in BearerExpireDT, this is checked in xxx and event GetNewBearer called to allow  the TRestOAuth component to refresh the Bearer token.
Added SmtpAuthTypeNames literals for applications.
Published onBeforeOutStreamFree so we can read stream before it is destroyed.
THtmlSmtpCli descends from TSslSmtpCli so more properties are published.

OverbyteIcsMailQueue.pas
16 Oct 2020 - V8.65 
Added XOAuth2 and OAuthBearer authentication support, token is refreshed when queue starts and when it expires using  event, application needs TRestOAuth component to get token.
Using SendToFileSync to save SMTP stream to file. 


OverbyteIcsUrl.pas
Oct 17, 2020 V8.65
For UrlEncode RFC3986 section 2.1 says four unreserved chars (- . _ -) should not be percent encoded, so added RfcStrict  option to ensure this.
IcsUrlEncode uses AnsiString and RfcStrict.
UrlEncodeEx always uses RfcStrict.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
Oct 17, 2020 - V8.65 
OAuth2 now has Account Title listing several common OAuth2  accounts which prefills many OAuth2 parameters.
Added OAuth2 Console URL and button which simply launches the browser to the account console page where an application is set-up and you get the secrets.
Added demo for TIcsRestEmail component that provides initial support for Google email (Microsoft pending) to send and receive email using REST API and OAuth2 authentication.


Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
16 Oct 2020 - V8.65
Added XOAuth2 and OAuthBearer authentication support using TIcsRestEmail component for OAuth2, allows to access GMail account with security enabled.



------------------------------------------------------------------------
r1492 | angus | 2020-10-28 15:50:14 +0000 (Wed, 28 Oct 2020) | 19 lines
Changed paths:
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 19

The POP3 component now also supports OAuth2, sample not yet updated. 


OverbyteIcsMailQueue.pas
27 Oct 2020 - V8.65 - 
Restart SMTP protocol logging once body completes.  

OverbyteIcsPop3Prot.pas
Oct 23, 2020 V8.65
Linux pending PrepareGlobalSmtpFormatSettings.
Added popAuthXOAuth2 and popAuthOAuthBearer authentication, not automatically selected, access token is specified in AuthBearer property with it's expiry date in BearerExpireDT. These are checked in the Connect method and event onGetNewToken called if invalid which should then call TIcsRestEmail.GetNewToken which will use OAuth2 to launch a browser window and request login and password, and then update the access token. A refresh token will usually also be returned which should be saved and will be used by GetNewToken to avoid the browser  window if still valid (usually for months).  Note the Password property is ignored for OAuth2 methods, but the username should match that selected in the browser. See notes about TIcsRestEmail for more information.
Added PopAuthTypeNames literals for applications.

OverbyteIcsWSocket.pas
Oct 26, 2020 V8.65
TriggerSendData now virtual.

------------------------------------------------------------------------
r1493 | angus | 2020-11-25 18:18:07 +0000 (Wed, 25 Nov 2020) | 82 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas

ICS V8.65 - Part 20

The new TIcsRestEmail, SMTP and POP3 client components now all support Microsoft Outlook/Office365 OAuth2.  
Only one more REST change remaining before V8.65 is released. 


OverbyteIcsSslHttpRest.pas
Nov 25, 2020  V8.65
Added new TIcsRestEmail component that provides basic support for Google and Microsoft Outlook email REST APIs including OAuth2 login and refresh to get an access token for SMTP smtpAuthXOAuth2 and smtpAuthOAuthBearer authentication. TIcsRestEmail has methods to send and read email, to list IDs in a mailbox, read headers and message bodies by ID, send emails and delete emails.  The  OverbyteIcsHttpRestTst1 sample shows  how to read all headers, and how to prepare email using the SMTP component (Google) or Json (Microsoft) to be sent using the REST API.
TSimpleWebSrv.StopSrv has new argument that does not close current clients so it can be called from a client event to stop new requests.


OverbyteIcsPop3Prot.pas
Nov 20, 2020 V8.65 
Linux pending PrepareGlobalSmtpFormatSettings.
Added popAuthXOAuth2 and popAuthOAuthBearer OAuth2 authentication, not automatically selected, access token is specified in AuthBearer property with it's expiry date in BearerExpireDT. These are checked in the Connect method and event onGetNewToken called if invalid which should then call TIcsRestEmail.GetNewToken which will use OAuth2 to launch a browser window and request login and password, and then  update the access token. A refresh token will usually also be returned which should be saved and will be used by GetNewToken to avoid the browser window if still valid (usually for months). Note the Password property is ignored for OAuth2 methods, but the username should match that selected in the browser and is encoded with the token in the XOAUTH2 or XOAUTHBEARER     base64 argument. Goggle uses popAuthXOAuth2 with a single line AUTH command, Microsoft uses popAuthXOAuth22 with two lines.  See notes about TIcsRestEmail for more information. 
Added PopAuthTypeNames literals for applications.


OverbyteIcsSmtpProt.pas
Nov 05, 2020 V8.65 
Added smtpAuthXOAuth2 and smtpAuthOAuthBearer authentication, not automatically selected, access token is specified in  AuthBearer property with it's expiry date in BearerExpireDT, this is checked in xxx and event GetNewBearer called to allow  the TRestOAuth component to refresh the Bearer token. 
Added SmtpAuthTypeNames literals for applications.
Published onBeforeOutStreamFree so we can read stream before it is destroyed.
THtmlSmtpCli descends from TSslSmtpCli so more properties are published.


OverbyteIcsMailQueue.pas
18 Nov 2020 - V8.65
Changes for Posix.
Added XOAuth2 and OAuthBearer authentication support, token is refreshed when queue starts and when it expires using event, application needs TRestOAuth component to get token.
Using SendToFileSync to save SMTP stream to file.
Restart SMTP protocol logging once body completes.


OverbyteIcsSslX509Certs.pas
Nov 09, 2020 - V8.65
Using new SuperObject DateTime methods.
Better validation for remote certificate directories.
Better logging when waiting for challenges to complete.
Remove old challenges when starting new Acme order,  but leave fake DNS record.
Save local server IP address with domains, and check using correct address, may be different for different orders.
Added extra IssStateChallgWaitTest.
Close local web server before collecting certificate to stop hacking immediately certificate issued (and listed in certificate transparency log).     


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
25 Nov 2020 - 8.65 
Added demo for TIcsRestEmail component that provides initial support for Google email (Microsoft pending) to send and receive email using REST API and OAuth2 authentication. See comments at top of OverbyteIcsSslHttpRest.pas on how to set-up a Google/Microsoft OAuth2 application account.
Allow clicking on Json array line to display only that record.

Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst2.pas
18 Nov 2020 - 8.65 
Allow clicking on Json array line to display only that record.

Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
19 Nov 2020 - V8.65  
Added XOAuth2 and OAuthBearer authentication support using TIcsRestEmail component for OAuth2, allows to access GMail account with security enabled and Microsoft Outlook mail. See comments at top of OverbyteIcsSslHttpRest.pas on how to

Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.pas
Nov 25, 2020  V8.65
Added XOAuth2 and OAuthBearer authentication support using TIcsRestEmail component for OAuth2, allows to access GMail account with security enabled and Microsoft Outlook mail. See comments at top of OverbyteIcsSslHttpRest.pas on how to set-up a Google/Microsoft OAuth2 application account.
Changed defaults for implicit SSL connection which is standard now.

Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
Nov 25, 2020  V8.65
Added XOAuth2 and OAuthBearer authentication support using TIcsRestEmail component for OAuth2, allows to access GMail account with security enabled and Microsoft Outlook mail. See comments at top of OverbyteIcsSslHttpRest.pas on how to set-up a Google/Microsoft OAuth2 application account.
Corrected SslContext so it works with TLS/1.2 and later.
Changed defaults for implicit SSL connection which is standard now.




------------------------------------------------------------------------
r1494 | angus | 2020-12-08 17:17:56 +0000 (Tue, 08 Dec 2020) | 25 lines
Changed paths:
   M /trunk/Source/OverbyteIcsMimeDec.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 21

This is mainly SSL fixes, final release due real soon. 

OverbyteIcsWSocket.pas
Dec 08, 2020 V8.65
Prevent overflow in GetMaskBits.
Fixed several memory leaks in OpenSSL API calls, thanks to Ralf Junker.
Fixed a possible pointer out of scope issue in IcsSslOpenFileBio opening SSL certificate files, seems to effect some Delphi versions  more than others, thanks to Linden Roth and Alexander Pastuhov.


OverbyteIcsMimeDec.pas
Dec 4, 2020  V8.65 
Add five more header fields to TMimeDecodeW in unicode, and all the unicode headers to TMimeDecodeEx.


OverbyteIcsProxy.pas
08 Dec 2020 - V8.65 
Added OnLogHeader and OnLogBody events called before logging events to allow password and account details to be removed, thanks to Linden Roth.
Now allowing images to be unchunked.   


OverbyteIcsUtils.pas
Dec 04, 2020 V8.65
Corrected RFC1123_StrToDate to accept single digit day of the month, which is illegal but common.
------------------------------------------------------------------------
r1495 | angus | 2020-12-09 15:30:12 +0000 (Wed, 09 Dec 2020) | 6 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.65 - Part 22

Updated OpenSSL to 1.1.1i, fixes a high severity problem reading specially crafted malformed SSL certificates that could cause OpenSSL to crash, also minor bug fixes.  

The same high severity problem happens in 1.0.2 and 1.1.0, but these are out of support so users should update to 1.1.1.   

------------------------------------------------------------------------
r1496 | angus | 2020-12-09 17:32:17 +0000 (Wed, 09 Dec 2020) | 18 lines
Changed paths:
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 23

More minor fixes. 

OverbyteIcsWSocket.pas
Dec 09, 2020 - V8.65
Fixed more pointer out of scope issues with certificate passwords. 


OverbyteIcsSslHttpRest.pas
Dec 09, 2020 - V8.65
Don't attempt to send a blank POST body.


OverbyteIcsSslX509Certs.pas
Dec 09, 2020 - V8.65
Builds without AUTO_X509_CERTS, without some functionality.

------------------------------------------------------------------------
r1497 | angus | 2020-12-09 19:34:53 +0000 (Wed, 09 Dec 2020) | 7 lines
Changed paths:
   M /trunk/Packages/IcsCommonD104Design.dproj
   M /trunk/Packages/IcsCommonD104Run.dproj
   M /trunk/Packages/IcsFmxCB102Run.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB104Run.cbproj
   M /trunk/Packages/IcsFmxCBXE2Run.cbproj
   M /trunk/Packages/IcsFmxCBXE3Run.cbproj
   M /trunk/Packages/IcsFmxD101Run.dpk
   M /trunk/Packages/IcsFmxD101Run.dproj
   M /trunk/Packages/IcsFmxD102Run.dpk
   M /trunk/Packages/IcsFmxD102Run.dproj
   M /trunk/Packages/IcsFmxD103Run.dpk
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsFmxD104Design.dproj
   M /trunk/Packages/IcsFmxD104Run.dpk
   M /trunk/Packages/IcsFmxD104Run.dproj
   M /trunk/Packages/IcsFmxD10SRun.dpk
   M /trunk/Packages/IcsFmxD10SRun.dproj
   M /trunk/Packages/IcsFmxDXE2Run.dpk
   M /trunk/Packages/IcsFmxDXE2Run.dproj
   M /trunk/Packages/IcsFmxDXE3Run.dpk
   M /trunk/Packages/IcsFmxDXE3Run.dproj
   M /trunk/Packages/IcsFmxDXE4Run.dpk
   M /trunk/Packages/IcsFmxDXE4Run.dproj
   M /trunk/Packages/IcsFmxDXE5Run.dpk
   M /trunk/Packages/IcsFmxDXE5Run.dproj
   M /trunk/Packages/IcsFmxDXE6Run.dpk
   M /trunk/Packages/IcsFmxDXE6Run.dproj
   M /trunk/Packages/IcsFmxDXE7Run.dpk
   M /trunk/Packages/IcsFmxDXE7Run.dproj
   M /trunk/Packages/IcsFmxDXE8Run.dpk
   M /trunk/Packages/IcsFmxDXE8Run.dproj
   M /trunk/Packages/IcsLinuxD104.dpk
   M /trunk/Packages/IcsLinuxD104.dproj
   M /trunk/Packages/IcsVclD104Design.dproj
   M /trunk/Packages/IcsVclD104Run.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsBatchDnsLookup.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsBatchDnsLookup1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsCliDemo.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsConSmtp.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsDll1.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsDll2.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsDllTst.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsDllTst1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpServ.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpServ1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpTst.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailRcv.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailSnd.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsTcpSrv1IPv6.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsTcpSrvIPv6.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsThread.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsThread1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsThreadTimerDemo.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsThreadTimerDemo1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpLstn.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpSend.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebAppServ.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebAppServerMain.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebAppServerMain.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebServ.dproj
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebServ1.pas
   D /trunk/Source/Ics.Posix.Messages.pas
   A /trunk/Source/Ics.Posix.PXMessages.pas
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFingCli.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsMultipartFtpDownloader.pas
   M /trunk/Source/OverbyteIcsMultipartHttpDownloader.pas
   M /trunk/Source/OverbyteIcsNntpCli.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSmtpSrv.pas
   M /trunk/Source/OverbyteIcsSntp.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsThreadTimer.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWSocketTS.pas
   M /trunk/Source/OverbyteIcsWhoisCli.pas
   M /trunk/Source/OverbyteIcsWndControl.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.65 - Part 24

Dec 09, 2020 - V8.65
Rename unit Ics.Posix.Messages.pas to Ics.Posix.PXMessages.pas to avoid conflicts with projects loading it instead of WinApi.Messages, specifically those using THtmlViewer like our sample FrameBrowserIcs.dpr, maybe others.



------------------------------------------------------------------------
r1498 | angus | 2020-12-17 19:52:44 +0000 (Thu, 17 Dec 2020) | 6 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSha1.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.65 - Part 25

All done now, final tidying up. builds without USE_SSL again, few minor fixes. 

Major addition to ReadMe8.txt over new Getting Started with ICS section listing the types of projects ICS may be used for, and suggesting the correct components to use, and their related sample applications for testing.  This is a quick first pass, any suggestions for improvements welcomed.  I'll also add this to the Wiki FAQ shortly.

------------------------------------------------------------------------
r1499 | angus | 2020-12-18 11:35:15 +0000 (Fri, 18 Dec 2020) | 3 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.pas

ICS V8.65 - Part 26

Missed two sample files. 
------------------------------------------------------------------------
r1500 | angus | 2020-12-20 19:00:44 +0000 (Sun, 20 Dec 2020) | 3 lines
Changed paths:
   M /trunk/Packages/IcsCommonD104Run.dproj

ICS V8.65 - Part 27

IcsCommonD104Run package defaults to Win32 platform. 
------------------------------------------------------------------------
r1501 | angus | 2021-01-07 18:42:13 +0000 (Thu, 07 Jan 2021) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsReg.pas

ICS V8.65 - Part 28

Missed the latest version of a file. 
------------------------------------------------------------------------
r1502 | angus | 2021-01-26 11:58:57 +0000 (Tue, 26 Jan 2021) | 31 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsIcmp.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.dcr
   M /trunk/Source/OverbyteIcsSslHttpRest.pas

ICS V8.66 - Part 1


OverbyteIcsSslHttpRest.pas
Jan 26, 2021 - V8.66
TIcsRestEmail has new OAAuthType property and event for OAuth2 browser URL perhaps via email for servers.
Added TIcsInetAlive component to check for IPv4 and/or IPv6 internet connectivity, using Ping and/or HTTP, defaulting to  www.msftconnecttest.com run by Microsoft for Windows 10 alive checking, online and offline check intervals may be set, event when online changes.

OverbyteIcsHttpProt.pas
Jan 26, 2021 V8.66 
AddrResolvedStr is now still available after connection closes.

OverbyteIcsIcmp.pas
Jan 20, 2021 V8.66
Ensure ErrorCode is set for DNS problems, as well as LastErrStr.

OverbyteIcsMailQueue.pas
14 Jan 2021 - V8.66
Added CheckOAuthLogins called before queue starts to check interactively (with browser) any OAuth2 login credentials for servers, avoids asking for login first time email sent.

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Jan 25, 2021 - V8.66 
Added demo for TIcsInetAlive component to check for IPv4 and/or IPv6 internet connectivity, using Ping and/or HTTP, defaulting to msftconnecttest.com run by Microsoft for Windows 10 alive checking.

Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
14 Jan 2021 - V8.66
Replaced initial OAuth2 token checking with new CheckOAuthLogins function.


------------------------------------------------------------------------
r1503 | angus | 2021-02-04 19:34:54 +0000 (Thu, 04 Feb 2021) | 22 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas

ICS V8.66 - Part 2


OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
04 Feb 2021 - V8.66
Added ParseLevels property to follow links on parsed web page to lower level pages, which are also parsed.  Ignores parent links without a file extension, and external links, but requires a specific file extension to located (ie .avi). This allows the component to download files indexed using HTTP from CCTV camera memory cards.
Ensure keep alive works.


OverbyteIcsSslHttpRest.pas
Feb 03, 2021 - V8.66
Bug fixes for new TIcsInetAlive component.


Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
04 Feb 2021 - V8.66
Added Parse HTML page options, not sure why these were missing from this sample, been working for years.

------------------------------------------------------------------------
r1504 | angus | 2021-02-12 17:56:27 +0000 (Fri, 12 Feb 2021) | 7 lines
Changed paths:
   M /trunk/Source/OverbyteIcsSslHttpRest.pas

ICS V8.66 - Part 3

OverbyteIcsSslHttpRest.pas
Feb 10, 2021 - V8.66 
TIcsRestEmail sets OAuth2 errors, and clears old tokens.
Increased default timeout for TIcsRestEmail AOuth2 login to 120 seconds since several web page warnings may be seen. 

------------------------------------------------------------------------
r1505 | angus | 2021-02-16 11:22:45 +0000 (Tue, 16 Feb 2021) | 61 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMsSslUtils.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslSessionCache.pas
   M /trunk/Source/OverbyteIcsSslThrdLock.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWSocketTS.pas

ICS V8.66 - Part 4

This commit is a major clean-up of OpenSSL functions, and may require end user application changes if low level OpenSSL functions have been used, hopefully very rarely.  

Renamed all OpenSSL functions to original names removing ICS f_ prefix so they now have the original OpenSSL names, for commonality with other Delphi applications.  

OpenSSL 1.0.2 and 1.1.0 ceased security fix support over 12 months ago, so ICS now only supports 1.1.1, with 3.0 support due in the next few months.  This removes a lot of legacy code and functions, and several old ICS functions needed for backward compatibility.  Two components only used for 1.0.2 have been removed, TSslStaticLock and TSslDynamicLock which may give an error loading forms, until they are removed.  SslContext SslOptions is now ignored, use SslOptions2 instead which has more modern options.  Can not remove SslOptions because it's saved on too many DFMs. Most modern applications should not be using SslConext, but IcsHosts for servers for high level client components like TSslHttpRest. 



OverbyteIcsWSocket.pas
Feb 15, 2021 V8.66 
Corrected integer overflow in WSocketIsDottedIP with full numeric IP address which is not supported.
Renamed all OpenSSL functions to original names removing ICS f_ prefix.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased Dec 2019, also Fips mode pending 3.0.                   SslContext SslOptions now ignored, use SslOptions2 instead which has more modern options.  Can not remove SslOptions because it's saved on too many DFMs.

OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Feb 15, 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.  This will require application or component changes if you access any of these functions directly.
Renamed literals BIO_CTRL_PENDING_, CRYPTO_NUM_LOCKS_, CRYPTO_LOCK_, OPENSSL_VERSION_ with underscore to avoid conflicts with functions of the same case sensitive names.
Corrected EVP_PKEY_get_raw_private_key/public key for Win64.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased  Dec 2019, also Fips mode pending 3.0.


OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Feb 15, 2021 V8.66   
Removed checks for SSLv2.

OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
OverbyteIcsMsSslUtils.pas
OverbyteIcsReg.pas
OverbyteIcsSslJose.pas
OverbyteIcsSslSessionCache.pas
OverbyteIcsSslThrdLock.pas
OverbyteIcsSslX509Utils.pas
OverbyteIcsWSocketS.pas
OverbyteIcsWSocketTS.pas
Feb 15, 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.


Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
Feb 15, 2021 V8.66 
OverbyteIcsSslThrdLock gone, only used for 1.0.2.
ECDH setting gone, always automatic now.
DHParams file gone, not needed for modern ciphers.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Feb 15, 2021 V8.66 
FIPS support gone, pending new FIPS in OpenSSL 3.0.
Don't use internal OpenSSL function when saving certificate.
OverbyteIcsSslThrdLock gone, only used for 1.0.2. 



------------------------------------------------------------------------
r1506 | angus | 2021-02-16 19:28:16 +0000 (Tue, 16 Feb 2021) | 6 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.66 - Part 5

Updated OpenSSL to 1.1.1j, the security fixes relate to functions ICS does not use, but also 
minor bug fixes.


------------------------------------------------------------------------
r1507 | angus | 2021-03-02 19:04:40 +0000 (Tue, 02 Mar 2021) | 79 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMsSslUtils.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslSessionCache.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsTypes.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.66 - Part 6

Warning - please do not use this commit for commercial applications for at least a couple of weeks, there are a lot of low level changes that need further testing.  

This commit continues the major clean-up of OpenSSL functions, and may require end user application changes if low level OpenSSL functions have been used, hopefully very rarely.  A lot of unused code and declarations have been removed to make future maintenance easier, with all OpenSSL functions using their original names. 

Also added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.  YuOpenSSL is a commercial product from https://www.yunqa.de/ and is supplied as separate compiled DCUs for Delphi 5 to 10.4. DEFINE YuOpenSSL in Include\OverbyteIcsDefs.inc determines whether the DCU is linked or the external DLLs.  Note only one version of OpenSSL can be linked with YuOpenSSL, whereas different DLLs can be supported.

Include/OverbyteIcsDefs.inc
Mar 2021 - V8.65 - 
Angus added DEFINE YuOpenSSL which links OpenSSL using a pre-built DCU instead of external DLLs. 


OverbyteIcsWSocket.pas
Mar 02, 2021 V8.66 
Corrected integer overflow in WSocketIsDottedIP with full numeric IP address which is not supported.
Renamed all OpenSSL functions to original names removing ICS f_ prefix.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased Dec 2019, also Fips mode pending 3.0.
SslContext SslOptions now ignored, use SslOptions2 instead which has more modern options.  Can not remove SslOptions because it's saved on too many DFMs.
Added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.
Ssl Renegotiation disabled, no longer recommended.
New TSslWSocket method SslOK is TLS/SSL negotiated OK.

OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Mar 02, 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.  This will require application or component changes if you access any of these functions directly.
Renamed literals BIO_CTRL_PENDING_, CRYPTO_NUM_LOCKS_, CRYPTO_LOCK_, OPENSSL_VERSION_ with underscore to avoid conflicts with functions of the same case sensitive names.
Corrected EVP_PKEY_get_raw_private_key/public key for Win64.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased  Dec 2019, also Fips mode pending 3.0.
Added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.
Most OpenSSL type pointers to Dummy array now simple Pointer type.
Changed most OpenSSL var parameters to pointers for commonality.
Added GSSLStaticLinked true/false if OpenSSL statically linked.

OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
Mar 02, 2021 V8.66 
Renegotiation of connection no longer supported, not recommended.

OverbyteIcsSslHttpRest.pas
Mar 02, 2021 - V8.66 
Report if OpenSSL statically linked. 

OverbyteIcsMsSslUtils.pas
OverbyteIcsSslJose.pas
OverbyteIcsSslSessionCache.pas
OverbyteIcsSslX509Utils.pas
OverbyteIcsTypes.pas
Added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Mar 02, 2021 - V8.66 
Added List Cert Store button shows all certificates in context root store.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Feb 15, 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.
FIPS support gone, pending new FIPS in OpenSSL 3.0.
Don't use internal OpenSSL function when saving certificate.
OverbyteIcsSslThrdLock gone, only used for 1.0.2. 


Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
Feb 23 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.
Added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.




------------------------------------------------------------------------
r1508 | angus | 2021-03-04 19:19:43 +0000 (Thu, 04 Mar 2021) | 13 lines
Changed paths:
   D /trunk/Samples/Delphi/SslInternet/dhparam1024.pem
   D /trunk/Samples/Delphi/SslInternet/dhparam512.pem
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.66 - Part 7

Warning - please do not use this commit for commercial applications for at least a couple of weeks, there are a lot of low level changes that need further testing.

OverbyteIcsWSocket.pas
Mar 04, 2021 V8.66 
LoadVerifyLocations no longer lets OpenSSL use default CA folder locations which is potentially a security risk, also fixes a problem with YuOpenSSL, thanks to Ralf Junker for the fix. 

OverbyteIcsMailQueue.pas
03 Mar 2021 - V8.66 
Report OpenSSL static linked.


------------------------------------------------------------------------
r1509 | angus | 2021-03-17 13:16:53 +0000 (Wed, 17 Mar 2021) | 71 lines
Changed paths:
   M /trunk/Packages/IcsCommonCB102Run.cbproj
   M /trunk/Packages/IcsCommonCB103Run.cbproj
   M /trunk/Packages/IcsCommonCB104Run.cbproj
   M /trunk/Packages/IcsCommonD101Run.dpk
   M /trunk/Packages/IcsCommonD101Run.dproj
   M /trunk/Packages/IcsCommonD102Run.dpk
   M /trunk/Packages/IcsCommonD102Run.dproj
   M /trunk/Packages/IcsCommonD103Run.dpk
   M /trunk/Packages/IcsCommonD103Run.dproj
   M /trunk/Packages/IcsCommonD104Design.dproj
   M /trunk/Packages/IcsCommonD104Run.dpk
   M /trunk/Packages/IcsCommonD104Run.dproj
   M /trunk/Packages/IcsCommonD10SRun.dpk
   M /trunk/Packages/IcsCommonD10SRun.dproj
   M /trunk/Packages/IcsCommonDXE2Run.dpk
   M /trunk/Packages/IcsCommonDXE2Run.dproj
   M /trunk/Packages/IcsCommonDXE3Run.dpk
   M /trunk/Packages/IcsCommonDXE3Run.dproj
   M /trunk/Packages/IcsCommonDXE4Run.dpk
   M /trunk/Packages/IcsCommonDXE4Run.dproj
   M /trunk/Packages/IcsCommonDXE5Run.dpk
   M /trunk/Packages/IcsCommonDXE5Run.dproj
   M /trunk/Packages/IcsCommonDXE6Run.dpk
   M /trunk/Packages/IcsCommonDXE6Run.dproj
   M /trunk/Packages/IcsCommonDXE7Run.dpk
   M /trunk/Packages/IcsCommonDXE7Run.dproj
   M /trunk/Packages/IcsCommonDXE8Run.dpk
   M /trunk/Packages/IcsCommonDXE8Run.dproj
   M /trunk/Packages/IcsFmxCB102Run.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB104Run.cbproj
   M /trunk/Packages/IcsFmxCBXE2Run.cbproj
   M /trunk/Packages/IcsFmxCBXE3Run.cbproj
   M /trunk/Packages/IcsFmxD101Run.dpk
   M /trunk/Packages/IcsFmxD101Run.dproj
   M /trunk/Packages/IcsFmxD102Run.dpk
   M /trunk/Packages/IcsFmxD102Run.dproj
   M /trunk/Packages/IcsFmxD103Run.dpk
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsFmxD104Design.dproj
   M /trunk/Packages/IcsFmxD104Run.dpk
   M /trunk/Packages/IcsFmxD104Run.dproj
   M /trunk/Packages/IcsFmxD10SRun.dpk
   M /trunk/Packages/IcsFmxD10SRun.dproj
   M /trunk/Packages/IcsFmxDXE2Run.dpk
   M /trunk/Packages/IcsFmxDXE2Run.dproj
   M /trunk/Packages/IcsFmxDXE3Run.dpk
   M /trunk/Packages/IcsFmxDXE3Run.dproj
   M /trunk/Packages/IcsFmxDXE4Run.dpk
   M /trunk/Packages/IcsFmxDXE4Run.dproj
   M /trunk/Packages/IcsFmxDXE5Run.dpk
   M /trunk/Packages/IcsFmxDXE5Run.dproj
   M /trunk/Packages/IcsFmxDXE6Run.dpk
   M /trunk/Packages/IcsFmxDXE6Run.dproj
   M /trunk/Packages/IcsFmxDXE7Run.dpk
   M /trunk/Packages/IcsFmxDXE7Run.dproj
   M /trunk/Packages/IcsFmxDXE8Run.dpk
   M /trunk/Packages/IcsFmxDXE8Run.dproj
   M /trunk/Packages/IcsLinuxD104.dpk
   M /trunk/Packages/IcsLinuxD104.dproj
   M /trunk/Packages/IcsVclCB102Run.cbproj
   M /trunk/Packages/IcsVclCB103Run.cbproj
   M /trunk/Packages/IcsVclCB104Run.cbproj
   M /trunk/Packages/IcsVclCBXE2Run.cbproj
   M /trunk/Packages/IcsVclCBXE3Run.cbproj
   M /trunk/Packages/IcsVclD101Run.dpk
   M /trunk/Packages/IcsVclD101Run.dproj
   M /trunk/Packages/IcsVclD102Run.dpk
   M /trunk/Packages/IcsVclD102Run.dproj
   M /trunk/Packages/IcsVclD103Run.dpk
   M /trunk/Packages/IcsVclD103Run.dproj
   M /trunk/Packages/IcsVclD104Design.dproj
   M /trunk/Packages/IcsVclD104Run.dpk
   M /trunk/Packages/IcsVclD104Run.dproj
   M /trunk/Packages/IcsVclD10SRun.dpk
   M /trunk/Packages/IcsVclD10SRun.dproj
   M /trunk/Packages/IcsVclDXE2Run.dpk
   M /trunk/Packages/IcsVclDXE2Run.dproj
   M /trunk/Packages/IcsVclDXE3Run.dpk
   M /trunk/Packages/IcsVclDXE3Run.dproj
   M /trunk/Packages/IcsVclDXE4Run.dpk
   M /trunk/Packages/IcsVclDXE4Run.dproj
   M /trunk/Packages/IcsVclDXE5Run.dpk
   M /trunk/Packages/IcsVclDXE5Run.dproj
   M /trunk/Packages/IcsVclDXE6Run.dpk
   M /trunk/Packages/IcsVclDXE6Run.dproj
   M /trunk/Packages/IcsVclDXE7Run.dpk
   M /trunk/Packages/IcsVclDXE7Run.dproj
   M /trunk/Packages/IcsVclDXE8Run.dpk
   M /trunk/Packages/IcsVclDXE8Run.dproj
   M /trunk/Packages/OverbyteIcsCB2006Run.bdsproj
   M /trunk/Packages/OverbyteIcsCB2007Run.cbproj
   M /trunk/Packages/OverbyteIcsCB2009Run.cbproj
   M /trunk/Packages/OverbyteIcsCB2010Run.cbproj
   M /trunk/Packages/OverbyteIcsCBXe2Run.cbproj
   M /trunk/Packages/OverbyteIcsCBXe3Run.cbproj
   M /trunk/Packages/OverbyteIcsCBXeRun.cbproj
   M /trunk/Packages/OverbyteIcsD101Run.dpk
   M /trunk/Packages/OverbyteIcsD101Run.dproj
   M /trunk/Packages/OverbyteIcsD102Run.dpk
   M /trunk/Packages/OverbyteIcsD102Run.dproj
   M /trunk/Packages/OverbyteIcsD103Run.dpk
   M /trunk/Packages/OverbyteIcsD103Run.dproj
   M /trunk/Packages/OverbyteIcsD104Run.dpk
   M /trunk/Packages/OverbyteIcsD104Run.dproj
   M /trunk/Packages/OverbyteIcsD10SRun.dpk
   M /trunk/Packages/OverbyteIcsD10SRun.dproj
   M /trunk/Packages/OverbyteIcsD2006Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Design.dproj
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/Packages/OverbyteIcsD2009Run.dpk
   M /trunk/Packages/OverbyteIcsD2009Run.dproj
   M /trunk/Packages/OverbyteIcsD2010Run.dpk
   M /trunk/Packages/OverbyteIcsD2010Run.dproj
   M /trunk/Packages/OverbyteIcsD7Run.dpk
   M /trunk/Packages/OverbyteIcsDXE8Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dproj
   M /trunk/Packages/OverbyteIcsDXe3Run.dpk
   M /trunk/Packages/OverbyteIcsDXe3Run.dproj
   M /trunk/Packages/OverbyteIcsDXe4Run.dpk
   M /trunk/Packages/OverbyteIcsDXe4Run.dproj
   M /trunk/Packages/OverbyteIcsDXe5Run.dpk
   M /trunk/Packages/OverbyteIcsDXe5Run.dproj
   M /trunk/Packages/OverbyteIcsDXe6Run.dpk
   M /trunk/Packages/OverbyteIcsDXe6Run.dproj
   M /trunk/Packages/OverbyteIcsDXe7Run.dpk
   M /trunk/Packages/OverbyteIcsDXe7Run.dproj
   M /trunk/Packages/OverbyteIcsDXe8Run.dproj
   M /trunk/Packages/OverbyteIcsDXeRun.dpk
   M /trunk/Packages/OverbyteIcsDXeRun.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool3.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWSocketTS.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.66 - Part 8

Final clean up of old OpenSSL functions, code and units, OverbyteIcsLibeayEx.pas and OverbyteIcsSslThrdLock.pas/dcr have been removed from all projects and packages.  Also brings server SSL/TLS security levels up to latest Mozilla recommendations. 


OverbyteIcsHttpAppServer.pas
OverbyteIcsHttpSrv.pas
Mar 11, 2021 V8.66 
Added onBeforeCtxInit event which if set is called once before each IcsHosts SslContext is initialised to allow the context parameters to be adjusted for special ciphers or protocols.

OverbyteIcsHttpProt.pas
Mar 16, 2021 V8.66 
AddrResolvedStr is now still available after connection closes.
When using an HTTPS proxy with the CONNECT command don't send host and port which some servers are unable to handle, probably broken with V8.84.

OverbyteIcsProxy.pas
Mar 16, 2021 - V8.66 
Update host header with port if target is non standard port.

OverbyteIcsSSLEAY.pas
OverbyteIcsLIBEAY.pas
Mar 16, 2021 V8.66 
Renamed all OpenSSL functions to original names removing ICS f_ prefix.  This will require application or component changes if you access any of these functions directly.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased Dec 2019, also Fips mode pending 3.0.
Added support for YuOpenSSL which provides OpenSSL in a pre-built DCU linked into applications, rather than using external DLLs.
Most OpenSSL type pointers to Dummy array now simple Pointer type.
Added GSSLStaticLinked true/false if OpenSSL statically linked.

OverbyteIcsSslHttpRest.pas
Mar 15, 2021 - V8.66
TIcsRestEmail has new OAAuthType property and event for OAuth2 browser URL perhaps via email for servers.
TIcsRestEmail sets OAuth2 errors, and clears old tokens.  
Increased default timeout for TIcsRestEmail AOuth2 login to 120 seconds since several web page warnings may be seen.
Added TIcsInetAlive component to check for IPv4 and/or IPv6 internet connectivity, using Ping and/or HTTP, defaulting to       www.msftconnecttest.com run by Microsoft for Windows 10 alive checking, online and offline check intervals may be set,       event when online changes.
Report if OpenSSL statically linked.
Ensure SSL initialised for non-REST requests like GET/PUT.

OverbyteIcsSslX509Certs.pas
Mar 12, 2021 - V8.66
Bad version.

OverbyteIcsWSocket.pas
Mar 16, 2021 V8.66 
Corrected integer overflow in WSocketIsDottedIP with full numeric IP address which is not supported.
Renamed all OpenSSL functions to original names removing ICS f_ prefix.
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased Dec 2019, also Fips mode pending 3.0.
SslContext SslOptions now ignored, use SslOptions2 instead which has more modern options.  Can not remove SslOptions because it's saved on too many DFMs.
Added support for YuOpenSSL which provides OpenSSL in a pre-built  DCU linked into applications, rather than using external DLLs.
Ssl Renegotiation disabled, no longer recommended.
New TSslWSocket method SslOK is TLS/SSL negotiated OK.
LoadVerifyLocations no longer lets OpenSSL use default CA folder locations which is potentially a security risk, also fixes a problem with YuOpenSSL, thanks to Ralf Junker for the fix.
Made SslVerifyResult public.
After SSL handshake, ignore OpenSSL errors if certificate chain verified OK.
Socks proxy and tunneling again support host names, broken in V8.56,  thanks to Fr0sT.Brutal.
In 2021 Mozilla now recommends TLSv1.3 as modern ciphers and TLSv1.2/1.3 as Intermediate supporting all browsers from last five years, so IcsHosts now uses sslCiphersMozillaSrvTLS12 as Intermediate level, also Mozilla recommends no cipher server preference so changed that.
                   
OverbyteIcsWSocketS.pas
Mar 15, 2021 V8.66 
Removed support for OpenSSL 1.0.2 and 1.1.0 whose support ceased  Dec 2019, also Fips mode pending 3.0.
Added OnBeforeContextInit event which if set is called once before each IcsHosts SslContext is initialised to allow the context  parameters to be adjusted for special ciphers or protocols.
In 2021 Mozilla now recommends TLSv1.3 as modern ciphers and TLSv1.2/1.3 as Intermediate supporting all browsers from last five years, so IcsHosts now use sslCiphersMozillaSrvTLS12 as Intermediate level, also Mozilla recommends no cipher server preference so changed that.
Updated SslSrvSecurity levels: sslSrvSecInter, sslSrvSecInterFS and sslSrvSecHigh now all the same TLSv1.2 or 1.3, sslSrvSecTls12Less now TLSv1.2 only, sslSrvSecSsl3 not supported, only sslSrvSecBack supports TLSv1 and 1.1, sslSrvSecTls13Only unchanged TLSv1.3 only.

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Mar 16, 2021 - V8.66 
Added demo for TIcsInetAlive component to check for IPv4 and/or IPv6 internet connectivity, using Ping and/or HTTP, defaulting to msftconnecttest.com run by Microsoft for Windows 10 alive checking.
Added List Cert Store button shows all certificates in context root store.



------------------------------------------------------------------------
r1510 | angus | 2021-03-20 09:11:49 +0000 (Sat, 20 Mar 2021) | 3 lines
Changed paths:
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   D /trunk/Source/Ics.Fmx.OverbyteIcsSslThrdLock.pas
   D /trunk/Source/OverbyteIcsLibeayEx.pas
   D /trunk/Source/OverbyteIcsSslThrdLock.dcr
   D /trunk/Source/OverbyteIcsSslThrdLock.pas

ICS V8.66 - Part 9

Fixed Delphi 2007 packages that had unwanted units.  
------------------------------------------------------------------------
r1511 | angus | 2021-03-23 16:49:27 +0000 (Tue, 23 Mar 2021) | 36 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst1.dfm
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst1.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsTicks64.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.66 - Part 10

More minor fixes, there will be final release in a few days once a planned new OpenSSL release is available. 

OverbyteIcsWSocket.pas
Mar 23, 2021 V8.66 
Socks proxy and tunneling again support host names, broken in V8.56, thanks to Fr0sT.Brutal.  Also made HttpTunnelState property readable,
Added ProxyURL property to set SOCKS or HTTP Tunnel proxy settings using single URL, ie proto://[user:password@]host:port where proto = socks5 or http. Also new methods SetSocks and SetHTTPTunnel to set proxy properties in a single call, thanks to Fr0sT.Brutal.

OverbyteIcsWSocketS.pas
Mar 22, 2021 V8.66 
Better error handling when IcsHost SslCert is blank, so SslContext is still created for self signed certificate, thanks to Linden Roth.  

OverbyteIcsSslHttpRest.pas
Mar 19, 2021 - V8.66 
Made IcsEscapeJson public.

OverbyteIcsSslX509Certs.pas
Mar 23, 2021 - V8.66
When starting local web server, check server IP address still exists or change to 0.0.0.0, may not work if multiple IPs exist.
Minor fixes to file challenges, thanks to Oliver Dahlmann.

OverbyteIcsTicks64.pas
Mar 18, 2021 V8.66
Added OverbyteIcsDefs.inc.


Samples/Delphi/SocketDemos/OverbyteIcsSocksTst1.dfm
Samples/Delphi/SocketDemos/OverbyteIcsSocksTst1.pas
Mar 23, 2021 V8.66
Added ProxyURL allowing settings using a single URL,
Added support for HTTP Tunnel proxy.
Added Command to send on connection or by button. 



------------------------------------------------------------------------
r1512 | angus | 2021-03-26 16:07:05 +0000 (Fri, 26 Mar 2021) | 5 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.66 - Part 11

Final update for V8.66, with new OpenSSL 1.1.1k with two high security fixes, one introduced in the last version relating to a certificate chain validation that ICS does not use, the other relating to servers using TLSv1.2 and renegotiation, and that feature is removed in V8.66.  

Also fixed an incompatibility with the YuOpenSSL version of 1.1.1k.  
------------------------------------------------------------------------
r1513 | angus | 2021-04-06 18:55:02 +0100 (Tue, 06 Apr 2021) | 34 lines
Changed paths:
   M /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpMulti1.pas
   M /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync1.dfm
   M /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsBatchDnsLookup1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv1.dfm
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvDemo2.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2_1.dfm
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2_1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsy1.dfm
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpAsy1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsIsapi1.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.67 - Part 1


OverbyteIcsProxy.pas
Apr 6, 2021  V8.67  
Don't send HTTP request header until after HTTP body has been processed in case the body length changes, thanks to Linden Roth.


OverbyteIcsUtils.pas
Apr 6, 2021  V8.67 
Added overloaded AnsiToUnicode with specified size buffer. used by IcsMoveTBytesToString and some IcsHtmlToStr conversion to resolve problem processing buffer with no terminating null, so extra characters got added beyond buffer end.


Samples/Delphi/FtpDemos/OverbyteIcsFtpMulti1.pas
Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync1.dfm
Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync1.pas
Samples/Delphi/PlatformDemos/IcsBatchDnsLookup1.pas
Samples/Delphi/SocketDemos/OverbyteIcsRecv1.dfm
Samples/Delphi/SocketDemos/OverbyteIcsRecv1.pas
Samples/Delphi/SocketDemos/OverbyteIcsSrvDemo2.pas
Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2_1.dfm
Samples/Delphi/SocketDemos/OverbyteIcsThrdSrvV2_1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Samples/Delphi/WebDemos/OverbyteIcsIsapi1.pas
Apr 6, 2021 - V8.67
Made Win64 compatible by correcting Integer(Pointer) typecasts to W/LPARAM for PostMessage, thanks to Fr0sT.


Samples/Delphi/WebDemos/OverbyteIcsHttpAsy1.dfm
Samples/Delphi/WebDemos/OverbyteIcsHttpAsy1.pas
Apr 6, 2021  V8.67 
Must select something to edit it.

------------------------------------------------------------------------
r1514 | angus | 2021-04-08 19:10:11 +0100 (Thu, 08 Apr 2021) | 22 lines
Changed paths:
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsIsapi1.dfm
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.67 - Part 2

OverbyteIcsUtils.pas
Apr 8, 2021  V8.67
Added overloaded AnsiToUnicode with specified size buffer. used by IcsMoveTBytesToString and some IcsHtmlToStr conversion to resolve problem processing buffer with no terminating null, so extra characters got added beyond buffer end.


OverbyteIcsHttpProt.pas
Apr 8, 2021  V8.67 
Renamed FBodyLineCount to FBodyStartedFlag since count never used, fixes a problem with very long streams being received.
Fixed a relocation problem where the Location: header included a path with characters not allowed in URLs, typically a space.
Fixed another relocation problem where HEAD sometimes stalled.  


OverbyteIcsLIBEAY.pas
Apr 8, 2021 V8.67  
Changed CRYPTO_free declaration to keep C++ happy.


Samples/Delphi/WebDemos/OverbyteIcsIsapi1.dfm
Builds with D2007 again. 

------------------------------------------------------------------------
r1515 | angus | 2021-04-09 18:47:36 +0100 (Fri, 09 Apr 2021) | 23 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsUtils.pas

V8.67 - Part 3

Hopefully final updates of Proxy and HTTP Client components. 


OverbyteIcsHttpProt.pas
Apr 9, 2021  V8.67 
Renamed FBodyLineCount to FBodyStartedFlag since count never used, fixes a problem with very long streams being received.
Fixed a relocation problem where the Location: header included a path with a space, encode it. 
Fixed another relocation problem where HEAD sometimes stalled.


OverbyteIcsProxy.pas
Apr 9, 2021  V8.67  
Don't send HTTP request header until after HTTP body has been processed in case the body length changes, thanks to Linden Roth.
HTTP Forward Proxy using HTTP works again, broken in V8.65.
Using HTTP Forward Proxy, convert absolute URL to path only since some servers can not process an absolute URL and sulk.


OverbyteIcsUtils.pas
Apr 9, 2021  V8.67 
Added overloaded AnsiToUnicode with specified size buffer. used by IcsMoveTBytesToString and some IcsHtmlToStr conversion to resolve problem processing buffer with no terminating null, so extra characters got added beyond buffer end.

------------------------------------------------------------------------
r1516 | angus | 2021-05-13 15:59:51 +0100 (Thu, 13 May 2021) | 9 lines
Changed paths:
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas

V8.67 - Part 4

OverbyteIcsHttpAppServer.pas
OverbyteIcsHttpSrv.pas
May 13, 2021 V8.67 
Added NO_CACHE_EX as Cache-Control: no-cache to replace Pragma: no-cache.
Added NO_STORE_EX as Cache-Control: no-store better than no-cache
Added optional LastModified param to AnswerStream, AnswerPage, and AnswerString to avoid needing custom header line.

------------------------------------------------------------------------
r1517 | angus | 2021-05-25 18:03:30 +0100 (Tue, 25 May 2021) | 71 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsCharsetUtils.pas
   M /trunk/Source/OverbyteIcsFormDataDecoder.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpCCodZLib.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsMimeDec.pas
   M /trunk/Source/OverbyteIcsMimeUtils.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsStreams.pas
   M /trunk/Source/OverbyteIcsSuperObject.pas
   M /trunk/Source/OverbyteIcsSuperXMLParser.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsZlibHigh.pas

ICS V8.67 - Part 5

Adds a new component to help build REST servers by converting a SQL database dataset into Json.  Needs a new demo, but easy to use. 
Also replaced most stream.seek statements with stream.position to avoid using legacy soFromBeginning, etc, with streams. 



OverbyteIcsSslHttpRest.pas
Include/OverbyteIcsDefs.inc
May 24, 2021 - V8.67
Added TRestParamsSrv component which provides methods for creating REST server Json responses from a SQL database resultset, one or more rows, also error responses. Note this is only compiled if DATABASE is defined in Defs.inc to avoid bringing in database units that are not available on all Delphi editions.  No demo yet.
RestParams has a new method AddItemNULL to add a null, in Json this will be unquoted.
TIcsInetAlive better error for ping hops exceeded, and change default from 16 to 25.
Replaced Stream.Seek with Stream.Position.


OverbyteIcsUtils.pas
May 19, 2021 V8.67 
Added overloaded AnsiToUnicode with specified size buffer. used by IcsMoveTBytesToString and some IcsHtmlToStr conversion to resolve problem processing buffer with no terminating null, so extra characters got added beyond buffer end.
Added common computer size literals IcsKBYTE, IcsMBYTE, IcsGBYTE.
Added IcsStringBuild class moved from OverbyteIcsBlacklist, works on all compilers.


OverbyteIcsMailQueue.pas
21 May 2021 - V8.67
Rewrote sequential number generation to avoid file locking errors and unicode BOM corrupting file, generate large random number for errors instead of reverting to 1.
Don't save BOM with unicode compilers.


OverbyteIcsProxy.pas
May 17, 2021 V8.67
Don't send HTTP request header until after HTTP body has been processed in case the body length changes, thanks to Linden Roth.
HTTP Forward Proxy using HTTP works again, broken in V8.65.
Using HTTP Forward Proxy, convert absolute URL to path only since some servers can not process an absolute URL and sulk.
Using IcsXBYTE literals to avoid lots of zeros, replaced cLF style literals with IcsLF, etc.
DefMaxBodySize is now really 10MB and not 1M.


OverbyteIcsWSocket.pas
May 18, 2021 V8.67 
No changes here yet, just version.


OverbyteIcsBlacklist.pas
May 19, 2021 - V8.67
Moved TIcsStringBuild class to OverbyteIcsUtils.

OverbyteIcsCharsetUtils.pas
OverbyteIcsFormDataDecoder.pas
OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
OverbyteIcsFtpMulti.pas
OverbyteIcsFtpMultiW.pas
OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
OverbyteIcsHttpCCodZLib.pas
OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
OverbyteIcsHttpProt.pas
OverbyteIcsHttpSrv.pas
OverbyteIcsIpStreamLog.pas
OverbyteIcsMimeDec.pas
OverbyteIcsMimeUtils.pas
OverbyteIcsStreams.pas
OverbyteIcsSuperObject.pas
OverbyteIcsSuperXMLParser.pas
OverbyteIcsZlibHigh.pas
May 24, 2021 V8.67 
Replaced Stream.Seek with Stream.Position.
Replaced soFromCurrent with soCurrent.

------------------------------------------------------------------------
r1518 | angus | 2021-06-02 11:01:39 +0100 (Wed, 02 Jun 2021) | 18 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.67 - Part 6

OverbyteIcsWSocket.pas
June 01, 2021 V8.67 
SendTo and SendTo6 now set LastError on failure (Send, SendStr, etc already did so).


OverbyteIcsIpStreamLog.pas
Jun 01, 2021 - V8.67  
Replaced Stream.Seek with Stream.Position.
For Send errors, use LastError instead of GetLastError.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
01 Jun 2021 - V8.67
UDP server only now works correctly, Local always worked.

------------------------------------------------------------------------
r1519 | angus | 2021-06-09 12:40:30 +0100 (Wed, 09 Jun 2021) | 37 lines
Changed paths:
   M /trunk/ReadMe8.txt
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceCtl.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceCtl.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsIniFiles.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.67 - Part 7

Added a new SSL sample, OverbyteIcsDDWebService.dpr is very similar to OverbyteIcsSslMultiWebServ.dpr, but designed as a Windows service, although it will also run as a GUI for debugging.  It requires DDService service framework to be installed from https://www.magsys.co.uk/delphi/ddservice.asp. It also includes a REST server with simple lookup responses from a SQL database, which optionally requires DISQLite3 to be installed from http://www.yunqa.de. Note this sample in not in the project groups due to these pre-requisites. 


OverbyteIcsIniFiles.pas
Jun 4, 2021 - V8.67
GetIcsIniFileName now has (Local: Boolean = True) for local user app data (C:\Users\(user)\AppData\Local\ICS), but false is now all users common app data instead, c:\ProgramData\ICS.
GetCommonAppDataFolder now uses IcsGetShellPath in Utils. 


OverbyteIcsSslHttpRest.pas
Jun 09, 2021 - V8.67
TRestParamsSrv now works without dataset RecCount.  


OverbyteIcsUtils.pas
Jun 04, 2021 V8.67
Added common computer size literals IcsKBYTE, IcsMBYTE, IcsGBYTE.
Added IcsStringBuild class moved from OverbyteIcsBlacklist, works on all compilers.
Added IcsGetShellPath based on GetCommonAppDataFolder in OverbyteIcsIniFiles.

OverbyteIcsBlacklist.pas
Added documentation, previously in wrong unit. 

Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dof
Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dpr
Samples/Delphi/SslInternet/OverbyteIcsDDWebService.dproj
Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
Samples/Delphi/SslInternet/OverbyteIcsDDWebService.res
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceCtl.dfm
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceCtl.pas
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
New sample, see above. 


------------------------------------------------------------------------
r1520 | angus | 2021-06-11 11:13:27 +0100 (Fri, 11 Jun 2021) | 5 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas

ICS V8.67 - Part 8

Simple fix so SslInternet/OverbyteIcsDDWebServiceSrv opens the SQL database file when run as a Windows service.  

Note that DISQLite3 5.36.5 or later is needed for the sample to run as a Windows service.  
------------------------------------------------------------------------
r1521 | angus | 2021-06-25 15:07:15 +0100 (Fri, 25 Jun 2021) | 90 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsIniFiles.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.67 - Part 9

These changes provide initial support for the next major release of OpenSSL 3.0, due for release by the end of September, tested with OpenSSL 3.0.0-beta1.  

Fortunately 3.0 is reasonably compatible with 1.1.1, mainly a few library exports have changed name but ICS hides that.  3.0 has a major internal rewrite using providers that replace the old engines, some internal, some external, it will be FIPS approved.  

Many old crypto algorithms are now deprecated are  only available if an optional legacy provider is loaded, including MD2, MD4, Blowfish, DES, IDEA, RC2, RC4, SEED.  

The main implication (so far) for ICS with OpenSSL 3.0 is for SSL/TLS certificate private keys saved with password protection, which is required for PKCS12 certificates for importing into the Windows certificate store.  ICS previously defaulted to 3DES encryption which is deprecated in 3.0 preventing private keys (for servers) being read unless the legacy provider is loaded.

Testing so far has mixed results loading the legacy provider to read old private keys, more investigation is
needed.  

Meanwhile, ICS V8.67 removes support for saving new private keys with legacy algorithms, so only AES can now be used. AES was an option before for PEM private keys, but not for PKCS12 which always used 3DES.  

The ICS sample OverbyteIcsPemTool built with V8.67 and using OpenSSL 1.1.1 will be able to read old PKC12 certificates and save them with the newer encryption.  For Let's Encrypt certificates, just order a new one, which may happen automatically
with ICS servers.

OpenSSL 3.0.0-beta1 for Win32 only is available on request for anyone wanted to test it with ICS. 


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Jun 24, 2021 V8.67 
Changed CRYPTO_free declaration to keep C++ happy.
Updated to support OpenSSL 3.0, EVP_PKEY_set_alias_type gone but was never used, 10 other EVP exports renamed.  More NIDs. 
OpenSSL 3.0 makes several old ciphers and digests legacy meaning they are not normally loaded, so removed types PrivKeyEncTripleDES, PrivKeyEncIDEA, PrivKeyEncBlowfish128, Cipher_des_ede3_cbc, Cipher_idea_cbc, Cipher_bf_cbc, and SslPrivKeyEvpBits so new applications don't use them.  


OverbyteIcsWSocket.pas
June 24, 2021 V8.67 
SendTo and SendTo6 now set LastError on failure (Send, SendStr, etc  already did so).
Changed PKCS12 certificate encryption to AES 256 CBC, since previous default not supported by OpenSSL 3.0.


OverbyteIcsWSocketS.pas
Jun 24, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256.


OverbyteIcsSslX509Certs.pas
Jun 24, 2021 - V8.67
Improved error messages if testing challenge fails.
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256, PrivKeyEncTripleDES gone change to PrivKeyEncAES256.


OverbyteIcsSslX509Utils.pas
Jun 24, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256.


OverbyteIcsBlacklist.pas
Jun 24, 2021 - V8.67
Moved TIcsStringBuild class to OverbyteIcsUtils.
Internally use BlockedFlag instead of setting attempts to 9999 so we can keep counting failed attempts.
SaveAscii defaulted to true to save IPv6 addresses.


OverbyteIcsFtpSrv.pas
Jun 14, 2021 V8.67   
Replaced Stream.Seek with Stream.Position.
Replaced DirExists with IcsDirExists in Utils to fix problem on Win64.


OverbyteIcsProxy.pas
Jun 21, 2021 V8.67  
HTTP Forward Proxy don't change path to lowercase when removing host, it corrupts mixed case URLs.


OverbyteIcsUtils.pas
Jun 15, 2021 V8.67 
Added IcsDirExists to replace DirExists in OverbyteIcsFtpSrv.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Jun 21, 2021 V8.67
Display hex ICS_OPENSSL_VERSION_NUMBER.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Jun 24, 2021 - V8.67
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256.
Note the Key Encryption menu has three old options removed so the sample INI file may show the wrong setting. 




------------------------------------------------------------------------
r1522 | angus | 2021-07-15 18:19:43 +0100 (Thu, 15 Jul 2021) | 55 lines
Changed paths:
   A /trunk/Install/CB110InstallVclFmx.groupproj
   A /trunk/Install/D110Install.groupproj
   A /trunk/Install/D110InstallVclFmx.groupproj
   A /trunk/Packages/IcsCommonCB110Design.cbproj
   A /trunk/Packages/IcsCommonCB110Design.cpp
   A /trunk/Packages/IcsCommonCB110Design.res
   A /trunk/Packages/IcsCommonCB110Run.cbproj
   A /trunk/Packages/IcsCommonCB110Run.cpp
   A /trunk/Packages/IcsCommonCB110Run.res
   A /trunk/Packages/IcsCommonD104Design.res
   A /trunk/Packages/IcsCommonD104Run.res
   A /trunk/Packages/IcsCommonD110Design.dpk
   A /trunk/Packages/IcsCommonD110Design.dproj
   A /trunk/Packages/IcsCommonD110Design.res
   A /trunk/Packages/IcsCommonD110Run.dpk
   A /trunk/Packages/IcsCommonD110Run.dproj
   A /trunk/Packages/IcsCommonD110Run.res
   A /trunk/Packages/IcsFmxCB110Design.cbproj
   A /trunk/Packages/IcsFmxCB110Design.cpp
   A /trunk/Packages/IcsFmxCB110Design.res
   A /trunk/Packages/IcsFmxCB110Run.cbproj
   A /trunk/Packages/IcsFmxCB110Run.cpp
   A /trunk/Packages/IcsFmxCB110Run.res
   A /trunk/Packages/IcsFmxD104Design.res
   A /trunk/Packages/IcsFmxD104Run.res
   A /trunk/Packages/IcsFmxD110Design.dpk
   A /trunk/Packages/IcsFmxD110Design.dproj
   A /trunk/Packages/IcsFmxD110Design.res
   A /trunk/Packages/IcsFmxD110Run.dpk
   A /trunk/Packages/IcsFmxD110Run.dproj
   A /trunk/Packages/IcsFmxD110Run.res
   A /trunk/Packages/IcsLinuxD110.dpk
   A /trunk/Packages/IcsLinuxD110.dproj
   A /trunk/Packages/IcsLinuxD110.res
   A /trunk/Packages/IcsVclCB110Design.cbproj
   A /trunk/Packages/IcsVclCB110Design.cpp
   A /trunk/Packages/IcsVclCB110Design.res
   A /trunk/Packages/IcsVclCB110Run.cbproj
   A /trunk/Packages/IcsVclCB110Run.cpp
   A /trunk/Packages/IcsVclCB110Run.res
   A /trunk/Packages/IcsVclD104Design.res
   A /trunk/Packages/IcsVclD104Run.res
   A /trunk/Packages/IcsVclD110Design.dpk
   A /trunk/Packages/IcsVclD110Design.dproj
   A /trunk/Packages/IcsVclD110Design.res
   A /trunk/Packages/IcsVclD110Run.dpk
   A /trunk/Packages/IcsVclD110Run.dproj
   A /trunk/Packages/IcsVclD110Run.res
   A /trunk/Packages/OverbyteIcsD110Design.dpk
   A /trunk/Packages/OverbyteIcsD110Design.dproj
   A /trunk/Packages/OverbyteIcsD110Design.res
   A /trunk/Packages/OverbyteIcsD110Run.dpk
   A /trunk/Packages/OverbyteIcsD110Run.dproj
   A /trunk/Packages/OverbyteIcsD110Run.res
   M /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/01key.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.67 - Part 10

Added support and packages for testing Delphi 11.0 beta.  Updated root certificate bundles, old certificates gone, new ones added, nothing major.  More minor changes in preparation for OpenSSL 3.0.  


OverbyteIcsHttpProt.pas
Jul 12, 2021 V8.67 
Renamed FBodyLineCount to FBodyStartedFlag since count never used,fixes a problem with very long streams being received.
Fixed a relocation problem where the Location: header included a path with a space, encode it.
Fixed another relocation problem where HEAD sometimes stalled.
Replaced Stream.Seek with Stream.Position.
Remove # fragment or anchor from URL in relocation, only used by browsers and not by servers.


OverbyteIcsLIBEAY.pas
Jul 15, 2021 V8.67 
ECDSA_xx functions were never loaded.


OverbyteIcsSslJose.pas
Jul 13, 2021 V8.67
Rewrite ECDSA signing.

OverbyteIcsSslX509Certs.pas
Jul 15, 2021 - V8.67
Improved error messages if testing challenge fails.
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256, PrivKeyEncTripleDES gone, auto changed to PrivKeyEncAES256.
termsOfService PDF now 404, so ignore it.
Changed extraction of download PEM bundle so that main certificate does not need to be first in file, log them all, ignore any  self signed root certificates.


OverbyteIcsSslX509Utils.pas
Jul 09, 2021  V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256.
Updated root certificate bundle, one old cert gone.
Added new Let's Encrypt ECDSA X2 root not yet in public bundles.


OverbyteIcsWSocket.pas
July 15, 2021 V8.67 
SendTo and SendTo6 now set LastError on failure (Send, SendStr, etc  already did so).
Changed PKCS12 certificate encryption to AES256 CBC, since previous default not supported by OpenSSL 3.0.  Default in this unit for encryption is None, but recommend PrivKeyEncAES256.
TX509Base.ValidateCertChain reports CA roots for multiple certificate verification paths with two or more intermediate certificates, rather than only the last. 


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jul 15, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256. 
Added function ResavePrivateKey and Resave Private Key menu option which prompt for a PFX or PEM file containing an encrypted  private key -BEGIN ENCRYPTED PRIVATE KEY- with a new cipher, renaming old file to .oldpem/pfx.  Specifically for files saved  with old ciphers than OpenSSL 3.0 does not support as standard, should be used with OpenSSL 1.1.1 before upgrading.


Samples/Delphi/SslInternet/RootCaCertsBundle.pem
Samples/Delphi/SslInternet/TrustedCABundle.pem
Updated root certificate bundles, old certificates gone, new ones added, nothing major.  

------------------------------------------------------------------------
r1523 | angus | 2021-07-23 19:37:03 +0100 (Fri, 23 Jul 2021) | 70 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.67 - Part 11

Further work to support OpenSSL 3.0.  A previous update removed support for saving new private keys with password protected with legacy encryption algorithms, which has been reverted due to not being able to install new SSL/TLS certificates into Windows Server 2012 (which is why I test a lot). The new default password encryption AES256 is not recognised until Windows Server 2016 v1709  and Windows 10 v1709, so Server 2012, Windows 10 RTM and earlier won't load AES passworded keys, only 3DES.   


OverbyteIcsHttpAppServer.pas
Jul 23, 2021 V8.67 
Added NO_CACHE_EX as Cache-Control: no-cache to replace Pragma: no-cache.
Added NO_STORE_EX as Cache-Control: no-store better than no-cache
Added optional LastModified param to AnswerStream, AnswerPage, and AnswerString to avoid needing custom header line.
Added PUT and DELETE verb handlers, similar to GET and POST.


OverbyteIcsLIBEAY.pas
Jul 23, 2021 V8.67 
Changed CRYPTO_free declaration to keep C++ happy.
Updated to support OpenSSL 3.0, EVP_PKEY_set_alias_type gone but was never used, 10 other EVP exports renamed.
More NIDs.
ECDSA_xx functions were never loaded.
Added various OSSL_PROVIDER functions and types and support for new OpenSSL 3.0 version numbering.
Added LibeayLoadProviders which loads the legacy or Fips providers (not both together), called automatically if GSSLEAY_LOAD_LEGACY true on start-up, currently only into the default context for all crypto operations. 

OverbyteIcsSSLEAY.pas
Jul 23, 2021 V8.67 
Updated to support OpenSSL 3.0, SSL_get_peer_certificate export renamed.
OpenSSL 3.0 makes several old ciphers and digests legacy meaning they are not normally loaded, so removed types PrivKeyEncBlowfish128, Cipher_des_ede3_cbc, Cipher_idea_cbc, Cipher_bf_cbc, and SslPrivKeyEvpBits so new applications don't use them.
Added new version variables ICS_OPENSSL_VERSION_MAJOR/MINOR/PATCH/PRE_RELEASE, and ICS_OSSL3_LOADED_LEGACY and ICS_OSSL3_LOADED_FIPS if these OpenSSL 3.0 providers are loaded.
GSSLEAY_LOAD_LEGACY set to true caused legacy provider to be loaded on start-up.

OverbyteIcsSslX509Certs.pas
Jul 20, 2021 - V8.67
Improved error messages if testing challenge fails.
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256.
Changed extraction of download PEM bundle so that main certificate does not need to be first in file, log them all, ignore any self signed root certificates.
If testing dns-01 challenge fails, rotate to next public server and three retries (previously only happened on timeout). 
When saving files with private keys, log encryption type used. 
Another attempt as consistently formatted literals, fewer capitals.

OverbyteIcsWSocket.pas
July 23, 2021 V8.67 
SendTo and SendTo6 now set LastError on failure (Send, SendStr, etc already did so).
TX509Base.ValidateCertChain reports CA roots for multiple certificate verification paths with two or more intermediate certificates, rather than only the last.
Added PKCS12 certificate encryption of AES256 CBC, since previous default 3DES is not supported by OpenSSL 3.0 unless the legacy module is loaded. Beware AES256 not recognised until Windows Server 2016 v1709 and Windows 10 v1709, so Server 2012, Windows 10 RTM and earlier won't load AES passworded keys.
OpenSSL 3.0 unload any providers we loaded.  

Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
23 July 2021
REST API page now created as TUrlHandlerRestApi instead of as a virtual page, little simpler.

Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Jul 22, 2021 V8.67
Display hex ICS_OPENSSL_VERSION_NUMBER and more OpenSSL 3.0 information.

Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Jul 23, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256 unless support for Windows Server 2012 and early version of Windows 10 are needed when 3DES must be used.
Display encryption method used for private key when saving them.
Added function ResavePrivateKey and Resave Private Key menu option which prompt for a PFX or PEM file containing an encrypted private key -BEGIN ENCRYPTED PRIVATE KEY- with a new cipher, renaming old file to .oldpem/pfx.  Specifically for files saved  with old ciphers than OpenSSL 3.0 does not support as standard, should be used with OpenSSL 1.1.1 before upgrading.
Tries to load OpenSSL 3.0 legacy provider for old algorithms, About windows shows if it's loaded, without which 3DES password encryption is not available. 

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Jul 23, 2021 - V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256.
Log OpenSSL version.
Tries to load OpenSSL 3.0 legacy provider for old algorithms, logs if it's loaded, without which 3DES password encryption  is not available.



------------------------------------------------------------------------
r1524 | angus | 2021-08-24 18:54:18 +0100 (Tue, 24 Aug 2021) | 112 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool.dproj
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool2.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsJwaWinCrypt.inc
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsMsSslUtils.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsWinCrypt.pas

ICS V8.67 - Part 12

Further changes preparing for OpenSSL 3.0 support due next week (delayed due to new 1.1.1 release today).  

ICS has new classes TMsCertTools and TMsX509List to write and read SSL/TLS certificates to and from the Windows Certificate Store, including private keys.  This is primarily so Let's Encrypt certificates can be installed automatically for use with the IIS web server.  The PemTool sample includes new buttons to list all the Windows certificate and private key stores and allow old items to be deleted.  


OverbyteIcsWSocket.pas
Aug 23, 2021 V8.67 
SendTo and SendTo6 now set LastError on failure (Send, SendStr, etc already did so).
TX509Base.ValidateCertChain reports CA roots for multiple certificate verification paths with two or more intermediate certificates, rather than only the last.
Added PKCS12 certificate encryption of AES256 CBC, since previous default 3DES is not supported by OpenSSL 3.0 unless the legacy module is loaded. Beware AES256 not recognised until Windows Server 2016 v1709 and Windows 10 v1709, so Server 2012, Windows 10 RTM and earlier won't load AES passworded keys.
OpenSSL 3.0 unload any providers we loaded.
Added TX509Base.SaveToP12Buf.
Added TX509Base.CertMainInfo provides a single line with the main certificate information.
Added TX509Base.Comments/CertName/KeyName for certificate information when exporting Windows store certificates, or building bundles. .

OverbyteIcsMsSslUtils.pas
Aug 23, 2021 V8.67 
Added new class TMsX509List descends from TX509List adding a method LoadFromStore to load the list from a Windows certificate store by store name TMsCertStore and location MsCertLocation.  Option to not empty list first, allowing multiple stores to be loaded into the same list.  For My/Personal store, attempts to load private keys if they are allowed to be exported unencrypted.
TMsX509List also has ListPKeys method to list content of private key stores which are independent of certificates, DeleteFromStore to delete one certificate by SHA1 digest, and DeletePKey to remove a private keys from the stores by key name.
Added new class TMsCertTools descends from TSslCertTools adding methods SaveToStorePfx and LoadFromMyStore to access Windows certificate stores.  
SaveToStorePfx saves the loaded certificate and private key to My/Personal store and any intermediates to the CA store. Note this methods store private keys so they can be exported from Windows.
LoadFromMyStore loads one certificate and private key from My/Personal store and the rest as intermediate, not ideal if more   than one certificate.  
Demos in OverbyteIcsPemtool.
Added IcsIsProgAdmin function does program have administrator access.

OverbyteIcsWinCrypt.pas
OverbyteIcsJwaWinCrypt.inc
Aug 10 2021 V8.67
Added missing PFX/PKCS12 functions.                       
Merged changes from JwaWinCrypt.pas,v 1.17, XP and later.
Added NCrypt functions CNG (Cryptography Next Generation)
Added some BCrypt and some WinCrypt updates for CNG.   

OverbyteIcsSslX509Certs.pas
Aug 24, 2021 - V8.67
Improved error messages if testing challenge fails.
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting PFX/P12 files is now PrivKeyEncAES256 with 3.0 unless the legacy DLL is loaded when still PrivKeyEncTripleDES so older versions of Windows can load them.
Changed extraction of download PEM bundle so that main certificate does not need to be first in file, log them all, ignore any self signed root certificates.
If testing dns-01 challenge fails, rotate to next public server and three retries (previously only happened on timeout).
When saving files with private keys, log encryption type used.
Another attempt as consistently formatted literals, fewer capitals.
Added more certificate output formats, OutFmtPwPem and OutFmtPwP12 specify whether to password PEM and P12/PFX private keys. Note Windows always needs passworded P12/PRX files, while Apache web server only accepts PEM files without a password.
Allow automatic installation of new certificates to the Windows Certificate Store so they can be used by IIS web sites, by   setting output format to OutFmtWinStore.  Note application must have administrator rights to do this.
Truncate certificate chain info to 1,000 bytes avoid overloading database INI file.

OverbyteIcsWSocketS.pas
Aug 23, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting PFX/P12 files is now PrivKeyEncAES256 with 3.0 unless the legacy DLL is loaded when still PrivKeyEncTripleDES so older versions of Windows can load them.
Set certificate order output format to OutFmtPwP12.

OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
Aug 07, 2021 V8.67 
Replaced Stream.Seek with Stream.Position.
Support option ftpFixPasvLanIP for PUT/APPE uploads as well as  downloads, see V8.63.
Support IPv6 for PUT/APPE uploads as well as downloads.

OverbyteIcsLIBEAY.pas
Aug 04, 2021 V8.67 
Changed CRYPTO_free declaration to keep C++ happy.
Updated to support OpenSSL 3.0, EVP_PKEY_set_alias_type gone but was never used, 10 other EVP exports renamed.
More NIDs.
ECDSA_xx functions were never loaded.
Added various OSSL_PROVIDER functions and types and support for new OpenSSL 3.0 version numbering.  Also i2d_PKCS8PrivateKey_bio.
Added LibeayLoadProviders which loads the legacy or Fips providers (not both together), called automatically if SSLEAY_LOAD_LEGACY true on start-up, currently only into the default context for all crypto operations.

OverbyteIcsSSLEAY.pas
Aug 02, 2021 V8.67 
Updated to support OpenSSL 3.0, SSL_get_peer_certificate export renamed.
OpenSSL 3.0 makes several old ciphers and digests legacy meaning they are not normally loaded, so removed types PrivKeyEncBlowfish128, Cipher_des_ede3_cbc, Cipher_idea_cbc, Cipher_bf_cbc, and SslPrivKeyEvpBits so new applications don't use them.
Added new version variables ICS_OPENSSL_VERSION_MAJOR/MINOR/PATCH/PRE_RELEASE, and ICS_OSSL3_LOADED_LEGACY and ICS_OSSL3_LOADED_FIPS if these OpenSSL 3.0 providers are loaded. 
GSSLEAY_LOAD_LEGACY set to true caused legacy provider to be loaded on start-up.


OverbyteIcsSslJose.pas
Aug 24, 2021 V8.67     Support longer RSA keys.

OverbyteIcsMailQueue.pas
09 Aug 2021 - V8.67
Rewrote sequential number generation to avoid file locking errors and unicode BOM corrupting file, generate large random number for errors instead of reverting to 1.
Don't save BOM with unicode compilers.
Tweak OpenSSL version reported. 

Samples/Delphi/SslInternet/OverbyteIcsPemTool.dproj
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Samples/Delphi/SslInternet/OverbyteIcsPemTool2.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool2.pas
Aug 23, 2021 V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting private key files is now PrivKeyEncAES256 unless support for Windows Server 2012 and early version of Windows 10 are needed when 3DES must be used.
Display encryption method used for private key when saving them.
Added function ResavePrivateKey and Resave Private Key menu option qhich prompt for a PFX or PEM file containing an encrypted  private key -BEGIN ENCRYPTED PRIVATE KEY- with a new cipher, renaming old file to .oldpem/pfx.  Specifically for files saved  with old ciphers than OpenSSL 3.0 does not support as standard,  should be used with OpenSSL 1.1.1 before upgrading.
Tries to load OpenSSL 3.0 legacy provider for old algorithms, About windows shows if it's loaded, without which 3DES password   encryption is not available.
Displaying certificates and bundles is no longer a new modal window, but updates the existing log window.
Improved import certificates from Windows certificate store to use TMsX509List instead of Windows API calls, and to access all Windows store locations instead of just user, specifically the Local Machine store where server certificates are located.
New button and list to display the content of any Windows stores using TMsX509List including the private key got My/Personal store, and allowing selected certificates to be loaded for further processing or saving. Displays the Windows friendly name for certificates.
Certificates may be deleted from Windows stores.
New button and list to display private key stores which are independent of certificates, and to delete private keys from the stores.
Added saving a PEM or PFX bundle file to the Windows certificate My/Personal store with private key and intermediates. Certificates can be stored to the users or local machine stores, the latter is required for IIS web server certificates and the application needs administrator rights to do so, labels if admin rights OK.
The Create Certificates tab has two new buttons to specify whether PEM and/or PKCS12 private keys should be password protected,  previously both or neither were passworded.

Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
Aug 24, 2021 - V8.67 
OpenSSL 3.0 makes several old ciphers and digests legacy so default for encrypting passwords is now PrivKeyEncAES256.
Log OpenSSL version.
Tries to load OpenSSL 3.0 legacy provider for old algorithms, logs if it's loaded, without which 3DES password encryption  is not available.
Added new Output Certificate tick boxes to password PEM and PKCS12/PFX keys, and to install a certificate into the Windows Personal/My Store so IIS can use it (note the private  key can not be exported).


------------------------------------------------------------------------
r1525 | angus | 2021-08-25 17:37:56 +0100 (Wed, 25 Aug 2021) | 7 lines
Changed paths:
   M /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   M /trunk/OpenSSL-Win32/libssl-1_1.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll

ICS V8.67 - Part 13

Updated to OpenSSL 1.1.1l with two security fixes, one rated high relating to decryption using SM2 (which standard ICS does not offer) and rated moderate relating to ASN.1 strings used in X509 certificates and the confusing conversion between fixed length strings and C null terminated strings that may cause a crash, this was mainly a problem display certificate content.  

YuOpenSSL has a new version with OpenSSL 1.1.1l. 


------------------------------------------------------------------------
r1526 | angus | 2021-09-03 12:33:06 +0100 (Fri, 03 Sep 2021) | 23 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsMsSslUtils.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.67 - Part 14

Minor fixes to the last major set of changes making passwords selectable optional for PEM and PKCS12 bundle files.  Unfortunately this meant new Let's Encrypt certificate orders for existing domains were not passworded and could not be opened by the server, so fixed ICS to try and open private keys without a password if the password fails.  This issue can not be fixed in a backward compatible way, so any ICS servers set to order Let's Encrypt certificates with passworded private keys should manually edit the ics-control.db file, look for CertOutFmts=[OutFmtP12] lines and add OutFmtPwP12.  


OverbyteIcsWSocket.pas
Sep 02, 2021 V8.67 
Fail to open passworded private key, retry without password.
Tweaked PKCS12 default parameters for backward compatibility. 


OverbyteIcsWSocketS.pas
Sept 01, 2021 V8.67
Set certificate order output format to OutFmtPwP12 if a password is specified for ordering new certificates.  


OverbyteIcsMsSslUtils.pas
Sep 02, 2021 V8.67 
Minor fixes installing certificates in the windows store. 




------------------------------------------------------------------------
r1527 | angus | 2021-09-09 11:40:48 +0100 (Thu, 09 Sep 2021) | 7 lines
Changed paths:
   A /trunk/Development
   A /trunk/Development/Jobs
   A /trunk/Development/Jobs/sign-102u.bat
   A /trunk/Development/Jobs/sign-111k.bat
   A /trunk/Development/Jobs/sign-111l.bat
   A /trunk/Development/Jobs/sign-300.bat
   A /trunk/Development/Media
   A /trunk/Development/Media/Blacklist.ifx
   A /trunk/Development/Media/Blacklistall.ico
   A /trunk/Development/Media/Blank16.bmp
   A /trunk/Development/Media/Blank24.bmp
   A /trunk/Development/Media/Blank32.bmp
   A /trunk/Development/Media/HttpDns16.bmp
   A /trunk/Development/Media/HttpDns24.bmp
   A /trunk/Development/Media/HttpDns32.bmp
   A /trunk/Development/Media/HttpEmail16.bmp
   A /trunk/Development/Media/HttpEmail24.bmp
   A /trunk/Development/Media/HttpEmail32.bmp
   A /trunk/Development/Media/HttpProt16.bmp
   A /trunk/Development/Media/HttpProt24.bmp
   A /trunk/Development/Media/HttpProt32.bmp
   A /trunk/Development/Media/HttpRest16.bmp
   A /trunk/Development/Media/HttpRest24.bmp
   A /trunk/Development/Media/HttpRest32.bmp
   A /trunk/Development/Media/HttpRest32.ico
   A /trunk/Development/Media/HttpServer16.bmp
   A /trunk/Development/Media/HttpServer24.bmp
   A /trunk/Development/Media/HttpServer32.bmp
   A /trunk/Development/Media/HttpSms16.bmp
   A /trunk/Development/Media/HttpSms24.bmp
   A /trunk/Development/Media/HttpSms32.bmp
   A /trunk/Development/Media/HttpTwitter16.bmp
   A /trunk/Development/Media/HttpTwitter24.bmp
   A /trunk/Development/Media/HttpTwitter32.bmp
   A /trunk/Development/Media/InetAlive16.bmp
   A /trunk/Development/Media/InetAlive24.bmp
   A /trunk/Development/Media/InetAlive32.bmp
   A /trunk/Development/Media/IpStreamLog24.bmp
   A /trunk/Development/Media/IpStreamLog24.ico
   A /trunk/Development/Media/IpStreamLogAll.ico
   A /trunk/Development/Media/MailQueue24.bmp
   A /trunk/Development/Media/MailQueue24.ico
   A /trunk/Development/Media/MailQueue24.ifx
   A /trunk/Development/Media/MailQueueAll.ico
   A /trunk/Development/Media/New Icon.ico
   A /trunk/Development/Media/RestOAuth16.bmp
   A /trunk/Development/Media/RestOAuth24.bmp
   A /trunk/Development/Media/RestOAuth32.bmp
   A /trunk/Development/Media/SimpleWebSrv16.bmp
   A /trunk/Development/Media/SimpleWebSrv24.bmp
   A /trunk/Development/Media/SimpleWebSrv32.bmp
   A /trunk/Development/Media/SmtpProt24.bmp
   A /trunk/Development/Media/SmtpProt24.ifx
   A /trunk/Development/Media/SslX509Certs16.bmp
   A /trunk/Development/Media/SslX509Certs24.bmp
   A /trunk/Development/Media/SslX509Certs32.bmp
   A /trunk/Development/Media/SslX509Certs32.ico
   A /trunk/Development/Media/TWSOCKET16_256.bmp
   A /trunk/Development/Media/TWSOCKET32_256.bmp
   A /trunk/Development/Media/TWSOCKET_256.bmp
   A /trunk/Development/Media/Whois24.bmp
   A /trunk/Development/Media/certificate1_lock_closed-18x18.bmp
   A /trunk/Development/Media/certificate1_lock_closed-24x24.bmp
   A /trunk/Development/Media/certificate1_lock_closed-38x30.bmp
   A /trunk/Development/Media/certificate1_lock_closed.ico
   A /trunk/Development/Media/sntpclient.bmp
   A /trunk/Development/Media/sntpclient.ico
   A /trunk/Development/Media/twsocket16.bmp
   A /trunk/Development/Media/twsocket24.bmp
   A /trunk/Development/Media/twsocket32.bmp
   A /trunk/Development/Media/whoisall.ico
   A /trunk/Development/SampleInI
   A /trunk/Development/SampleInI/IpStmLogTst-props.sdt
   A /trunk/Development/SampleInI/IpStmLogTstreadcomp.inc
   A /trunk/Development/SampleInI/IpStmLogTstwritecomp.inc
   A /trunk/Development/SampleInI/JoseTest-props.sdt
   A /trunk/Development/SampleInI/JoseTestreadcomp.inc
   A /trunk/Development/SampleInI/JoseTestwritecomp.inc
   A /trunk/Development/SampleInI/MailQuDemo-props.sdt
   A /trunk/Development/SampleInI/MailQuDemoreadcomp.inc
   A /trunk/Development/SampleInI/MailQuDemowritecomp.inc
   A /trunk/Development/SampleInI/PemTool-props.sdt
   A /trunk/Development/SampleInI/PemToolreadcomp.inc
   A /trunk/Development/SampleInI/PemToolwritecomp.inc
   A /trunk/Development/SampleInI/RestDemo-props.sdt
   A /trunk/Development/SampleInI/RestDemoreadcomp.inc
   A /trunk/Development/SampleInI/RestDemowritevars.inc
   A /trunk/Development/SampleInI/X509Certs-props.sdt
   A /trunk/Development/SampleInI/X509Certsreadcomp.inc
   A /trunk/Development/SampleInI/X509Certswritecomp.inc
   A /trunk/Development/SampleInI/wmitest-props.sdt
   A /trunk/Development/SampleInI/wmitestreadcomp.inc
   A /trunk/Development/SampleInI/wmitestwritecomp.inc
   A /trunk/Development/SampleInI/xfertst-props.sdt
   A /trunk/Development/SampleInI/xfertstreadcomp.inc
   A /trunk/Development/SampleInI/xfertstwritecomp.inc
   A /trunk/Development/Testing
   A /trunk/Development/Testing/icontest.dpr
   A /trunk/Development/Testing/icontest.dproj
   A /trunk/Development/Testing/icontest.res
   A /trunk/Development/Testing/icontest1.dfm
   A /trunk/Development/Testing/icontest1.pas
   M /trunk/ReadMe8.txt
   M /trunk/Source/Include/OverbyteIcsDefs.inc

ICS V8.67 - Part 15

Updated readme for Delphi 11.0.  All the packages are already in SVN.

Added a new Development folder with the new BMP images used to create the ICS icons, and a number of other files used during the development if ICS, none of which will be zipped for distribution, they are purely for internal development. 


------------------------------------------------------------------------
r1528 | angus | 2021-09-10 19:08:02 +0100 (Fri, 10 Sep 2021) | 6 lines
Changed paths:
   D /trunk/Development/Media/Blacklistall.ico
   D /trunk/Development/Media/HttpDns16.bmp
   D /trunk/Development/Media/HttpDns24.bmp
   D /trunk/Development/Media/HttpDns32.bmp
   D /trunk/Development/Media/HttpEmail16.bmp
   D /trunk/Development/Media/HttpEmail24.bmp
   D /trunk/Development/Media/HttpEmail32.bmp
   D /trunk/Development/Media/HttpProt16.bmp
   D /trunk/Development/Media/HttpProt24.bmp
   D /trunk/Development/Media/HttpProt32.bmp
   D /trunk/Development/Media/HttpRest16.bmp
   D /trunk/Development/Media/HttpRest24.bmp
   D /trunk/Development/Media/HttpRest32.bmp
   D /trunk/Development/Media/HttpRest32.ico
   D /trunk/Development/Media/HttpServer16.bmp
   D /trunk/Development/Media/HttpServer24.bmp
   D /trunk/Development/Media/HttpServer32.bmp
   D /trunk/Development/Media/HttpSms16.bmp
   D /trunk/Development/Media/HttpSms24.bmp
   D /trunk/Development/Media/HttpSms32.bmp
   D /trunk/Development/Media/HttpTwitter16.bmp
   D /trunk/Development/Media/HttpTwitter24.bmp
   D /trunk/Development/Media/HttpTwitter32.bmp
   D /trunk/Development/Media/InetAlive16.bmp
   D /trunk/Development/Media/InetAlive24.bmp
   D /trunk/Development/Media/InetAlive32.bmp
   D /trunk/Development/Media/IpStreamLog24.bmp
   D /trunk/Development/Media/IpStreamLog24.ico
   D /trunk/Development/Media/IpStreamLogAll.ico
   D /trunk/Development/Media/MailQueue24.bmp
   D /trunk/Development/Media/MailQueue24.ico
   D /trunk/Development/Media/MailQueueAll.ico
   D /trunk/Development/Media/New Icon.ico
   A /trunk/Development/Media/OverByteIcsMimeDec.rc
   A /trunk/Development/Media/OverbyteIcsBlacklist.rc
   A /trunk/Development/Media/OverbyteIcsBuildDcr.bat
   A /trunk/Development/Media/OverbyteIcsCharsetComboBox.rc
   A /trunk/Development/Media/OverbyteIcsCookies.rc
   A /trunk/Development/Media/OverbyteIcsDnsQuery.rc
   A /trunk/Development/Media/OverbyteIcsEmulVT.rc
   A /trunk/Development/Media/OverbyteIcsFileCopy.rc
   A /trunk/Development/Media/OverbyteIcsFileCopyW.rc
   A /trunk/Development/Media/OverbyteIcsFingCli.rc
   A /trunk/Development/Media/OverbyteIcsFtpCli.rc
   A /trunk/Development/Media/OverbyteIcsFtpMulti.rc
   A /trunk/Development/Media/OverbyteIcsFtpMultiW.rc
   A /trunk/Development/Media/OverbyteIcsFtpSrv.rc
   A /trunk/Development/Media/OverbyteIcsHttpAppServer.rc
   A /trunk/Development/Media/OverbyteIcsHttpMulti.rc
   A /trunk/Development/Media/OverbyteIcsHttpMultiW.rc
   A /trunk/Development/Media/OverbyteIcsHttpProt.rc
   A /trunk/Development/Media/OverbyteIcsHttpSrv.rc
   A /trunk/Development/Media/OverbyteIcsIpStreamLog.rc
   A /trunk/Development/Media/OverbyteIcsLogger.rc
   A /trunk/Development/Media/OverbyteIcsMailQueue.rc
   A /trunk/Development/Media/OverbyteIcsMimeUtils.rc
   A /trunk/Development/Media/OverbyteIcsMultiProgressBar.rc
   A /trunk/Development/Media/OverbyteIcsMultipartFtpDownloader.rc
   A /trunk/Development/Media/OverbyteIcsMultipartHttpDownloader.rc
   A /trunk/Development/Media/OverbyteIcsNntpCli.rc
   A /trunk/Development/Media/OverbyteIcsPing.rc
   A /trunk/Development/Media/OverbyteIcsPop3Prot.rc
   A /trunk/Development/Media/OverbyteIcsProxy.rc
   A /trunk/Development/Media/OverbyteIcsSmtpProt.rc
   A /trunk/Development/Media/OverbyteIcsSmtpSrv.rc
   A /trunk/Development/Media/OverbyteIcsSnmpCli.rc
   A /trunk/Development/Media/OverbyteIcsSntp.rc
   A /trunk/Development/Media/OverbyteIcsSslHttpRest.rc
   A /trunk/Development/Media/OverbyteIcsSslSessionCache.rc
   A /trunk/Development/Media/OverbyteIcsSslX509Certs.rc
   A /trunk/Development/Media/OverbyteIcsSysLogClient.rc
   A /trunk/Development/Media/OverbyteIcsSysLogServer.rc
   A /trunk/Development/Media/OverbyteIcsTimeList.rc
   A /trunk/Development/Media/OverbyteIcsTnCnx.rc
   A /trunk/Development/Media/OverbyteIcsTnEmulVT.rc
   A /trunk/Development/Media/OverbyteIcsTnScript.rc
   A /trunk/Development/Media/OverbyteIcsWSocket.rc
   A /trunk/Development/Media/OverbyteIcsWSocketS.rc
   A /trunk/Development/Media/OverbyteIcsWSocketTS.rc
   A /trunk/Development/Media/OverbyteIcsWhoisCli.rc
   D /trunk/Development/Media/RestOAuth16.bmp
   D /trunk/Development/Media/RestOAuth24.bmp
   D /trunk/Development/Media/RestOAuth32.bmp
   D /trunk/Development/Media/SimpleWebSrv16.bmp
   D /trunk/Development/Media/SimpleWebSrv24.bmp
   D /trunk/Development/Media/SimpleWebSrv32.bmp
   D /trunk/Development/Media/SmtpProt24.bmp
   D /trunk/Development/Media/SslX509Certs16.bmp
   D /trunk/Development/Media/SslX509Certs24.bmp
   D /trunk/Development/Media/SslX509Certs32.bmp
   D /trunk/Development/Media/SslX509Certs32.ico
   A /trunk/Development/Media/TDNSQUERY16_24bpp.bmp
   A /trunk/Development/Media/TDNSQUERY32_24bpp.bmp
   A /trunk/Development/Media/TDNSQUERYHTTPS16_24bpp.bmp
   A /trunk/Development/Media/TDNSQUERYHTTPS32_24bpp.bmp
   A /trunk/Development/Media/TDNSQUERYHTTPS_24bpp.bmp
   A /trunk/Development/Media/TDNSQUERY_24bpp.bmp
   A /trunk/Development/Media/TEMULVT16_24bpp.bmp
   A /trunk/Development/Media/TEMULVT32_24bpp.bmp
   A /trunk/Development/Media/TEMULVT_24bpp.bmp
   A /trunk/Development/Media/TFINGERCLI16_24bpp.bmp
   A /trunk/Development/Media/TFINGERCLI32_24bpp.bmp
   A /trunk/Development/Media/TFINGERCLI_24bpp.bmp
   A /trunk/Development/Media/TFTPCLIENT16_24bpp.bmp
   A /trunk/Development/Media/TFTPCLIENT32_24bpp.bmp
   A /trunk/Development/Media/TFTPCLIENT_24bpp.bmp
   A /trunk/Development/Media/TFTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/TFTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/TFTPSERVER_24bpp.bmp
   A /trunk/Development/Media/THTMLNNTPCLI16_24bpp.bmp
   A /trunk/Development/Media/THTMLNNTPCLI32_24bpp.bmp
   A /trunk/Development/Media/THTMLNNTPCLI_24bpp.bmp
   A /trunk/Development/Media/THTMLSMTPCLI16_24bpp.bmp
   A /trunk/Development/Media/THTMLSMTPCLI32_24bpp.bmp
   A /trunk/Development/Media/THTMLSMTPCLI_24bpp.bmp
   A /trunk/Development/Media/THTTPAPPSRV16_24bpp.bmp
   A /trunk/Development/Media/THTTPAPPSRV32_24bpp.bmp
   A /trunk/Development/Media/THTTPAPPSRV_24bpp.bmp
   A /trunk/Development/Media/THTTPCLI16_24bpp.bmp
   A /trunk/Development/Media/THTTPCLI32_24bpp.bmp
   A /trunk/Development/Media/THTTPCLI_24bpp.bmp
   A /trunk/Development/Media/THTTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/THTTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/THTTPSERVER_24bpp.bmp
   A /trunk/Development/Media/TICSBLACKLIST16_24bpp.bmp
   A /trunk/Development/Media/TICSBLACKLIST32_24bpp.bmp
   A /trunk/Development/Media/TICSBLACKLIST_24bpp.bmp
   A /trunk/Development/Media/TICSCHARSETCOMBOBOX16_24bpp.bmp
   A /trunk/Development/Media/TICSCHARSETCOMBOBOX32_24bpp.bmp
   A /trunk/Development/Media/TICSCHARSETCOMBOBOX_24bpp.bmp
   A /trunk/Development/Media/TICSCOOKIES16_24bpp.bmp
   A /trunk/Development/Media/TICSCOOKIES32_24bpp.bmp
   A /trunk/Development/Media/TICSCOOKIES_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPY16_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPY32_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPYW16_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPYW32_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPYW_24bpp.bmp
   A /trunk/Development/Media/TICSFILECOPY_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTI16_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTI32_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTIW16_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTIW32_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTIW_24bpp.bmp
   A /trunk/Development/Media/TICSFTPMULTI_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTI16_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTI32_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTIW16_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTIW32_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTIW_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPMULTI_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPPROXY16_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPPROXY32_24bpp.bmp
   A /trunk/Development/Media/TICSHTTPPROXY_24bpp.bmp
   A /trunk/Development/Media/TICSINETALIVE16_24bpp.bmp
   A /trunk/Development/Media/TICSINETALIVE32_24bpp.bmp
   A /trunk/Development/Media/TICSINETALIVE_24bpp.bmp
   A /trunk/Development/Media/TICSIPSTRMLOG16_24bpp.bmp
   A /trunk/Development/Media/TICSIPSTRMLOG32_24bpp.bmp
   A /trunk/Development/Media/TICSIPSTRMLOG_24bpp.bmp
   A /trunk/Development/Media/TICSLOGGER16_24bpp.bmp
   A /trunk/Development/Media/TICSLOGGER32_24bpp.bmp
   A /trunk/Development/Media/TICSLOGGER_24bpp.bmp
   A /trunk/Development/Media/TICSMAILQUEUE16_24bpp.bmp
   A /trunk/Development/Media/TICSMAILQUEUE32_24bpp.bmp
   A /trunk/Development/Media/TICSMAILQUEUE_24bpp.bmp
   A /trunk/Development/Media/TICSPROXY16_24bpp.bmp
   A /trunk/Development/Media/TICSPROXY32_24bpp.bmp
   A /trunk/Development/Media/TICSPROXY_24bpp.bmp
   A /trunk/Development/Media/TICSRESTEMAIL16_24bpp.bmp
   A /trunk/Development/Media/TICSRESTEMAIL32_24bpp.bmp
   A /trunk/Development/Media/TICSRESTEMAIL_24bpp.bmp
   A /trunk/Development/Media/TICSSMS16_24bpp.bmp
   A /trunk/Development/Media/TICSSMS32_24bpp.bmp
   A /trunk/Development/Media/TICSSMS_24bpp.bmp
   A /trunk/Development/Media/TICSTIMECLIENT_24bpp.bmp
   A /trunk/Development/Media/TICSTIMESERVER_24bpp.bmp
   A /trunk/Development/Media/TICSTWITTER16_24bpp.bmp
   A /trunk/Development/Media/TICSTWITTER32_24bpp.bmp
   A /trunk/Development/Media/TICSTWITTER_24bpp.bmp
   A /trunk/Development/Media/TICSWHOISCLI16_24bpp.bmp
   A /trunk/Development/Media/TICSWHOISCLI32_24bpp.bmp
   A /trunk/Development/Media/TICSWHOISCLI_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODE16_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODE32_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEEX16_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEEX32_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEEX_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEW16_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEW32_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODEW_24bpp.bmp
   A /trunk/Development/Media/TMIMEDECODE_24bpp.bmp
   A /trunk/Development/Media/TMIMETYPESLIST16_24bpp.bmp
   A /trunk/Development/Media/TMIMETYPESLIST32_24bpp.bmp
   A /trunk/Development/Media/TMIMETYPESLIST_24bpp.bmp
   A /trunk/Development/Media/TMULTIPARTFTPDOWNLOADER16_24bpp.bmp
   A /trunk/Development/Media/TMULTIPARTFTPDOWNLOADER32_24bpp.bmp
   A /trunk/Development/Media/TMULTIPARTFTPDOWNLOADER_24bpp.bmp
   A /trunk/Development/Media/TMULTIPARTHTTPDOWNLOADER_24bpp.bmp
   A /trunk/Development/Media/TMULTIPROGRESSBAR_24bpp.bmp
   A /trunk/Development/Media/TNNTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TNNTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TNNTPCLI_24bpp.bmp
   A /trunk/Development/Media/TPING16_24bpp.bmp
   A /trunk/Development/Media/TPING32_24bpp.bmp
   A /trunk/Development/Media/TPING_24bpp.bmp
   A /trunk/Development/Media/TPOP3CLI16_24bpp.bmp
   A /trunk/Development/Media/TPOP3CLI32_24bpp.bmp
   A /trunk/Development/Media/TPOP3CLI_24bpp.bmp
   A /trunk/Development/Media/TRESTOAUTH16_24bpp.bmp
   A /trunk/Development/Media/TRESTOAUTH32_24bpp.bmp
   A /trunk/Development/Media/TRESTOAUTH_24bpp.bmp
   A /trunk/Development/Media/TSIMPLEWEBSRV16_24bpp.bmp
   A /trunk/Development/Media/TSIMPLEWEBSRV32_24bpp.bmp
   A /trunk/Development/Media/TSIMPLEWEBSRV_24bpp.bmp
   A /trunk/Development/Media/TSMTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSMTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSMTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSMTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSMTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSMTPSERVER_24bpp.bmp
   A /trunk/Development/Media/TSNMPCLI_24bpp.bmp
   A /trunk/Development/Media/TSSLAVLSESSIONCACHE16_24bpp.bmp
   A /trunk/Development/Media/TSSLAVLSESSIONCACHE32_24bpp.bmp
   A /trunk/Development/Media/TSSLAVLSESSIONCACHE_24bpp.bmp
   A /trunk/Development/Media/TSSLCONTEXT16_24bpp.bmp
   A /trunk/Development/Media/TSSLCONTEXT32_24bpp.bmp
   A /trunk/Development/Media/TSSLCONTEXT_24bpp.bmp
   A /trunk/Development/Media/TSSLENGINE16_24bpp.bmp
   A /trunk/Development/Media/TSSLENGINE32_24bpp.bmp
   A /trunk/Development/Media/TSSLENGINE_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPCLIENT16_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPCLIENT32_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPCLIENT_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSSLFTPSERVER_24bpp.bmp
   A /trunk/Development/Media/TSSLHTMLSMTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSSLHTMLSMTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSSLHTMLSMTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPREST16_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPREST32_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPREST_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSSLHTTPSERVER_24bpp.bmp
   A /trunk/Development/Media/TSSLNNTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSSLNNTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSSLNNTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSSLPOP3CLI16_24bpp.bmp
   A /trunk/Development/Media/TSSLPOP3CLI32_24bpp.bmp
   A /trunk/Development/Media/TSSLPOP3CLI_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSSLSMTPSERVER_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKET16_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKET32_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETSERVER_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETTHRDSERVER16_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETTHRDSERVER32_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKETTHRDSERVER_24bpp.bmp
   A /trunk/Development/Media/TSSLWSOCKET_24bpp.bmp
   A /trunk/Development/Media/TSSLX509CERTS16_24bpp.bmp
   A /trunk/Development/Media/TSSLX509CERTS32_24bpp.bmp
   A /trunk/Development/Media/TSSLX509CERTS_24bpp.bmp
   A /trunk/Development/Media/TSYNCPOP3CLI16_24bpp.bmp
   A /trunk/Development/Media/TSYNCPOP3CLI32_24bpp.bmp
   A /trunk/Development/Media/TSYNCPOP3CLI_24bpp.bmp
   A /trunk/Development/Media/TSYNCSMTPCLI16_24bpp.bmp
   A /trunk/Development/Media/TSYNCSMTPCLI32_24bpp.bmp
   A /trunk/Development/Media/TSYNCSMTPCLI_24bpp.bmp
   A /trunk/Development/Media/TSYSLOGCLIENT_24bpp.bmp
   A /trunk/Development/Media/TSYSLOGSERVER_24bpp.bmp
   A /trunk/Development/Media/TTIMELIST_24bpp.bmp
   A /trunk/Development/Media/TTNCNX16_24bpp.bmp
   A /trunk/Development/Media/TTNCNX32_24bpp.bmp
   A /trunk/Development/Media/TTNCNX_24bpp.bmp
   A /trunk/Development/Media/TTNEMULVT16_24bpp.bmp
   A /trunk/Development/Media/TTNEMULVT32_24bpp.bmp
   A /trunk/Development/Media/TTNEMULVT_24bpp.bmp
   A /trunk/Development/Media/TTNSCRIPT16_24bpp.bmp
   A /trunk/Development/Media/TTNSCRIPT32_24bpp.bmp
   A /trunk/Development/Media/TTNSCRIPT_24bpp.bmp
   A /trunk/Development/Media/TWSOCKET16_24bpp.bmp
   D /trunk/Development/Media/TWSOCKET16_256.bmp
   A /trunk/Development/Media/TWSOCKET32_24bpp.bmp
   D /trunk/Development/Media/TWSOCKET32_256.bmp
   A /trunk/Development/Media/TWSOCKETSERVER16_24bpp.bmp
   A /trunk/Development/Media/TWSOCKETSERVER32_24bpp.bmp
   A /trunk/Development/Media/TWSOCKETSERVER_24bpp.bmp
   A /trunk/Development/Media/TWSOCKETTHRDSERVER16_24bpp.bmp
   A /trunk/Development/Media/TWSOCKETTHRDSERVER32_24bpp.bmp
   A /trunk/Development/Media/TWSOCKETTHRDSERVER_24bpp.bmp
   A /trunk/Development/Media/TWSOCKET_24bpp.bmp
   D /trunk/Development/Media/TWSOCKET_256.bmp
   D /trunk/Development/Media/Whois24.bmp
   D /trunk/Development/Media/certificate1_lock_closed-18x18.bmp
   D /trunk/Development/Media/certificate1_lock_closed-24x24.bmp
   D /trunk/Development/Media/certificate1_lock_closed-38x30.bmp
   D /trunk/Development/Media/certificate1_lock_closed.ico
   D /trunk/Development/Media/sntpclient.bmp
   D /trunk/Development/Media/sntpclient.ico
   D /trunk/Development/Media/twsocket16.bmp
   D /trunk/Development/Media/twsocket24.bmp
   D /trunk/Development/Media/twsocket32.bmp
   D /trunk/Development/Media/whoisall.ico
   M /trunk/Source/Include/OverbyteIcsDefs.inc
   M /trunk/Source/OverByteIcsMimeDec.dcr
   M /trunk/Source/OverbyteIcsBlacklist.dcr
   M /trunk/Source/OverbyteIcsCharsetComboBox.dcr
   M /trunk/Source/OverbyteIcsCookies.dcr
   M /trunk/Source/OverbyteIcsDnsQuery.dcr
   M /trunk/Source/OverbyteIcsEmulVT.dcr
   M /trunk/Source/OverbyteIcsFileCopy.dcr
   M /trunk/Source/OverbyteIcsFileCopyW.dcr
   M /trunk/Source/OverbyteIcsFingCli.dcr
   M /trunk/Source/OverbyteIcsFtpCli.dcr
   M /trunk/Source/OverbyteIcsFtpMulti.dcr
   M /trunk/Source/OverbyteIcsFtpMultiW.dcr
   M /trunk/Source/OverbyteIcsFtpSrv.dcr
   M /trunk/Source/OverbyteIcsHttpAppServer.dcr
   M /trunk/Source/OverbyteIcsHttpMulti.dcr
   M /trunk/Source/OverbyteIcsHttpMultiW.dcr
   M /trunk/Source/OverbyteIcsHttpProt.dcr
   M /trunk/Source/OverbyteIcsHttpSrv.dcr
   M /trunk/Source/OverbyteIcsIpStreamLog.dcr
   M /trunk/Source/OverbyteIcsLogger.dcr
   M /trunk/Source/OverbyteIcsMailQueue.dcr
   M /trunk/Source/OverbyteIcsMimeUtils.dcr
   M /trunk/Source/OverbyteIcsMultiProgressBar.dcr
   M /trunk/Source/OverbyteIcsMultipartFtpDownloader.dcr
   M /trunk/Source/OverbyteIcsMultipartHttpDownloader.dcr
   M /trunk/Source/OverbyteIcsNntpCli.dcr
   M /trunk/Source/OverbyteIcsPing.dcr
   M /trunk/Source/OverbyteIcsPop3Prot.dcr
   M /trunk/Source/OverbyteIcsProxy.dcr
   M /trunk/Source/OverbyteIcsSmtpProt.dcr
   M /trunk/Source/OverbyteIcsSmtpSrv.dcr
   M /trunk/Source/OverbyteIcsSnmpCli.dcr
   M /trunk/Source/OverbyteIcsSntp.dcr
   M /trunk/Source/OverbyteIcsSslHttpRest.dcr
   M /trunk/Source/OverbyteIcsSslSessionCache.dcr
   M /trunk/Source/OverbyteIcsSslX509Certs.dcr
   M /trunk/Source/OverbyteIcsSysLogClient.dcr
   M /trunk/Source/OverbyteIcsSysLogServer.dcr
   M /trunk/Source/OverbyteIcsTimeList.dcr
   M /trunk/Source/OverbyteIcsTnCnx.dcr
   M /trunk/Source/OverbyteIcsTnEmulVT.dcr
   M /trunk/Source/OverbyteIcsTnScript.dcr
   M /trunk/Source/OverbyteIcsWSocket.dcr
   M /trunk/Source/OverbyteIcsWSocketS.dcr
   M /trunk/Source/OverbyteIcsWSocketTS.dcr
   M /trunk/Source/OverbyteIcsWhoisCli.dcr

ICS V8.67 - Part 16

Updated all the component icons from 4-bit to 24-bit colour, changed the old transparency colour from magenta to light grey, so the icons display correctly in RAD Studio 11.0.  

François wrote a tool that recreated the original bitmap files from the DCRs, updated the colours, created new RC files and compiled new DCRs, which will allow simpler updating of icons in future. 

------------------------------------------------------------------------
r1529 | angus | 2021-09-16 12:59:03 +0100 (Thu, 16 Sep 2021) | 61 lines
Changed paths:
   M /trunk/Packages/IcsCommonCB110Run.cbproj
   M /trunk/Packages/IcsLinuxD110.dpk
   M /trunk/Packages/IcsLinuxD110.dproj
   M /trunk/Packages/OverbyteIcsD110Run.dpk
   M /trunk/Packages/OverbyteIcsD110Run.dproj
   M /trunk/Samples/Delphi/SocketDemos/SocketDemos.bpg
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsJwaWinCrypt.inc
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMimeUtils.pas
   M /trunk/Source/OverbyteIcsNtlmSsp.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsUrl.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.67 - Part 17

Hopefully the last commit for this version, will be released once all my own applications are rebuilt and tested. 

Full support for OpenSSL 3.0 replacing most deprecated low level functions with modern replacements, couple still to be done. 

OverbyteIcsWSocket.pas
Sep 15, 2021 V8.67
Fail to open passworded private key, retry without password.
Added TX509Base.ComparePkey to compare supplied private key with ours. 

OverbyteIcsSslHttpRest.pas
Sep 07, 2021 - V8.67
Moved TRestParams to OverbyteIcsUrl to ease circular referencing and reduce size of this unit.
TIcsInetAlive better error for ping hops exceeded, and change default from 16 to 25.
Replaced Stream.Seek with Stream.Position.

OverbyteIcsMimeUtils.pas
Sep 16, 2021 V8.67 
Replaced soFromCurrent with soCurrent.
Moved Base64Encode/Base64Decode to OverbyteIcsUtils.pas since they have wider usage than MIME, and to ease circular referencing.

OverbyteIcsUrl.pas
Sep 06, 2021 V8.67 
Moved TRestParama here from OverbyteIcsSslHttpRest to ease circular references.
RestParams has a new method AddItemNULL to add a null, in Json this will be unquoted.
Added TRestParamsSrv component which provides methods for creating REST server Json responses from a SQL database resultset, one or more rows, also error responses. Note this is only compiled if DATABASE is defined in OverbyteIcsDefs.inc to avoid bringing in database units that are not available on all Delphi editions.  There is a REST server sample OverbyteIcsDDWebService.dpr that illustrates SQL lookups.

OverbyteIcsUtils.pas
Sep 06, 2021 V8.67 A
Moved Base64Encode/Base64Decode here from OverbyteIcsMimeUtils.
Moved IcsBase64UrlDecode, IcsBase64UrlEncode/A and IcsJsonPair here from OverbyteIcsSslJose to ease circular referencing.

OverbyteIcsSSLEAY.pas
OverbyteIcsLIBEAY.pas
Sep 15, 2021 V8.67 
Added PrivKeyECsecp256k private key alternate to PrivKeyECsecp256.
Added NID_secp256r1=NID_X9_62_prime256v1 to avoid confusion between two similar name, the latter is used in OpenSSL, the former for display.                 
                   
OverbyteIcsNtlmSsp.pas
Sep 06, 2021 V8.67 
Added Utils for base64.

OverbyteIcsSslJose.pas
Sept 16, 2021 V8.67
Support longer RSA keys.
Moved IcsBase64UrlDecode, IcsBase64UrlEncode, IcsBase64UrlEncodeA and IcsJsonPair to Utils to ease circular referencing.
Using TRestParam to build Json instead of strings and IcsJsonPair, can not use ISuperObject due to it not writing out Json in order specified on entry which is needed for JWS.
OpenSSL 3.0 deprecates low level RSA/EC function and provides EVP_PKEY alternatives using OSSL_PKEY_PARAM_xx, so rewritten IcsJoseJWKPubKey and IcsJoseJWKGetPKey using different functions for 1.1.1 and 3.0. Not quite finished, IcsJoseJWKGetPKey still uses old APIs for EC keys since new ones don't work yet. 

OverbyteIcsSslX509Utils.pas
Sep 09, 2021  V8.67 
Create private key pair with PrivKeyECsecp256k kobitz curve.
Added TSslCertTools GetKeyParams get specified key parameters for OpenSSL 3.0 and later.

Removed sample OverbyteIcsSrvDemo.dpr from SocketDemos group because it need TTable and no long builds with recent compilers. 

Fixed some Delphi 11.0 packages to remove OverbyteIcsLibeayEx which was deleted a while ago.  



------------------------------------------------------------------------
r1530 | angus | 2021-09-16 17:47:54 +0100 (Thu, 16 Sep 2021) | 7 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   A /trunk/Samples/Delphi/SslInternet/win64-dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsDDWebService.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsHttpRestTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsHttpsTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsIpStmLogTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsJoseTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsMailQuTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsMsVerify.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsPemTool.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsProxySslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSimpleSslCli.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSimpleSslServer.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslFtpServ.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslFtpTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslMailRcv.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslMailSnd.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslMultiFtpServ.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslMultiWebServ.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslNewsRdr.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslSmtpServer.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslSniSrv.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslWebAppServer.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsSslWebServ.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsX509CertsTst.dproj
   A /trunk/Samples/Delphi/SslInternet/win64-dproj/OverbyteIcsXferTst.dproj

ICS V8.67 - Part 18

Minor fix in PemTool sample. 

Added Samples/Delphi/SslInternet/win64-dproj containing duplicate project files defaulting to build with Windows 64-bit platform, should all be copied into the SslInternet directory.  Can not default to Win64 because earlier versions did not support it.  Note these were built with Delphi 11.0 so may give errors with earlier compilers.  


------------------------------------------------------------------------
r1531 | angus | 2021-09-17 08:16:52 +0100 (Fri, 17 Sep 2021) | 3 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.67 - Part 19

Added RAD Studio 11.0 packages to the distribution zip file. 
------------------------------------------------------------------------
r1532 | angus | 2021-09-22 17:09:14 +0100 (Wed, 22 Sep 2021) | 34 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUrl.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.67 - Part 20

Finished the support for OpenSSL 3.0 Win32 in the Jose unit, unfortunately there appears to be an OpenSSL bug for Win64, still being investigated.  Also fixed yet another problem with PKCS12/PFX certificate files not being able to be opened.  


OverbyteIcsSslJose.pas
OpenSSL 3.0 deprecates low level RSA/EC function and provides EVP_PKEY alternatives using OSSL_PKEY_PARAM_xx, so rewritten    IcsJoseJWKPubKey and IcsJoseJWKGetPKey using different functions for 1.1.1 and 3.0.
Use AnsiStrings and functions when dealing with binary data to avoid possible issues with string conversions and nulls.
Note - IcsJoseJWKPubKey currently fails on OpenSSL 3.0 Win64. 


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Sep 22, 2021 V8.67 
Added various helpers for OpenSSL 3.0 EVP parameters used by Jose unit. 


OverbyteIcsSslX509Certs.pas
Sep 22, 2021 - V8.67
Check new certificate bundles can actually be opened.  


OverbyteIcsUtils.pas
Sep 22, 2021 V8.67 
IcsBase64UrlEncodeA avoid string conversions should be used for encoding binary fields with nulls.
Added IcsBase64UrlDecodeA avoid string conversions should be used for decoding binary fields with nulls.


OverbyteIcsWSocket.pas
Sep 22, 2021 V8.67
Added TX509Base.ComparePkey to compare supplied private key with ours. 
Fixed PKCS12 certificates with 3DES sometimes failing to open.  


------------------------------------------------------------------------
r1533 | angus | 2021-09-27 11:55:42 +0100 (Mon, 27 Sep 2021) | 26 lines
Changed paths:
   M /trunk/ReadMe8.txt
   A /trunk/Samples/Delphi/OtherDemos/OtherDemos64.groupproj
   A /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverByteIcsDnsResolver64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsDnsResolver64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsNsLookup64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsTimeTst64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWhoisCliTst64.res
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst64.dof
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst64.dpr
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst64.dproj
   A /trunk/Samples/Delphi/OtherDemos/OverbyteIcsWmiTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst64.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsMsVerify64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslCli64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSimpleSslServer64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslNewsRdr64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSmtpServer64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslSniSrv64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebAppServer64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ64.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst64.res
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst64.res
   A /trunk/Samples/Delphi/SslInternet/SslDemos64.groupproj
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.67 - Part 21

Fixed the final Win64 issues with OpenSSL 3.0.  

Added two new sample project groups, OtherDemos64 and SslDemos64 which include Win64 versions of all the main active samples with 64 added to the project name, so they can be regularly built alongside the Win32 versions without changing platforms and overwriting executables.  


OverbyteIcsLIBEAY.pas
Sep 24, 2021 V8.67 
Added various helpers for OpenSSL 3.0 EVP parameters used by Jose unit.
Added IcsPkeyParamsGetAll which reports all EVP parameter names and values for a specific private key, for diagnostic purposes.


OverbyteIcsSslJose.pas
Sep 24, 2021 V8.67 
Fixed memory leaks and bad initialisations. 


Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
Sep 24 2021 V8.67 
Log OpenSSL version, support OpenSSL 3.0.
Replaced EVP_PKEY_cmp with TX509Base method.
Added PKey Parameters button to show private key parameters using new OpenSSL 3.0 APIs.


------------------------------------------------------------------------
r1534 | angus | 2021-09-27 15:33:09 +0100 (Mon, 27 Sep 2021) | 3 lines
Changed paths:
   M /trunk/Source/OverbyteIcsLIBEAY.pas

ICS V8.67 - Part 22

Two OpenSSL functions not documented as new, are new to 3.0.  
------------------------------------------------------------------------
r1535 | angus | 2021-09-27 18:55:15 +0100 (Mon, 27 Sep 2021) | 6 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.67 - Part 23

ICS builds with the static YuOpenSSL 1.1.1 again.  YuOpenSSL does not yet offer OpenSSL 3.0, and ICS will have difficulty working with static 1.1.1 and 3.0 together, much messier than conditional DLLs. 

Also two more OpenSSL exports. 

------------------------------------------------------------------------
r1536 | angus | 2021-09-28 15:05:48 +0100 (Tue, 28 Sep 2021) | 3 lines
Changed paths:
   D /trunk/Samples/Delphi/SslInternet/win64-dproj

ICS V8.67 - Part 24

Removed duplicate sample Win64 project files, now replaced by versions with 64 added to the file name.
------------------------------------------------------------------------
r1537 | angus | 2021-09-30 12:54:00 +0100 (Thu, 30 Sep 2021) | 3 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsSslX509Utils.pas

ICS V8.67 - Part 25

Removed the expired root certificate DST Root CA X3 to try and avoid chain verification errors with Let's Encrypt, but results seem variable, OpenSSL may report certificate not found rather than using the alternate chain.  
------------------------------------------------------------------------
r1538 | angus | 2021-10-07 18:28:50 +0100 (Thu, 07 Oct 2021) | 28 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsJoseTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.68 - Part 1

Added support for the YuOpenSSL OpenSSL 3.0.0 DCU, still supports the 1.1.1 DCU.  Still loads providers like legacy.dll as DLLs, not DCU.  

Following the expiry of the 'DST Root CA X3' root certificate used by Let's Encrypt, removed the root from ICS, also by default remove an intermediate using the expired root for new Let's Encrypt orders to avoid warnings from SSLLabs about expired certificates, it is only needed for some old Androids. 


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
OverbyteIcsSslJose.pas
OverbyteIcsWSocket.pas
Oct 07, 2021 V8.68 
Support OpenSSL 3.0 for YuOpenSSL.
Corrected TPKCS7_st for 3.0.   


OverbyteIcsSslX509Certs.pas
Oct 07, 2021 - V8.68
Added property KeepOldCA set true to keep LA intermediate for expired DST Root CA X3 root in bundles (for old Androids). Keeping it may prevent some clients verifying the chain and SslLabs testing gives a chain warning.

OverbyteIcsSslX509Utils.pas
Oct 06, 2021 V8.68 
Removed DST Root CA X3 certificate which expired 30 Sept 2021. Support OpenSSL 3.0 for YuOpenSSL.

OverbyteIcsReg.pas
Now V8.68. 


------------------------------------------------------------------------
r1539 | angus | 2021-10-14 15:39:05 +0100 (Thu, 14 Oct 2021) | 25 lines
Changed paths:
   M /trunk/Packages/IcsCommonCB104Design.cbproj
   M /trunk/Packages/IcsCommonCB104Run.cbproj
   M /trunk/Packages/IcsCommonCB110Design.cbproj
   M /trunk/Packages/IcsCommonCB110Run.cbproj
   M /trunk/Packages/IcsFmxCB104Design.cbproj
   M /trunk/Packages/IcsFmxCB104Run.cbproj
   M /trunk/Packages/IcsFmxCB110Design.cbproj
   M /trunk/Packages/IcsFmxCB110Run.cbproj
   M /trunk/Packages/IcsFmxCB110Run.cpp
   M /trunk/Packages/IcsVclCB103Design.cbproj
   M /trunk/Packages/IcsVclCB104Design.cbproj
   M /trunk/Packages/IcsVclCB104Run.cbproj
   M /trunk/Packages/IcsVclCB110Design.cbproj
   M /trunk/Packages/IcsVclCB110Run.cbproj
   M /trunk/Packages/IcsVclCB110Run.cpp
   M /trunk/Packages/OverbyteIcsD110Run.dproj
   M /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpServ1.pas
   M /trunk/Samples/Delphi/FtpDemos/OverbyteIcsFtpTst1.pas
   M /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsBasNntp1.pas
   M /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSnd1.pas
   M /trunk/Samples/Delphi/MailNewsDemos/OverbyteIcsMailSndAsync1.pas
   M /trunk/Samples/Delphi/MiscDemos/OverbyteIcsMD5Test1.pas
   M /trunk/Samples/Delphi/MiscDemos/OverbyteIcsOneTimePassword1.pas
   M /trunk/Samples/Delphi/MiscDemos/OverbyteIcsWndControlTest1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsBatchDnsLookup1.pas
   M /trunk/Samples/Delphi/OtherDemos/OverbyteIcsPingTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/Ics.Fmx.DemoUtils.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsBatchDnsLookup1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsBatchDnsLookup1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsCliCertDlg.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsCliCertDlg.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsCliDemo1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsCliDemo1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsDllTst1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsDllTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpServ1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpTst1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsFtpTst2.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailRcv1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailRcv1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailRcv2.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailRcv2.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailSnd1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsMailSnd1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsTcpSrv1IPv6.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsTcpSrv1IPv6.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsThreadTimerDemo1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsThreadTimerDemo1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpLstn1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpLstn1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpSend1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsUdpSend1.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebAppServerMain.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebAppServerMain.pas
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebServ1.fmx
   M /trunk/Samples/Delphi/PlatformDemos/IcsWebServ1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsCli7.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConSrv1C.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsConSrv1S.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsRecv1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSender1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSocksTst1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSrvDemo2.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsSvcTcp1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTWSChat1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsUdpLstn1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslFtpTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpGet1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpPost1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsHttpTst1.pas
   M /trunk/Samples/Delphi/WebDemos/OverbyteIcsWebServ1.pas
   M /trunk/Source/OverbyteIcsCryptUiApi.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMLang.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWinCrypt.pas
   M /trunk/Source/OverbyteIcsWinnls.pas

ICS V8.68 - Part 2

Lots of files updated, but only minor changes.  

ICS should now build with C++ for RAD Studio 10.4 and 11.0, fixed packages and various Windows API related units, including for Win64. 

The Platform FMX samples now build with RAD Studio 11.0 where some FMX properties have changed, not sure if they'll still build with older versions.  

Building samples no longer needs the source search path to have \Include, this has been added to all the sample units that use OverbyteIcsDefs.inc.  


OverbyteIcsMailQueue.pas
11 Oct 2021 - V8.68
Build on Delphi 2010 again.


OverbyteIcsWSocket.pas
Oct 12, 2021 V8.68 
Support OpenSSL 3.0 for YuOpenSSL.
Updated Load/SaveP7BFile for OpenSSL 3.0.
Improved OpenSSL error handling to say 'No error returned' instead of error:00000000:lib(0):func(0):reason(0).
ValidateCertChain no longer reports an error for the expired 'DST Root CA X3' CA root, since some platforms accept expired roots.  



------------------------------------------------------------------------
r1540 | angus | 2021-11-05 18:52:49 +0000 (Fri, 05 Nov 2021) | 46 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.68 - Part 3

Mainly new trusted root certificate bundles, lots of changes from Microsoft since June, Google is now issuing it's own certificates.  

OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
Nov 05, 2021 - V8.68
Diagnostic log HTTP state changes.
Set Sync request timeout to 300 secs.


OverbyteIcsSslX509Utils.pas
Nov 05, 2021 V8.68 
Removed DST Root CA X3 certificate which expired 30 Sept 2021.
Support OpenSSL 3.0 for YuOpenSSL.
Updated sslRootCACertsBundle again, few gone, now total 59 certificates.


OverbyteIcsWSocket.pas
Nov 03, 2021 V8.68 
Support OpenSSL 3.0 for YuOpenSSL.
Updated Load/SaveP7BFile for OpenSSL 3.0.
Improved OpenSSL error handling to say 'No error returned' instead of error:00000000:lib(0):func(0):reason(0).
ValidateCertChain no longer reports an error for the expired 'DST Root CA X3' CA root, since some platforms accept expired roots.
Clear LastError in Listen and Connect methods to avoid false errors later.


Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
Samples/Delphi/BrowserDemo/TrustedCABundle.pem
Samples/Delphi/SslInternet/RootCaCertsBundle.pem
Samples/Delphi/SslInternet/TrustedCABundle.pem
See http://wiki.overbyte.eu/wiki/index.php/FAQ_ICS_SSL/TLS_CA_Trusted_Store_Contents 


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
Added logging of OpenSSL version on startup to ease debugging. 



------------------------------------------------------------------------
r1541 | angus | 2021-12-17 18:34:25 +0000 (Fri, 17 Dec 2021) | 10 lines
Changed paths:
   D /trunk/OpenSSL-Win32/LICENSE
   A /trunk/OpenSSL-Win32/LICENSE.txt
   A /trunk/OpenSSL-Win32/legacy.dll
   D /trunk/OpenSSL-Win32/libcrypto-1_1.dll
   A /trunk/OpenSSL-Win32/libcrypto-3.dll
   D /trunk/OpenSSL-Win32/libssl-1_1.dll
   A /trunk/OpenSSL-Win32/libssl-3.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/ReadMe8.txt
   A /trunk/Samples/Delphi/SslInternet/legacy-x64.dll
   A /trunk/Samples/Delphi/SslInternet/legacy.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   A /trunk/Samples/Delphi/SslInternet/libcrypto-3-x64.dll
   A /trunk/Samples/Delphi/SslInternet/libcrypto-3.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   A /trunk/Samples/Delphi/SslInternet/libssl-3-x64.dll
   A /trunk/Samples/Delphi/SslInternet/libssl-3.dll

ICS V8.68 - Part 4

Updated the main supported OpenSSL release to 3.0.1, now it's been available for three months.  The samples SslInternet directory now has both OpenSSL 1.1.1m and 3.0.1, ICS will try and load OpenSSL 3.0 first, then 1.1.1 if not found, unless the global
variable GSSLEAY_DLL_IgnoreNew is set true before OpenSSL is loaded. Likewise GSSLEAY_DLL_IgnoreOld may be set true to ignore 1.1.1 and fail unless 3.0 is available.

OpenSSL 3.0.1 fixes a medium security risk relating to clients verifying X509 certificates from the server, a malicious server could potentially send a bad certificate that caused the client to hang or misbehave during verify.   

3.0.1 and 1.1.1m contain three months of improvements and fixes.  

Separately YuOpenSSL has released both these versions as commercial DCUs allowing applications to be used with OpenSSL without needing separate DLLs.   
------------------------------------------------------------------------
r1542 | angus | 2021-12-21 12:37:58 +0000 (Tue, 21 Dec 2021) | 126 lines
Changed paths:
   M /trunk/Samples/Delphi/PlatformDemos/IcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFileCopyW.pas
   M /trunk/Source/OverbyteIcsFtpCli.pas
   M /trunk/Source/OverbyteIcsFtpCliW.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsLogger.pas
   M /trunk/Source/OverbyteIcsMultipartFtpDownloader.pas
   M /trunk/Source/OverbyteIcsMultipartHttpDownloader.pas
   M /trunk/Source/OverbyteIcsNntpCli.pas
   M /trunk/Source/OverbyteIcsPing.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWndControl.pas

ICS V8.68 - Part 5

This block of changes mostly relate to HTTP client improvements, specifically improved error reporting to help diagnose failed HTTP requests, and improvements in the HTTP REST component allowing it to save files including resuming failed downloads and download files of any size.  There also new headers supported by the HTTP client to assist with conditional requests.  

There is also a new demo in OverbyteIcsXferTst1, File Clean-Up tab to test the multiple DeleteFiles method, allows files older than x days or specific date range to be archived/zipped (to save space) or deleted, ideal for deleting the old log files that many applications (including some ICS samples) leave on systems. Note zipping needs VCLZip. 


OverbyteIcsWndControl.pas
Nov 27, 2021 V8.68 
BgException now passes exception to AbortComponent virtual handler and ExceptAbortProc method so higher level components can report errors better, such as out of memory without needing an BgException handler.  Note requires similar change to all units that override AbortComponent or use ExceptAbortProc.

OverbyteIcsWSocket.pas
Nov 27, 2021 V8.68 
Support OpenSSL 3.0 for YuOpenSSL.
Updated Load/SaveP7BFile for OpenSSL 3.0.
Improved OpenSSL error handling to say 'No error returned' instead of error:00000000:lib(0):func(0):reason(0).
ValidateCertChain no longer reports an error for the expired 'DST Root CA X3' CA root, since some platforms accept expired roots.
Clear LastError in Listen and Connect methods to avoid false errors later.
Improved source description for some fatal background errors.
AbortComponent has Exception argument so higher level components can report errors better, such as out of memory without needing BgException handler.


OverbyteIcsHttpProt.pas
Dec 20, 2021 V8.68 
Made RequestDoneError available as property so it can be accessed after Sync requests, added RequestDoneErrorStr property that returns a literal error.
Try to provide better RequestDoneError than simple abort, added httperrOutOfMemory and httperrBgException which happen while receiving and processing data in the OnDocData event and httperrSslHandShake.
Improved AbortComponent so ReasonPhrase now reports exception  that caused it, such as out of memory which previously needed a BgException event handler.
Keep Etag response header as ResponseEtag.
Added ContentIfRange request header only sent if content range specified, with an RFC1123 date or Etag.
Added ReqIfMatch and ReqIfNoneMatch request headers sent with one or more quoted Etag values.


OverbyteIcsSslHttpRest.pas
Dec 20, 2021 - V8.68
Improved request failed error reporting by adding RequestDoneErrorStr.
Previously this component always downloaded content to a TMemoryStream with content size being limited to MaxBodySize (default 100 MByte), and generally restricted by memory to less than 250 MByte.
Added HttpMemStrategy property with THttpMemStrategy on how to handle downloads: HttpStratMem only TMemoryStream; HttpStratTemp uses a work file in the system temporary directory for sizes larger than MaxBodySize; HttpStratFile always writes a named file HttpDownFileName (with .part extension during download); HttpStratResume is similar to HttpStratFile but supports resume of failed partial downloads (with .http extension for resume information). Property ResumeMinSize defines the minimum sized partial file that should be resumed, rather than start again (default 64K).
Note MaxBodySize remains the maximum size for ResponseRaw (unicode string), JSON and XML parsing.
BREAKING CHANGE, ResponseStream property is now TStream so use of SaveToFile method will need to be cast as TMemoryStream.  Or change to use HttpStratFile method with HttpDownFileName, see above.
NOTE, ResponseStream remains open after request completes and may occupy a lot of memory or leave file open (read only), also ResponseRaw string, so use ClearResp method when no longer needed.
Log better error if response does not contain Json.
Added ShowProgress property that causes download information to be sent to the OnHttpRestProg event using LogOption=loProgress, showing progress in KBytes of KBytes updated every ProgIntSecs seconds, default two, expected to be displayed as a caption.


OverbyteIcsSslX509Certs.pas
Dec 20, 2021 - V8.68
Added property KeepOldCA set true to keep LA intermediate for expired DST Root CA X3 root in bundles (for old Androids). Keeping it may prevent some clients verifying the chain and SslLabs testing gives a chain warning.
HttpRest now allows saving a file, so change Acme terms to do so. 


OverbyteIcsUtils.pas
Dec 13, 2021 V8.68 
Trying to keep C++ happy.
Moved IcsFileInUse and IcsTruncateFile here from OverbyteIcsCopy.


OverbyteIcsFileCopy.pas
OverbyteIcsFileCopyW.pas
21 Dec 2021 - V8.68
DeleteFiles now supports Zipped property so files are zipped with .zip extension before being deleted, useful for cleaning up old logs to save space (requires VCLZip). 
Moved IcsFileInUse and IcsTruncateFile to Utils.


OverbyteIcsFtpCli.pas
OverbyteIcsFtpCliW.pas
Nov 27, 2021 V8.68 
Using the PORT command to set Active mode, prevent other FTP clients sharing the same port/addr, usually with a small port pool.
Improved AbortComponent so ReasonPhrase now reports exception that caused it, such as out of memory which previously needed  a BgException event handler.


OverbyteIcsFtpMultiW.pas
Dec 02, 2021 - V8.68
BOOL to Boolean.


OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
Dec 01, 2021 - V8.68
Fixed problem that meant large files failed download with only an abort error if too large for TMemoryStream, now downloaded to TFileStream with .part extension and renamed up successful completion.
If a partial file downloads, don't delete it if KeepPartDown=True. 
Diagnostic log session closed.
Set Sync request timeout to 300 secs.
Report RequestDoneError on failure. 
Correctly download files using chunked coding without known size, note these show with size -1 since not known until complete.
Log BgException.


OverbyteIcsLogger.pas
Dec 16, 2021 V8.68 
Added LogOption loProgress


OverbyteIcsMultipartFtpDownloader.pas
OverbyteIcsMultipartHttpDownloader.pas
OverbyteIcsNntpCli.pas
OverbyteIcsPing.pas
OverbyteIcsPop3Prot.pas
OverbyteIcsSmtpProt.pas
Nov 27, 2021 V8.68 - BgException now passes exception to AbortComponent virtual handler.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Dec 20, 2021 - V8.68 
Log OpenSSL version and INI file location on startup.
TSslHttpRest can now handle content larger than MaxBodySize (default 100 MByte) including saving downloads as files, according to HttpMemStrategy.  HttpStratMem only TMemoryStream, HttpStratTemp uses a work file in the system temporary directory for sizes larger than MaxBodySize, HttpStratFile always writes a named file HttpDownFileName (with .part extn during download), HttpStratResume is similar to HttpStratFile but supports resume of failed partial downloads (with .http extn for resume information).
Note MaxBodySize remains the maximum size for ResponseRaw (unicode string), JSON and XML parsing.
Added a download progress display caption. 


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Dec 20, 2021 V8.68 
More control over which OpenSSL version is used, mainly for debugging.
RequestDone now reports literal error message instead of number.
Added LastEtag header, similar to LastModifiedDate for conditional requests.


Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
21 Dec 2021 - V8.68 
Log OpenSSL version on startup.
Improved error reporting for HTTP errors.
Added File Clean-Up tab to test the multiple DeleteFiles method, allow files older than x days or specific date range to be archived/zipped (to save space) or deleted, ideal for deleting the old log files that many applications (including some ICS samples) leave on systems. Note zipping needs VCLZip.  


------------------------------------------------------------------------
r1543 | angus | 2021-12-27 11:51:08 +0000 (Mon, 27 Dec 2021) | 3 lines
Changed paths:
   M /trunk/ReadMe8.txt

ICS V8.68 - Part 6

Correct readme8 for C++ project files which are cbproj and not dproj.  
------------------------------------------------------------------------
r1544 | francois | 2021-12-27 15:54:17 +0000 (Mon, 27 Dec 2021) | 1 line
Changed paths:
   M /trunk/Install/CB110InstallVclFmx.groupproj
   M /trunk/Packages/IcsCommonCB110Design.cbproj
   M /trunk/Packages/IcsCommonCB110Run.cbproj
   M /trunk/Packages/IcsFmxCB110Design.cbproj
   M /trunk/Packages/IcsFmxCB110Run.cbproj
   M /trunk/Packages/IcsVclCB110Design.cbproj
   M /trunk/Packages/IcsVclCB110Run.cbproj
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsMD5.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas

27/12/2021 F.Piette Updated CB110 projects to avoid all errors and warnings (TLib page size, Delphi plateform symbol warning). Updated Source code to avoid CB11 warnings (Replaced 3 DELPHI24_UP by COMPILER24_UP).
------------------------------------------------------------------------
r1545 | francois | 2021-12-28 13:27:30 +0000 (Tue, 28 Dec 2021) | 1 line
Changed paths:
   M /trunk/Packages/IcsCommonCB110Design.cbproj
   M /trunk/Packages/IcsCommonCB110Run.cbproj
   M /trunk/Packages/IcsFmxCB110Design.cbproj
   M /trunk/Packages/IcsFmxCB110Run.cbproj
   M /trunk/Packages/IcsVclCB110Design.cbproj
   M /trunk/Packages/IcsVclCB110Run.cbproj

FPiette 28/12/2021. Updated C++ Builder 11 packages (Those having CB110 in their name) so that the IDE accept to install it when using default C++ Builder options (Cleared "Final output directory" in "C++ Shared Options").
------------------------------------------------------------------------
r1546 | angus | 2021-12-29 15:31:59 +0000 (Wed, 29 Dec 2021) | 22 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Source/OverbyteIcsFileCopyW.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsMD5.pas
   M /trunk/Source/OverbyteIcsPop3Prot.pas
   M /trunk/Source/OverbyteIcsSmtpProt.pas

ICS V8.68 - Part 9

The last planned changes before the release of V8.68, please test it now!

Updated the ICS web server to add new request and response headers that assist clients and proxies in caching server content, specially Etag, If-Range, If-Match and If-None-Match, also added Date header that may also help.  All these headers are also supported by the latest versions of the ICS web clients and samples.  Applications that already add Etag or Date headers may need changing to avoid duplicates been sent.    


OverbyteIcsHttpSrv.pas
Dec 29, 2021 V8.68 
Support If-Range, If-Match and If-None-Match request headers for conditional pages using Etag or last modified date, send 304 not modified for matches.  Helps with caching.
 Add ETag header to responses in AnswerStream and AnswerPage when we can create one from a file modification date and size (base64 CRC32), or if the EntityTag property is specified in the onGetDocument event before using hgSendDoc or hgSendStream perhaps a CRC32 of the entire content from a cache.
304 not modified response includes more recommended headers.
Add Date: header to AnswerStream and AnswerPage.
DELPHI24_UP to COMPILER24_UP for C++.
WARNING - applications that add Date: or Etag: to CustomHeaders or to an AnswerStream should remove them since they are added automatically.

Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
Just dates so they reflect major changes to the components they test. 

------------------------------------------------------------------------
r1547 | angus | 2022-01-05 12:40:06 +0000 (Wed, 05 Jan 2022) | 15 lines
Changed paths:
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.68 - Part 10

Final update, will be released today. 

OverbyteIcsFtpMulti.pas
OverbyteIcsFtpMultiW.pas
Jan 04, 2022 - V8.68
Remove SSL session cache port so data session can use control session.


OverbyteIcsWSocket.pas
ReadMe8.txt
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Dates and copyright year updated. 
------------------------------------------------------------------------
r1548 | angus | 2022-01-05 15:17:02 +0000 (Wed, 05 Jan 2022) | 1 line
Changed paths:
   M /trunk/ZipOverbyteIcsV8.lst

Need to zip new OpenSSL 3.0 files. 
------------------------------------------------------------------------
r1549 | angus | 2022-02-04 12:10:00 +0000 (Fri, 04 Feb 2022) | 33 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.69 - Part 1

Minor stuff. 

OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Feb 03, 2022 V8.69
Fixed bug in V8.65 that meant Implicit SSL only worked when using IcsHosts so was not backward compatible with old apps.


OverbyteIcsSslHttpRest.pas
Feb 03, 2022 - V8.69 
Builds on MacOS again, added IOUtils for TPath.


OverbyteIcsSslX509Certs.pas
Feb 03, 2022 - V8.69
Builds on MacOS again, MsSslUtils is Windows only so don't attempt to install certificate into Windows store on Mac.


OverbyteIcsWSocket.pas
OverbyteIcsReg.pas
Feb 03, 2022 - V8.69
Just new version.  


Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
Samples/Delphi/BrowserDemo/TrustedCABundle.pem
Samples/Delphi/SslInternet/RootCaCertsBundle.pem
Samples/Delphi/SslInternet/TrustedCABundle.pem
February 2022 root bundle update. 


------------------------------------------------------------------------
r1550 | angus | 2022-03-16 15:27:14 +0000 (Wed, 16 Mar 2022) | 11 lines
Changed paths:
   M /trunk/OpenSSL-Win32/legacy.dll
   M /trunk/OpenSSL-Win32/libcrypto-3.dll
   M /trunk/OpenSSL-Win32/libssl-3.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/legacy-x64.dll
   M /trunk/Samples/Delphi/SslInternet/legacy.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-1_1.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3.dll

ICS V8.69 - Part 2

Updated OpenSSL releases to 3.0.2 and 1.1.1n.

OpenSSL 3.0.2 fixes a high security risk relating to specifically formed SSL/TLS certificates using elliptic curve public keys which can cause OpenSSL to enter an infinite loop and cause denial of service by freezing.  The attack can be caused by clients processing bad server certificates, or by servers that request bad client certificates, and many other cases where these bad certificates are processed,  The attack has not been seen in the wild, it was identified by Google.   

3.0.2 also allows PCKS12 private keys without a password to be opened.  

Separately YuOpenSSL has released both these versions as commercial DCUs
allowing applications to be used with OpenSSL without needing separate DLLs.

------------------------------------------------------------------------
r1551 | angus | 2022-03-25 17:01:17 +0000 (Fri, 25 Mar 2022) | 160 lines
Changed paths:
   M /trunk/Packages/IcsFmxD110Run.dpk
   M /trunk/Packages/IcsFmxD110Run.dproj
   M /trunk/Packages/IcsLinuxD110.dpk
   M /trunk/Packages/IcsLinuxD110.dproj
   M /trunk/Packages/IcsVclD110Run.dpk
   M /trunk/Packages/IcsVclD110Run.dproj
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   A /trunk/Samples/Delphi/SslInternet/InterCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   A /trunk/Source/Ics.Fmx.OverbyteIcsSslHttpOAuth.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   A /trunk/Source/OverbyteIcsSslHttpOAuth.dcr
   A /trunk/Source/OverbyteIcsSslHttpOAuth.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.dcr
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSuperObject.pas
   M /trunk/Source/OverbyteIcsSysLogServer.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.69 - Part 3

These changes add OCSP (Online Certificate Status Protocol) to ICS, which is used to check SSL/TLS certificates are
legitimately issued. OCSP replaces CRL (Certificate Revocation Lists) as the way to confirm SSL/TLS certificates are
legitimate and not revoked for security or other reasons.  The OCSP status of a certificate is found by contacting an
HTTP server at the certificate issuer (URL in the certificate). OCSP responses are cached to avoid repeated downloads,
and optionally saved to a file for reloading later or sharing with other applications, they generally have a seven day
refresh life, but ideally need to be checked more often.

To avoid delaying new connections while waiting for an HTTP response, OCSP is initially ignored and the now cached
response checked for the next connection to that host.  For efficiency, most SSL web servers staple the OCSP response to
the initial SSL/TLS handshake so the client does not need to download it using HTTP.  OCSP revocation checking is soft
fail due to uncertainties in the internet, the OCSP server may be offline or not accessible via firewalls or proxies.

OCSP is handled by a new TOcspHttp component (in OverbyteIcsSslHttpRest.pas) using new OpenSSL OCSP functions in TX509List.

For clients, OCSP checking is part of the certificate chain checking during the initial handshake, and will prevent a
connection if revoke checking is enabled.  Initially TOcspHttp has been added to the TSslHttpRest and TIcsIpStrmLog client
components where it is enabled by setting the existing Revocation property to true with certificate chain checking to PEM Bundle.
Shortly, OCSP will be added to email, FTP and other clients that already have a Revocation property (but now only effective with
Windows bundle checking).

For servers, OCSP is used before the server starts to check that none of the supplied SSL/TLS server certificates have been
revoked, if so the server will attempt to order new certificates (if enabled).  The OCSP response for the certificate is
then stapled to the initial SSL/TLS handshake (if status is requested) and sent to the client.  On 28th January 2022, Let's Encrypt revoked several million certificates with two day's notice, because some of them might have been issued using TLS/1 and not TLS/1.2, which caused a lot of manual certificate updating including with some ICS servers.  Implementing OCSP means revoked certificates will be renewed automatically.

The ICS sample OverbyteIcsPemtool also does OCSP checks when examining certificate files.  There is also a new Test Host Certificates tab that tests SSL/TLS handshake and certificates (using TIcsIpStrmLog) for a list of host names and  ports, building a list of host and intermediate certificates that may be further checked and saved as files or added to an intermediate bundle. This new tester should prove useful for debugging sites that return SSL or certificate errors.

ICS adds a new file InterCaCertsBundle.pem that initially includes 28 intermediate certificates built by OverbyteIcsPemtool, which
is used by that tool when checking single certificate files.  In the longer term, it will be used by ICS where servers fail to
send an intermediate due to misconfiguration.  The industry would like to stop sending intermediate certificates with every new
SSL connection to improve efficiency, if not cached they can be download as required (TOcspHttp has a method to download
intermediates), so this may be necessary in ICS sooner or later.

There is a new source unit OverbyteIcsSslHttpOAuth.pas, currently this has only been added to the packages for Delphi 2007 and 11.0, and will need manually adding for other versions, until all the other packages can be updated (which is tedious).


OverbyteIcsWSocket.pas
Mar 25, 2022 V8.69
Restored TlsExtension_cb callback for client debugging, ClientHelloCallback only works with servers.
Added TX509Base.UrlOcsp and TX509Base.UrlIssuer properties to parse the certificate authority extension and get useful URLs.
Added TX509List.FindSubject and TX509List.IndexOfSubj to find certificate by SubjectOneLine, to find issuer certificate in bundle.
Added TX509List.SaveToStack which saves all the list certificates to a Stack to pass to OpenSSL functions.
Added TX509List.SetX509Store which sets the property X509Store with all the list certificates for use with OpenSSL chain verification functions.
Added OCSP (Online Certificate Status Protocol) support to TX509List to create requests and process responses, used to check certificates are legitimately issued and not revoked (instead of Certificate Revocation Lists).  OCSP uses HTTP POST requests, but these are handled using the TOcspHttp component in the OverbyteIcsSslHttpRest unit.
BuildOCSPCertId builds a CertId for the certificate and intermediate in the list, BuildOCSPReq builds an OCSP request for the CertId, CheckOCSPResp checks the OCSP response against a CertId and verifies it against X509Store setting various properties, OcspRespStatus, OcspRespStatusStr, OcspCertStatus, OcspCertStatusStr, OcspCertReason, OcspCertReasonStr, OcspRevokeDT, OcspUpdateDT and OcspNextUpdDT, with the full diagnostic request and response being returned as strings by OCSPReqInfo and OCSPRespInfo.  Applications should use TOcspHttp.CheckOcspRevoked instead of these TX509List functions.
Added OCSP Stapling TSslContext.SslOcspStatus=True, which for clients causes the remote server to send an OCSP response as part of the initial handshake to avoid contacting an OCSP HTTP server directly.  For servers, we get the OCSP response using HTTP and send it as part of the handshake, in TSslWSocketServer.  TSslContext.GetX509Store returns an X509STORE with all the context certificates for use with OpenSSL chain verification functions. TSslWSocket.OcspStapleRaw returns the OCSP response from the client handshake which can be passed to TOcspHttp.CheckOcspRevoked for checking, or for servers can be set with the response to be sent back to clients. For clients, OcspStapleStatus is set to response status (before certificate checking).


OverbyteIcsSslHttpOAuth.pas
Mar 24, 2022 - V8.69
baseline, split from OverbyteIcsSslHttpRest.pas unit, moved TRestOAuth, TSimpleWebSrv, TIcsTwitter and TIcsRestEmail components here to ease maintenance and use.


OverbyteIcsIpStreamLog.pas
Mar 22, 2022 - V8.69
Previously the LogSslRevocation property was only effective when checking the windows certificate store, now it also works with bundle files using the TOcspHttp component and OCSP stapling if available.
RetryAttempts -1 means no retry attempts, 0 mean try for ever.
After failure to connect, change state to Stopping, then None since it never really started.


OverbyteIcsSslHttpRest.pas
Mar 25, 2022 - V8.69
Builds on MacOS again, added IOUtils for TPath.
Split TRestOAuth, TSimpleWebSrv, TIcsTwitter and TIcsRestEmailcomponents to new unit OverbyteIcsSslHttpOAuth, to ease maintenance and use.
Added new TOcspHttp component to support OCSP (Online Certificate Status Protocol) that replaces CRL (Certificate Revocation Lists) as the way to confirm SSL/TLS certificates are legitimate and not revoked for security reasons.  The component will check an OCSP stapled response sent by a server during an SSL/TLS handshake or use HTTP to contact the certificate issuer's OCSP server directly to get OCSP status.  OCSP responses are cached and optionally saved to a file for reloading later or sharing with other applications, they generally have a seven day refresh life, but ideally need to be checked more often. TOcspHttp can also download the issuer or intermediate certificate if missing.
The TOcspHttp component properties are exposed in TSslHttpRest and TIcsIpStrmLog (FTP and mail clients to follow) but are only effective if SslRevocation is set with verify method CertVerBundle. CacheFName is the optional file name to save the cache, OcspCache.recs in the samples which is flushed to disk after CacheFlushMins, including stapled responses if CacheStapled=True.  OcspStapleOnly=True means only used stapled responses and don't make HTTP requests, OcspMaxDays is expiry of a status response,  CacheRefrDays is how often to refresh responses since certificates may be revoked with only a couple of days notice in serious cases (Let's Encrypt on 28 Jan 2022).  OcspHttpProxy allows a proxy URL to be specified.  There are two main responses from the OCSP server, OcspRespStatus is whether the OCSP returned information about the certificate and OcspCertStatus is that result. TSslHttpRest.TransferSslHandshakeDone shows how TOcspHttp is used to check the handshake certificates, just a few lines of code.
Note revocation checking is soft fail due to uncertainties in the internet, the OCSP server may be offline or not accessible via firewalls or proxies.  During an SSL/TLS handshake, if TOcspHttp needs to make an HTTP request this is done asynchronously to avoid delaying the handshake with the response cached ready for the next request. If checking certificates off-line (for servers for instance) the component will synchronously check OCSP waiting for a response (if a non-zero timeout is specified).
Previously the TSslHttpRest SslRevocation property was only effective when checking the windows certificate store, now it also works with bundle files using the TOcspHttp component and OCSP stapling if available.


OverbyteIcsWSocketS.pas
Mar 24, 2022 V8.69
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp component to confirm server SSL/TLS certificates are legitimate and not revoked for security reasons (which (Let's Encrypt did with two days notice on 28 Jan 2022).  The certificate OCSP response is also stapled to the initial SSL/TLS HELO handshake and sent to the client to avoid it needing to lookup OCSP using HTTP itself. OCSP responses are cached and saved to a file for reloading later, but are refreshed every time the certificate is validated, at least once a day. The server property OcspSrvStapling=True enables OCSP checks and stapling only with AUTO_X509_CERTS define since it adds extra HTTP client code. A revoked certificate will be auto ordered.  OCSP checking is done in LoadOneCert and the stapled response sent in TriggerSslServerName when checking SNI.


OverbyteIcsSslJose.pas
Mar 03, 2022 V8.69
Turn off deprecated warnings for YuOpenSSL 3.0 due to use of old EC_KEY_ and RSA_ functions for OpenSSL 1.1.1 that can not be removed until we cease support for 1.1.1.


OverbyteIcsLIBEAY.pas
OverbyteIcsSSLEAY.pas
Mar 25, 2022 V8.69
Added lots of OCSP types to check certificates.
Added several xx_tlsext_status_xx macros for OCSP stapling.
Changed sslCliSecDefault to sslCliSecTls12 for 1.2 or better.


OverbyteIcsHttpAppServer.pas
OverbyteIcsHttpSrv.pas
Mar 25, 2022 V8.69
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp component to confirm server SSL/TLS certificates are legitimate and not revoked for security reasons (which (Let's Encrypt did with two days notice on 28 Jan 2022).  The certificate OSCP response is also stapled to the initial SSL/TLS HELO handshake and sent to the client to avoid it needing to lookup OCSP using HTTP itself. OCSP responses are cached and saved to a file for reloading later, but are refreshed every time the certificate is validated, at least once a day. The server property OcspSrvStapling=True enables OCSP checks and stapling only with AUTO_X509_CERTS define since it adds extra HTTP client code. A revoked certificate will be auto ordered.


OverbyteIcsMailQueue.pas
21 Feb 2022 - V8.69
Builds on Posix again.


OverbyteIcsSslX509Certs.pas
Mar 23, 2022 - V8.69
Builds on MacOS again, MsSslUtils is Windows only so don't attempt to install certificate into Windows store on Mac.
Added unit OverbyteIcsSslHttpOAuth for stuff previously in HttpRest.


OverbyteIcsSuperObject.pas
March 2, 2022 - V8.69
Added comments about samples and units using SuperObject.


OverbyteIcsSysLogServer.pas
Feb 17, 2022 V8.69
Allow / in syslog messages.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
24 Mar 2022 V8.69
Added authentication using POST requests.
Fixed web logging to log correct multiple listener.
Added OCSP Stapling and certification revoke support, needs OcspSrvStapling=True adding to INI file.  Caches OCSP responses in file specified in INI OcspCacheFile, defaulting to ocspservercache.recs in application directory.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Mar 25, 2023 - V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Added OverbyteIcsSslHttpOAuth split from OverbyteIcsSslHttpRest with TRestOAuth, TSimpleWebSrv, TIcsTwitter and TIcsRestEmailcomponents.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Mar 25, 2022 V8.69
Added new Intermediate CA Certificate bundle file InterCaCertsBundle.pem supplied in the application directory but can be specified as being elsewhere.  At the moment, this is primarily used for OCSP testing of standalone certificates (without a bundle) but can potentially be used to verify certificate chains from servers that don't send the intermediate.  There are new buttons to list the bundle and to add certificates to the bundle.
Display Authority Info OCSP and Issuer URLs separately.
Added Check OCSP Revoke tick box when displaying certificates that checks the certificate OCSP server using HTTP to ensure it is not revoked or invalid.  Note OCSP will download missing intermediate certificates from the issuer's server using HTTP.
Added Test Host Certificates tab that tests SSL/TLS handshake and certificates (using TIcsIpStrmLog) for a list of host names and ports, building a list of host and intermediate certificates that  may be further checked and saved as files or added to the intermediate bundle.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
15 Mar 2022 - V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.


Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMailRcv1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
25 Mar 2022 - V8.69 - Added unit OverbyteIcsSslHttpOAuth for TIcsRestEmail previously in HttpRest.




------------------------------------------------------------------------
r1552 | angus | 2022-04-05 18:26:30 +0100 (Tue, 05 Apr 2022) | 51 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/InterCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsMsSslUtils.pas
   M /trunk/Source/OverbyteIcsSSLEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsSysLogServer.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.69 - Part 4

These changes mostly relate to the new OCSP revocation checking, actually revoked two public certificates to test how ICS behaved, and some units needed fixing.  

OverbyteIcsWSocket.pas
Apr 05, 2022 V8.69 
Default SSL context option 'legacy server connect' needed for servers that don't support secure renegotiation (but which are a security risk).
OCSP fixes. 


OverbyteIcsWSocketS.pas
OverbyteIcsIpStreamLog.pas
OverbyteIcsSslHttpRest.pas
Apr 05, 2022 V8.69 
OCSP fixes. 


OverbyteIcsSslX509Certs.pas
Apr 05, 2022 - V8.69
When revoking certificate, look for bundle file if single file missing.


OverbyteIcsMsSslUtils.pas
Apr 05, 2022 V8.69 
Added MsKeyProvider types and constants for use with TPM and Smartkey providers.


OverbyteIcsSysLogServer.pas
Apr 1, 2022 V8.69 
Allow / in syslog messages.
Fixed a range check error in UdpDataAvailable with 0 to read.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Apr 05, 2023 V8.69 
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Fixed memory leak not freeing OpenSSL.


Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
Apr 05, 2022 V8.69
When searching directory for certificates, ignore Unicode file names on non-unicode compilers.  


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Fixed memory leak not freeing OpenSSL.


------------------------------------------------------------------------
r1553 | angus | 2022-04-14 19:45:29 +0100 (Thu, 14 Apr 2022) | 131 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFtpMulti.pas
   M /trunk/Source/OverbyteIcsFtpMultiW.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsFtpSrvW.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsHttpCCodZLib.pas
   M /trunk/Source/OverbyteIcsHttpMulti.pas
   M /trunk/Source/OverbyteIcsHttpMultiW.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsJwaWinCrypt.inc
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslX509Utils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas
   M /trunk/Source/OverbyteIcsZLibObj.pas
   M /trunk/Source/OverbyteIcsZlibHigh.pas
   A /trunk/Source/zobj1212
   A /trunk/Source/zobj1212/adler32.obj
   A /trunk/Source/zobj1212/compress.obj
   A /trunk/Source/zobj1212/crc32.obj
   A /trunk/Source/zobj1212/deflate.obj
   A /trunk/Source/zobj1212/infback.obj
   A /trunk/Source/zobj1212/inffast.obj
   A /trunk/Source/zobj1212/inflate.obj
   A /trunk/Source/zobj1212/inftrees.obj
   A /trunk/Source/zobj1212/trees.obj
   A /trunk/Source/zobj1212/uncompr.obj
   A /trunk/Source/zobj1212/win64
   A /trunk/Source/zobj1212/win64/adler32.obj
   A /trunk/Source/zobj1212/win64/compress.obj
   A /trunk/Source/zobj1212/win64/crc32.obj
   A /trunk/Source/zobj1212/win64/deflate.obj
   A /trunk/Source/zobj1212/win64/infback.obj
   A /trunk/Source/zobj1212/win64/inffast.obj
   A /trunk/Source/zobj1212/win64/inflate.obj
   A /trunk/Source/zobj1212/win64/inftrees.obj
   A /trunk/Source/zobj1212/win64/trees.obj
   A /trunk/Source/zobj1212/win64/uncompr.obj
   A /trunk/Source/zobj1212/win64/zutil.obj
   A /trunk/Source/zobj1212/zutil.obj

ICS V8.69 - Part 4

These changes mostly relate to the new OCSP revocation checking, adding OCSP to all the high level components that verify the certificate chain, including HTTP, FTP and SMTP mail, HTTP and FTP servers, and the proxy component.

If you want to add OCSP to existing HTTP client or server applications, look at the OverbyteIcsHttpsTst and OverbyteIcsSslWebServ samples respectively, although the OverbyteIcsHttpRestTst and OverbyteIcsSslMultiWebServ are the starting point for new applications.

OverbyteIcsHttpsTst has also been improved adding test features previously only in the non-SSL version, GZIP compression, persistent cookies and POST data and files.



OverbyteIcsWSocket.pas
Apr 12, 2022 V8.69
Default SSL context option 'legacy server connect' needed for servers that don't support secure renegotiation (but which are a security risk).
OCSP fixes.


OverbyteIcsWSocketS.pas
OCSP fixes.


OverbyteIcsSslHttpRest.pas
Apr 14, 2022 V8.69
OCSP fixes.


OverbyteIcsIpStreamLog.pas
OverbyteIcsFtpMulti.pas
OverbyteIcsFtpMultiW.pas
OverbyteIcsHttpMulti.pas
OverbyteIcsHttpMultiW.pas
OverbyteIcsMailQueue.pas
Apr 14, 2022 - V8.69
Previously the FtpSslRevocation property was only effective when checking the windows certificate store, now it also works with bundle files using the TOcspHttp component and OCSP stapling if available.


OverbyteIcsFtpSrv.pas
OverbyteIcsFtpSrvW.pas
Apr 13, 2022 V8.69
Fixed bug in V8.65 that meant Implicit SSL only worked when using IcsHosts so was not backward compatible with old apps.
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp component to confirm server SSL/TLS certificates are legitimate and not revoked for security reasons (which (Let's Encrypt did with two days notice on 28 Jan 2022).  The certificate OSCP response is also stapled to the initial SSL/TLS HELO  handshake and sent to the client to avoid it needing to lookup OCSP using HTTP itself. OCSP responses are cached and saved to a file for reloading later, but are refreshed every time the certificate is validated, at least once a day. The server property OcspSrvStapling=True enables OCSP checks and stapling only with                        AUTO_X509_CERTS define since it adds extra HTTP client code. A revoked certificate will be auto ordered.


OverbyteIcsHttpAppServer.pas
Apr 11, 2022 V8.69
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp.
Read OcspSrvStapling property from INI file.


OverbyteIcsHttpProt.pas
Apr 11, 2022 V8.69
Added RequestAsync and RequestSync which start a specified request by parameter, useful to repeat the last request from an event (such as should be trust the cert and repeat).
When using a proxy, make sure Path is not blank which will break proxies, change to / as for non-proxy requests.


OverbyteIcsHttpSrv.pas
Apr 13, 2022 V8.69
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp  component to confirm server SSL/TLS certificates are legitimate and not revoked for security reasons (which (Let's Encrypt did with two days notice on 28 Jan 2022).  The certificate OSCP response is also stapled to the initial SSL/TLS HELO handshake and sent to the client to avoid it needing to lookup OCSP using HTTP itself. OCSP responses are cached and saved to a file for reloading later, but are refreshed every time the certificate is validated, at least once a day. The server property OcspSrvStapling=True enables OCSP checks and stapling only with
AUTO_X509_CERTS define since it adds extra HTTP client code. A revoked certificate will be auto ordered.
Don't set FWSocketServer.Name when creating component, not needed.


OverbyteIcsProxy.pas
Apr 14, 2022 V8.69
Forward Proxy, blank path not allowed in HTTP requests.
Support OCSP to check target certificate revocation when verifying handshake using certificate bundle if SslRevocation=True.
Support OCSP Stapling to check server SSL/TLS certificates are legitimate and not revoked for security reasons if OcspSrvStapling=True.


OverbyteIcsHttpCCodZLib.pas
OverbyteIcsZlibHigh.pas
OverbyteIcsZLibObj.pas
zobj1212/*obj
Apr 11, 2022 V8.69
Updated 1.2.5 to 1.2.12, sorry for long delay in updating zlib, now including some important bug fixes, although never saw any issues with the minimal use ICS makes of zlib (HTTP compression).
Added some new constants.
All zlib externals now cdecl.


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Apr 14, 2023 - V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Added OverbyteIcsSslHttpOAuth split from OverbyteIcsSslHttpRest with TRestOAuth, TSimpleWebSrv, TIcsTwitter and TIcsRestEmailcomponents.
Fixed memory leak not freeing OpenSSL.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
Apr 14, 2023 V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Fixed memory leak not freeing OpenSSL.
WMSslNotTrusted now restarts the correct last request.
Added Content Encoding Gzip tick box to support compression.
Added persistent cookie support.
Adding POST/PUT support to either send simple data or upload files in various ways (from OverbyteIcsHttpPost1 sample), may be tested against the ICS web server samples.


Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.dfm
Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
12 Apr 2022 V8.69 Added authentication using POST requests.
Added OCSP Stapling and certification revoke support, needs OcspSrvStapling=True adding to INI file.  Caches OCSP responses in file specified in INI  OcspCacheFile.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
12 Apr 2022 V8.69 Added authentication using POST requests.
Fixed web logging to log correct multiple listener.
Added OCSP Stapling and certification revoke support, needs OcspSrvStapling=True adding to INI file.  Caches OCSP responses in file specified in INI  OcspCacheFile, defaulting to ocspservercache.recs in application directory.


Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslWebServ1.pas
Apr 12, 2022 V8.69
Added OCSP (Online Certificate Status Protocol) support using the TOcspHttp component to confirm server SSL/TLS certificates are legitimate and not revoked for security reasons (which (Let's Encrypt did with two days notice on 28 Jan 2022).  The certificate OSCP response is also stapled to the initial SSL/TLS HELO handshake and sent to the client to avoid it needing to lookup OCSP using HTTP itself. OCSP responses are cached and saved to a file for reloading later.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
14 Apr 2022 - V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.



------------------------------------------------------------------------
r1554 | angus | 2022-04-14 19:50:44 +0100 (Thu, 14 Apr 2022) | 3 lines
Changed paths:
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.69 - Part 5

Zip new zlib libraries. 
------------------------------------------------------------------------
r1555 | francois | 2022-04-15 16:00:33 +0100 (Fri, 15 Apr 2022) | 1 line
Changed paths:
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv1.dfm
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv1.pas
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv2.dfm
   M /trunk/Samples/Delphi/SocketDemos/OverbyteIcsTnSrv2.pas

Updated the old sample TnSrv: Added IPv6, added echo selection and added dummy telnet option negociation.
------------------------------------------------------------------------
r1556 | angus | 2022-04-20 19:26:07 +0100 (Wed, 20 Apr 2022) | 24 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/InterCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.dpr
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsWSocket.pas

ICS V8.69 - Part 6

More OCSP fixes, memory leaks.  


OverbyteIcsHttpSrv.pas
19 Apr 2022 - V8.69
Convert FLastModified to UTC/GMT for headers.


OverbyteIcsLIBEAY.pas
OverbyteIcsSslHttpRest.pas
OverbyteIcsWSocket.pas
20 Apr 2022 - V8.69
OCSP fixes. 


Samples/Delphi/SslInternet/OverbyteIcsPemTool.dpr
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
20 Apr 2022 - V8.69
FormDestroy was never called.


------------------------------------------------------------------------
r1557 | angus | 2022-05-06 16:39:40 +0100 (Fri, 06 May 2022) | 7 lines
Changed paths:
   M /trunk/OpenSSL-Win32/legacy.dll
   M /trunk/OpenSSL-Win32/libcrypto-3.dll
   M /trunk/OpenSSL-Win32/libssl-3.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/legacy-x64.dll
   M /trunk/Samples/Delphi/SslInternet/legacy.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3.dll

Updated OpenSSL releases to 3.0.3 and 1.1.1o.

OpenSSL 3.0.3 fixes a moderate security risk relating to the OCSP_basic_verify but using an option ICS does not use, a low risk problem with an incorrect MAC key used in the RC4-MD5 cipher suite but which would never be used on modern connections, and a low risk problem with resource leakage when decoding certificates and keys and clients and servers configured to accept client certificate authentication, which might eventually run out of memory.  

Separately YuOpenSSL has released both these versions as commercial DCUs
allowing applications to be used with OpenSSL without needing separate DLLs.

------------------------------------------------------------------------
r1558 | angus | 2022-05-21 13:01:21 +0100 (Sat, 21 May 2022) | 167 lines
Changed paths:
   M /trunk/Packages/OverbyteIcsD110Run.dpk
   M /trunk/ReadMe8.txt
   M /trunk/Samples/Delphi/BrowserDemo/AuthUnit.dfm
   M /trunk/Samples/Delphi/BrowserDemo/AuthUnit.pas
   M /trunk/Samples/Delphi/BrowserDemo/DownLoadId.pas
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
   M /trunk/Samples/Delphi/BrowserDemo/FBUnitIcs.pas
   M /trunk/Samples/Delphi/BrowserDemo/HTMLAbt.pas
   M /trunk/Samples/Delphi/BrowserDemo/ProxyDlg.dfm
   M /trunk/Samples/Delphi/BrowserDemo/ProxyDlg.pas
   M /trunk/Samples/Delphi/BrowserDemo/UrlConIcs.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst.dpr
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsLogin.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsLogin.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebDataModule.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebMailer.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebUploads.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsWebSocketSrv1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsX509CertsTst1.pas
   A /trunk/Samples/Delphi/SslInternet/SslSpecials.groupproj
   M /trunk/Source/OverbyteIcsDigestAuth.pas
   M /trunk/Source/OverbyteIcsHttpProt.pas
   M /trunk/Source/OverbyteIcsHttpSrv.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsLIBEAY.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSslJose.pas
   M /trunk/Source/OverbyteIcsUtils.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWebSockets.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.69 - Part 8

These changes are primarily for HTTP client and server components, improving built-in authentication and continuing improving all the HTTP samples so they now hopefully test all the features of the HTTP server, specifically adding POST and PUT file uploading,  and a new client login window for interactive authentication with servers.  

There is a new project group SslSpecials.groupproj which includes the two samples that require extra components to be installed so are not in normal project groups, but which were often missed during routine compatibility testing.  


OverbyteIcsDigestAuth.pas
May 18, 2022 V8.69 
Rewritten to support SHA-256 hash algorithm as well as MD5 using OpenSSL digests, but only if USE_SSL configured otherwise historic MD5 hash functions are used.
AuthDigestGenerateChallenge has new optional Algorithm argument.
Nonce calculation now uses ASCII content and is always MD5 so it stays the same length, only server calculates it.
Note: Mozilla Firefox supports Digest SHA-256, Chrome and Edge do not.


OverbyteIcsHttpProt.pas
May 19, 2022 V8.69 
Added RequestAsync and RequestSync which start a specified request by parameter, useful to repeat the last request from an event (such as should be trust the cert and repeat).
When using a proxy, make sure Path is not blank which will break proxies, change to / as for non-proxy requests.
GetRequestDoneErrorStr handles wsocket errors.
NTLM authentication got broken in V8.61.
Added new THttpAuthType httpAuthDigest2 for Digest with SHA-256 algorithm instead of MD5 used by httpAuthDigest, only with USE_SSL.
Added new property WWWAuthInfos array filled after 401/407 failure by parsing AuthorizationRequest headers for AuthType and Realm that may be presented to select an authentication option, get login and repeat request.
Simplified PreparexxAuth functions by using WWWAuthInfos array instead of looping through AuthorizationRequest headers.
Remove # fragment anchor from URL unless Option httpoAllowAnchor is set.


OverbyteIcsHttpSrv.pas
May 18, 2022 V8.69 
Don't set FWSocketServer.Name when creating component, not needed.
Convert FLastModified to UTC/GMT for headers.
Added new authentication type atDigestSha2 with a SHA256 hash instead of MD5 with atDigest only supported with USE_SSL. Note: Mozilla Firefox supports Digest SHA-256, Chrome and Edge do not.
Added new client connection OnHttpRespHdr event to allow response headers to be logged, previously only request headers could be logged.  Cleaned up AnswerStream functions so separate lines don't go into send buffer.


OverbyteIcsIpStreamLog.pas
May 05, 2022 - V8.69  
RetryAttempts -1 means no retry attempts, 0 mean try for ever.
After failure to connect, change state to Stopping, then None since it never really started.  
Changed FSendBuffer to TBytes, use SendTB methods with TBytes. 


OverbyteIcsLIBEAY.pas
May 18, 2022 V8.69 
Added lots of OCSP literals and functions to check certificates.
Moved some common OpenSSL functions like LoadSsl from OverbyteIcsWSocket as IcsLoadSsl.
Moved hash digest functions here from OverbyteIcsSslJose.  


OverbyteIcsSslHttpRest.pas
May 20, 2022 - V8.69
Upon completion, ReasonPhrase now also has status, so OK becomes 200 OK, etc.
Allow POST/PUT a file specified in HttpUploadFile using HttpUploadStrat of HttpUploadSimple with parameters in the URL or HttpUploadMIME for multipart  with parameters in the first MIME part.


OverbyteIcsSslJose.pas
May 18, 2022 V8.69
Turn off deprecated warnings for YuOpenSSL 3.0 due to use of old EC_KEY_ and RSA_ functions for OpenSSL 1.1.1 that can not be  removed until we cease support for 1.1.1.
Removed WSocket from uses for projects that don't need it.
Moved hash digest functions to OverbyteIcsLIBEAY so they can be used with Json stuff.  


OverbyteIcsUtils.pas
May 04, 2022 V8.69 
Split IcsMoveStringToTBytes (no code page) into two versions, one for Unicode String, one for AnsiString.


OverbyteIcsWebSockets.pas
May 20, 2022 - V8.69
Builds again.


OverbyteIcsWSocket.pas
May 18, 2022 V8.69
Default SSL context option SslOpt2_LEGACY_SERVER_CONNECT needed for servers that don't support secure renegotiation (but which are a security risk).
Default sslOpt2_ALLOW_UNSAFE_LEGACY_RENEGOTIATION for clients to connect to such servers.
Added SendTB(const Data: TBytes; Len: Integer = -1) where Len is optional,  also similar SendToTB and SendToTB6 with TBytes.
Moved some common OpenSSL functions like LoadSsl to OverbyteIcsLIBEAY as  IcsLoadSsl so they can be used in projects without WSocket.

Samples/Delphi/BrowserDemo/AuthUnit.dfm
Samples/Delphi/BrowserDemo/AuthUnit.pas
Samples/Delphi/BrowserDemo/DownLoadId.pas
Samples/Delphi/BrowserDemo/FBUnitIcs.dfm
Samples/Delphi/BrowserDemo/FBUnitIcs.pas
Samples/Delphi/BrowserDemo/HTMLAbt.pas
Samples/Delphi/BrowserDemo/ProxyDlg.dfm
Samples/Delphi/BrowserDemo/ProxyDlg.pas
Samples/Delphi/BrowserDemo/UrlConIcs.pas
18 May 2022 V8.69  
Added OCSP support, using ProxyURL, specified root bundle file.
htmlview no longer builds with D2007 from March 2022, needs XE2 minimum for TBitmap.DrawTransparent
Improved authentication to allow a specific method to be selected where more than one.
Simplified authentication to use WWAuthInfos with multiple methods. 


Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebDataModule.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebMailer.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebUploads.pas
20 May 2022 -  V8.69
Added OverbyteIcsUrl so it builds again.
Added authentication using POST requests.
Added 'Password protected page (POST)' button on demo menu to test authentication using POST.
Fixed web logging to log correct multiple listener.
Added OCSP Stapling and certification revoke support, needs OcspSrvStapling=True adding to INI file.  Caches OCSP responses in file specified in INI OcspCacheFile, defaulting to ocspservercache.recs in application directory.
Added server options oAllowDelete, hoAllowTrace, hoAllowPatch to default INI file to support those verbs.
Builds on unicode compilers.
Added Digest SHA-256 authentication page DemoDigest2Auth.html and DemoDigestsAll.html that does both digests.  Note Mozilla   Firefox supports SHA-256 but Chrome and Edge do not.  
DemoAuthAll.html no longer does NTLM, use the separate page.
Need to define YuDISQL to link DISQLite3, pending support for Delphi databases.
Display server response headers if box ticked, only displayed request headers before.
File Upload Form and Email Form pages now work correctly.


Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
20 May 2022 V8.69 
Added authentication using POST requests.
Added 'Password protected page (POST)' button on demo menu to test authentication using POST.
Fixed web logging to log correct multiple listener.
Added OCSP Stapling and certification revoke support, needs OcspSrvStapling=True adding to INI file.  Caches OCSP responses
in file specified in INI OcspCacheFile, defaulting to ocspservercache.recs in application directory.
Added server options oAllowDelete, hoAllowTrace, hoAllowPatch to default INI file to support those verbs.
Added Digest SHA-256 authentication page DemoDigest2Auth.html  and DemoDigestsAll.html that does both digests.  Note Mozilla  Firefox supports SHA-256 but Chrome and Edge do not.
DemoAuthAll.html no longer does NTLM, use the separate page.
Display server response headers if box ticked, only displayed request headers before.
File Upload Form and Email Form pages now share data via WebDataModule since they are also linked into DDWebService.  


Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst2.pas
Samples/Delphi/SslInternet/OverbyteIcsLogin.dfm
Samples/Delphi/SslInternet/OverbyteIcsLogin.pas
May 20, 2023 - V8.69 
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Added OverbyteIcsSslHttpOAuth split from OverbyteIcsSslHttpRest with TRestOAuth, TSimpleWebSrv, TIcsTwitter and IcsRestEmailcomponents.
Fixed memory leak not freeing OpenSSL.
Added Authentication Login window for Basic, Digest and NTLM logins displayed after a 401 error, request then repeated.  Currently not storing logins against pages.
Added Digest SHA-256 server authentication method.
Added Upload File name and Upload Strategy to POST/PUT files using simple upload or MIME Multipart, note need to supply parameters so server knows what to do with the file.


Samples/Delphi/SslInternet/OverbyteIcsHttpsTst.dpr
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
May 19, 2023 V8.69 
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.
Fixed memory leak not freeing OpenSSL.
WMSslNotTrusted now restarts the correct last request.
Added Content Encoding Gzip tick box to support compression.
Added persistent cookie support.
Adding POST/PUT support to either send simple data or upload files in various ways (from OverbyteIcsHttpPost1 sample), may be tested against the ICS web server samples.


Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsIpStmLogTst1.pas
05 May 2022 - V8.69
Support OCSP to check certificate revocation when verifying handshake using certificate bundle.  Note OCSP settings made in code, not from the GUI.  Server OCSP stapling is enabled from Revoke Check tickbox.  
With Local mode, only start client if server starts.



------------------------------------------------------------------------
r1559 | angus | 2022-05-25 16:53:08 +0100 (Wed, 25 May 2022) | 5 lines
Changed paths:
   M /trunk/Samples/Delphi/BrowserDemo/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/BrowserDemo/TrustedCABundle.pem
   M /trunk/Samples/Delphi/SslInternet/InterCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsPemTool1.pas
   M /trunk/Samples/Delphi/SslInternet/RootCaCertsBundle.pem
   M /trunk/Samples/Delphi/SslInternet/TrustedCABundle.pem
   M /trunk/Source/OverbyteIcsSslX509Utils.pas

ICS V8.69 - Part 9

Updated the various ICS CA Trusted Stores.  Microsoft has removed 81 expired and duplicate certificates that have been re-issued.


------------------------------------------------------------------------
r1560 | angus | 2022-05-26 12:34:40 +0100 (Thu, 26 May 2022) | 5 lines
Changed paths:
   M /trunk/Packages/IcsFmxCB102Run.cbproj
   M /trunk/Packages/IcsFmxCB103Run.cbproj
   M /trunk/Packages/IcsFmxCB104Run.cbproj
   M /trunk/Packages/IcsFmxCB110Run.cbproj
   M /trunk/Packages/IcsFmxD101Run.dpk
   M /trunk/Packages/IcsFmxD101Run.dproj
   M /trunk/Packages/IcsFmxD102Run.dpk
   M /trunk/Packages/IcsFmxD102Run.dproj
   M /trunk/Packages/IcsFmxD103Run.dpk
   M /trunk/Packages/IcsFmxD103Run.dproj
   M /trunk/Packages/IcsFmxD104Run.dpk
   M /trunk/Packages/IcsFmxD104Run.dproj
   M /trunk/Packages/IcsFmxD10SRun.dpk
   M /trunk/Packages/IcsFmxD10SRun.dproj
   M /trunk/Packages/IcsFmxD110Run.dpk
   M /trunk/Packages/IcsFmxDXE2Run.dpk
   M /trunk/Packages/IcsFmxDXE2Run.dproj
   M /trunk/Packages/IcsFmxDXE3Run.dpk
   M /trunk/Packages/IcsFmxDXE3Run.dproj
   M /trunk/Packages/IcsFmxDXE4Run.dpk
   M /trunk/Packages/IcsFmxDXE4Run.dproj
   M /trunk/Packages/IcsFmxDXE5Run.dpk
   M /trunk/Packages/IcsFmxDXE5Run.dproj
   M /trunk/Packages/IcsFmxDXE6Run.dpk
   M /trunk/Packages/IcsFmxDXE6Run.dproj
   M /trunk/Packages/IcsFmxDXE7Run.dpk
   M /trunk/Packages/IcsFmxDXE7Run.dproj
   M /trunk/Packages/IcsFmxDXE8Run.dpk
   M /trunk/Packages/IcsFmxDXE8Run.dproj
   M /trunk/Packages/IcsLinuxD104.dpk
   M /trunk/Packages/IcsLinuxD104.dproj
   M /trunk/Packages/IcsVclCB102Run.cbproj
   M /trunk/Packages/IcsVclCB103Run.cbproj
   M /trunk/Packages/IcsVclCB104Run.cbproj
   M /trunk/Packages/IcsVclCB110Run.cbproj
   M /trunk/Packages/IcsVclD101Run.dpk
   M /trunk/Packages/IcsVclD101Run.dproj
   M /trunk/Packages/IcsVclD102Run.dpk
   M /trunk/Packages/IcsVclD102Run.dproj
   M /trunk/Packages/IcsVclD103Run.dpk
   M /trunk/Packages/IcsVclD103Run.dproj
   M /trunk/Packages/IcsVclD104Run.dpk
   M /trunk/Packages/IcsVclD104Run.dproj
   M /trunk/Packages/IcsVclD10SRun.dpk
   M /trunk/Packages/IcsVclD10SRun.dproj
   M /trunk/Packages/IcsVclD110Run.dpk
   M /trunk/Packages/IcsVclDXE2Run.dpk
   M /trunk/Packages/IcsVclDXE2Run.dproj
   M /trunk/Packages/IcsVclDXE3Run.dpk
   M /trunk/Packages/IcsVclDXE3Run.dproj
   M /trunk/Packages/IcsVclDXE4Run.dpk
   M /trunk/Packages/IcsVclDXE4Run.dproj
   M /trunk/Packages/IcsVclDXE5Run.dpk
   M /trunk/Packages/IcsVclDXE5Run.dproj
   M /trunk/Packages/IcsVclDXE6Run.dpk
   M /trunk/Packages/IcsVclDXE6Run.dproj
   M /trunk/Packages/IcsVclDXE7Run.dpk
   M /trunk/Packages/IcsVclDXE7Run.dproj
   M /trunk/Packages/IcsVclDXE8Run.dpk
   M /trunk/Packages/IcsVclDXE8Run.dproj
   M /trunk/Packages/OverbyteIcsD101Run.dpk
   M /trunk/Packages/OverbyteIcsD101Run.dproj
   M /trunk/Packages/OverbyteIcsD102Run.dpk
   M /trunk/Packages/OverbyteIcsD102Run.dproj
   M /trunk/Packages/OverbyteIcsD103Run.dpk
   M /trunk/Packages/OverbyteIcsD103Run.dproj
   M /trunk/Packages/OverbyteIcsD104Run.dpk
   M /trunk/Packages/OverbyteIcsD104Run.dproj
   M /trunk/Packages/OverbyteIcsD10SRun.dpk
   M /trunk/Packages/OverbyteIcsD10SRun.dproj
   M /trunk/Packages/OverbyteIcsD110Run.dpk
   M /trunk/Packages/OverbyteIcsD110Run.dproj
   M /trunk/Packages/OverbyteIcsD2006Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dpk
   M /trunk/Packages/OverbyteIcsD2007Run.dproj
   M /trunk/Packages/OverbyteIcsD2009Run.dpk
   M /trunk/Packages/OverbyteIcsD2009Run.dproj
   M /trunk/Packages/OverbyteIcsD2010Run.dpk
   M /trunk/Packages/OverbyteIcsD2010Run.dproj
   M /trunk/Packages/OverbyteIcsD7Run.dpk
   M /trunk/Packages/OverbyteIcsDXE8Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dpk
   M /trunk/Packages/OverbyteIcsDXe2Run.dproj
   M /trunk/Packages/OverbyteIcsDXe3Run.dpk
   M /trunk/Packages/OverbyteIcsDXe3Run.dproj
   M /trunk/Packages/OverbyteIcsDXe4Run.dpk
   M /trunk/Packages/OverbyteIcsDXe4Run.dproj
   M /trunk/Packages/OverbyteIcsDXe5Run.dpk
   M /trunk/Packages/OverbyteIcsDXe5Run.dproj
   M /trunk/Packages/OverbyteIcsDXe6Run.dpk
   M /trunk/Packages/OverbyteIcsDXe6Run.dproj
   M /trunk/Packages/OverbyteIcsDXe7Run.dpk
   M /trunk/Packages/OverbyteIcsDXe7Run.dproj
   M /trunk/Packages/OverbyteIcsDXe8Run.dproj
   M /trunk/Packages/OverbyteIcsDXeRun.dpk
   M /trunk/Packages/OverbyteIcsDXeRun.dproj
   M /trunk/ReadMe8.txt
   M /trunk/Source/OverbyteIcsSslHttpOAuth.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.dcr

ICS V8.69 - Part 10

Updated all packages with the new OverbyteIcsSslHttpOAuth, added bitmaps for THttpOcsp and updated readme for new samples.  

V8.69 is now ready for release, subject to final testing with various conditionals.  
------------------------------------------------------------------------
r1561 | angus | 2022-05-26 16:15:30 +0100 (Thu, 26 May 2022) | 3 lines
Changed paths:
   M /trunk/Packages/IcsLinuxD104.dpk
   M /trunk/Packages/IcsLinuxD104.dproj
   M /trunk/Packages/IcsLinuxD110.dpk
   M /trunk/Packages/IcsLinuxD110.dproj
   M /trunk/Packages/OverbyteIcsD110Run.dpk
   M /trunk/Source/OverbyteIcsDigestAuth.pas
   M /trunk/Source/OverbyteIcsFtpSrv.pas
   M /trunk/Source/OverbyteIcsHttpAppServer.pas
   M /trunk/Source/OverbyteIcsIpStreamLog.pas
   M /trunk/Source/OverbyteIcsProxy.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/Source/OverbyteIcsWSocketS.pas

ICS V8.69 - Part 11

Fixed various conditional compile errors without SSL or Auto X509 Certs, and package errors. 
------------------------------------------------------------------------
r1562 | angus | 2022-05-28 19:02:21 +0100 (Sat, 28 May 2022) | 2 lines
Changed paths:
   M /trunk/ZipOverbyteIcsV8.lst

Source\Ics.Fmx.OverbyteIcsSslHttpOAuth.pas missing from zip. 

------------------------------------------------------------------------
r1563 | angus | 2022-06-06 17:39:04 +0100 (Mon, 06 Jun 2022) | 7 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpRestTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsHttpsTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer1.pas
   M /trunk/Source/OverbyteIcsSslHttpRest.pas
   M /trunk/Source/OverbyteIcsSuperObject.pas

ICS V8.70 - Part 1

OverbyteIcsSuperObject.pas
June 6, 2022  - V8.70 
Fixed bug in V8.65 where FloattoStr could create Json with comma decimal point instead of a period with some languages.

Also fixed some incorrect dates in the samples.  
------------------------------------------------------------------------
r1564 | angus | 2022-07-06 12:46:55 +0100 (Wed, 06 Jul 2022) | 51 lines
Changed paths:
   M /trunk/OpenSSL-Win32/legacy.dll
   M /trunk/OpenSSL-Win32/libcrypto-3.dll
   M /trunk/OpenSSL-Win32/libssl-3.dll
   M /trunk/OpenSSL-Win32/openssl.exe
   M /trunk/OpenSSL-Win32/readme.txt
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dof
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dpr
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dproj
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.ini
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.res
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsProxySslServer64.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
   A /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.ini
   M /trunk/Samples/Delphi/SslInternet/legacy-x64.dll
   M /trunk/Samples/Delphi/SslInternet/legacy.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libcrypto-3.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3-x64.dll
   M /trunk/Samples/Delphi/SslInternet/libssl-3.dll
   M /trunk/Source/OverbyteIcsBlacklist.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsReg.pas
   M /trunk/Source/OverbyteIcsSslHttpOAuth.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas
   M /trunk/Source/OverbyteIcsWSocket.pas
   M /trunk/ZipOverbyteIcsV8.lst

ICS V8.70 - Part 2

Updated OpenSSL to 3.0.5.  Updated service server samples to send email to Google using OAuth2.  Added missing INI files for some Win64 samples. 

OverbyteIcsMailQueue.pas
24 Jun 2022 - V8.70
Changed logging to say 'OAuth2 Access Token' adding Access to avoid confusion with Refresh tokens.


OverbyteIcsSslHttpOAuth.pas
Jun 27, 2022 - V8.70
Added IcsLoadRestEmailFromIni to load TIcsRestEmail secrets and tokens from INI file. Ideally these settings should be encrypted!!


OverbyteIcsSslX509Certs.pas
Jun 27, 2022 - V8.70
Create well known directory if missing for challenges.


OverbyteIcsWSocket.pas
OverbyteIcsReg.pas
Jun 2022  V8.70 -  Version only

Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiWebServ64.ini
28 Jun 2022 V8.70 
Added TIcsRestEmail to support OAuth2 authentication for GMail when sending admin emails.  Needs new [RestEmail] section in INI file with OAuth2 account client id and secret and refresh token (see top of OverbyteIcsSslHttpOAuth.pas unit).  The refresh  token can be obtained using the OverbyteMailQuTst sample with the same client account.
hackfilterlist.txt now allows useragent= to filter on the header, allows blocking masscan scanner.
Better error handling if weblog not opened correctly.  


Samples/Delphi/SslInternet/OverbyteIcsDDWebService.ini
Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dof
Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dpr
Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.dproj
Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.ini
Samples/Delphi/SslInternet/OverbyteIcsDDWebService64.res
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.dfm
Samples/Delphi/SslInternet/OverbyteIcsDDWebServiceSrv.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ.ini
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ1.pas
Samples/Delphi/SslInternet/OverbyteIcsSslMultiFtpServ64.ini
05 Jul 2022 V8.70 
Added TIcsRestEmail to support OAuth2 authentication for GMail when sending admin emails.  Needs new [RestEmail] section in INI file with OAuth2 account client id and secret and refresh token (see top of OverbyteIcsSslHttpOAuth.pas unit).  The refresh  token can be obtained using the OverbyteMailQuTst sample with the same client account.




------------------------------------------------------------------------
r1565 | angus | 2022-07-13 17:19:35 +0100 (Wed, 13 Jul 2022) | 22 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
   M /trunk/Source/OverbyteIcsFileCopy.pas
   M /trunk/Source/OverbyteIcsFileCopyW.pas
   M /trunk/Source/OverbyteIcsUtils.pas

ICS V8.70 - Part 3

OverbyteIcsFileCopy.pas
OverbyteIcsFileCopyW.pas
13 Jul 2022 - V8.70
Added support for copying file names longer than 259 characters by adding \\?\ to the start of long names passed to Windows APIs, but not logged.

OverbyteIcsUtils.pas
Jul 13, 2022 V8.70 
Added file system extended path name constants and IcsAddLongPath to adjust long file name to add them for names longer than
260 chars, if supported by the disk file system, unicode APIs only.

Samples/Delphi/SslInternet/OverbyteIcsXferTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTst1.pas
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.dfm
Samples/Delphi/SslInternet/OverbyteIcsXferTstW1.pas
11 Jul 2022 - V8.70 
Added support for copying file names longer than 259 characters.
Added new tab Single File Copy to test CopyOneFile method.



------------------------------------------------------------------------
r1566 | angus | 2022-07-27 12:34:19 +0100 (Wed, 27 Jul 2022) | 14 lines
Changed paths:
   M /trunk/Source/OverbyteIcsMailQueue.pas
   M /trunk/Source/OverbyteIcsSslX509Certs.pas

ICS V8.70 - Part 4

The SVN email notifications are now sent by a newly written SVN hook application using the ICS Mail Queue component, replacing the unit written by Arno 14 years ago for which I never had the final source code.  It now supports SSL and Gmail.  Potentially we can now improve the notifications, if needed.   Been putting this rewrite off for 10 years. 

OverbyteIcsMailQueue.pas
27 Jul 2022 - V8.70
Changed logging to say 'OAuth2 Access Token' adding Access to avoid confusion with Refresh tokens.
Don't use synchronize for logging in thread if component is multithreaded, it blocks the queue.


OverbyteIcsSslX509Certs.pas
Jul 22, 2022 - V8.70
Create well known directory if missing for ALPN challenges.

------------------------------------------------------------------------
r1567 | angus | 2022-08-05 17:57:50 +0100 (Fri, 05 Aug 2022) | 26 lines
Changed paths:
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
   M /trunk/Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
   M /trunk/Source/OverbyteIcsMailQueue.pas

ICS V8.70 - Part 5

The changes to the SSL send email samples are to properly illustrate how to send Unicode characters.  


OverbyteIcsMailQueue.pas
05 Aug 2022 - V8.70
Changed logging to say 'OAuth2 Access Token' adding Access to avoid confusion with Refresh tokens.
Don't use synchronize for logging in thread if component is multithreaded, it blocks the queue.
Moved HttpOcsp to thread to avoid thread problems.


Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.dfm
Samples/Delphi/SslInternet/OverbyteIcsMailQuTst1.pas
05 Aug 2022 - V8.70
Set SMPT UTF-8 charset so headers get inline MIME encoded if necessary, rather than being converted to ANSI.
Note body lines are not converted in this sample. 


Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.dfm
Samples/Delphi/SslInternet/OverbyteIcsSslMailSnd1.pas
Aug 5, 2022  V8.70
Added header character set and body line wrapping and encoding from non-SSL sample.
Note the UseMailMessageCheckBox means you pass the entire body in MailMessage property instead of using the OnGetData event to send one line at a time, this will also word wrap long lines and encode body content.


------------------------------------------------------------------------
